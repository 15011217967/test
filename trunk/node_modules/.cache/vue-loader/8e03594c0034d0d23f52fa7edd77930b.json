{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\product\\custom_attrs\\material_details.vue?vue&type=style&index=0&id=35b2983b&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\product\\custom_attrs\\material_details.vue","mtime":1572415124050},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\css-loader\\index.js","mtime":1558492728478},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1558492728890},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\postcss-loader\\src\\index.js","mtime":1558492728823},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\less-loader\\dist\\cjs.js","mtime":1566193719488},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.tlogy-item {\r\n  background-color: #ffffff;\r\n  margin: 10px;\r\n  padding: 10px;\r\n}\r\n.tlogy-footer {\r\n  background-color: #ffffff;\r\n  margin: 0 10px 10px;\r\n  padding: 10px;\r\n}\r\n.tlogy-title {\r\n  font-size: 22px ;\r\n  height: 50px;\r\n  line-height: 50px;\r\n  text-indent: 40px;\r\n  border-bottom: 1px solid #eeeeee;\r\n  margin-bottom: 20px;\r\n  em {\r\n    margin-left: 20px;\r\n    font-size: 14px;\r\n    color: #ff6677;\r\n  }\r\n}\r\n\r\n.popularYear-w {\r\n  width: 280px !important;\r\n}\r\n",{"version":3,"sources":["material_details.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"material_details.vue","sourceRoot":"src/views/product/custom_attrs","sourcesContent":["<template>\r\n  <div>\r\n    <el-form :rules=\"rules\" label-width=\"110px\" :model=\"filtersData\" size=\"small\" ref=\"filtersForm\">\r\n      <div class=\"tlogy-item\">\r\n        <h5 class=\"tlogy-title\">基本信息</h5>\r\n        <el-form-item prop=\"materialCateId\" label=\"属性分类：\">\r\n          <el-cascader\r\n          v-if=\"_type == 'add'\"\r\n            class=\"input-w-2\"\r\n            :disabled=\"editDisabled\"\r\n            :options=\"attrClassData\"\r\n            v-model=\"attrCateArr\"\r\n            :value=\"attrCateArr\"\r\n            @change=\"attrCascaderGet\"\r\n            :show-all-levels=\"false\"\r\n            :props=\"props\"\r\n          ></el-cascader>\r\n        <el-select v-else placeholder=\"请选择\" class=\"input-w-2\" :disabled=\"editDisabled\"\r\n            :value=\"filtersData.materialCateId\"\r\n            v-model=\"filtersData.materialCateId\">\r\n            <el-option\r\n            v-for=\"item in attrListData\"\r\n            :key=\"item.id\"\r\n            :label=\"item.name\"\r\n            :value=\"item.id\"\r\n            ></el-option>\r\n        </el-select>\r\n        </el-form-item>\r\n         <el-form-item v-if=\"_type != 'add'\" label=\"已选分类：\">\r\n        <div>{{cateNames}}</div>\r\n      </el-form-item>\r\n        <el-form-item :prop=\"_type == 'add'?'productionMaterialCates':''\" label=\"商品分类：\">\r\n          <div class=\"input-w-2\">\r\n          <el-cascader-multi\r\n            :disabled=\"showDisabled\"\r\n            v-model=\"cateIdArr\"\r\n            @change=\"cateChangeGet\"\r\n            :data=\"classData\"\r\n            :only-last=\"true\"\r\n            :clearable=\"true\"\r\n            :is-two-dimension-value=\"false\"\r\n            separator=\"/\"\r\n            value-key=\"id\"\r\n            label-key=\"name\"\r\n            children-key=\"children\"\r\n          ></el-cascader-multi>\r\n          </div>\r\n        </el-form-item>\r\n        <el-form-item prop=\"name\" label=\"原料名称：\">\r\n          <el-input v-model=\"filtersData.name\" class=\"input-w-2\"   :disabled=\"showDisabled\" placeholder=\"请输入内容\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"unitPrice\" label=\"销售价格：\">\r\n          <el-input @input.native=\"setNumberPrice($event)\"  v-model=\"filtersData.unitPrice\" class=\"input-w-2\"  :disabled=\"showDisabled\" placeholder=\"请输入内容\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"成本：\">\r\n          <el-input @input.native=\"setNumberPrice($event)\" v-model=\"filtersData.costPrice\" class=\"input-w-2\"   :disabled=\"showDisabled\" placeholder=\"请输入内容\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"brandId\" label=\"品牌：\">\r\n          <el-select\r\n            :disabled=\"editDisabled\"\r\n            class=\"input-w-2\"\r\n            placeholder=\"请选择\"\r\n            @change=\"brandIdGet\"\r\n            v-model=\"filtersData.brandId\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in brandOptions\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.id\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item\r\n          prop=\"productionYear\"\r\n          :rules=\"{required: true, message: '请选择年份', trigger: 'change'}\"\r\n          label=\"年份：\"\r\n        >\r\n          <el-date-picker\r\n            :disabled=\"editDisabled\"\r\n            class=\"popularYear-w\"\r\n            v-model=\"filtersData.productionYear\"\r\n            type=\"year\"\r\n            value-format=\"yyyy\"\r\n            placeholder=\"选择年\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item prop=\"image\" label=\"原料图片：\">\r\n          <el-upload-img\r\n           :disabled=\"showDisabled\"\r\n            v-model=\"filtersData.image\"\r\n            :EchoDisplayImages=\"productImages\"\r\n            CatalogName=\"product\"\r\n          ></el-upload-img>\r\n        </el-form-item>\r\n        <el-form-item prop=\"valid\" label=\"使用状态：\">\r\n          <el-radio v-model=\"filtersData.valid\" :disabled=\"showDisabled\" :label=\"true\">使用中</el-radio>\r\n          <el-radio v-model=\"filtersData.valid\" :disabled=\"showDisabled\" :label=\"false\">未使用</el-radio>\r\n        </el-form-item>\r\n        <el-form-item prop=\"description\" label=\"备注：\">\r\n          <el-input\r\n            type=\"textarea\"\r\n            class=\"input-w-2\"\r\n            autosize\r\n            :disabled=\"showDisabled\"\r\n            placeholder=\"请输入内容\"\r\n            v-model=\"filtersData.description\"\r\n          ></el-input>\r\n        </el-form-item>\r\n      </div>\r\n      <div class=\"tlogy-footer\">\r\n        <h5 class=\"tlogy-title\">面料选填</h5>\r\n        <el-form-item label=\"零剪成本：\">\r\n          <el-input\r\n           @input.native=\"setNumberPrice($event)\"\r\n            :disabled=\"showDisabled\"\r\n            v-model=\"filtersData.productionMaterialOptional.costPrice\"\r\n            class=\"input-w-2\"\r\n            placeholder=\"请输入内容\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"成分：\">\r\n          <el-input\r\n            :disabled=\"showDisabled\"\r\n            v-model=\"filtersData.productionMaterialOptional.ingredient\"\r\n            class=\"input-w-2\"\r\n            placeholder=\"请输入内容\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"纱支：\">\r\n          <el-input\r\n            :disabled=\"showDisabled\"\r\n            v-model=\"filtersData.productionMaterialOptional.yarnCount\"\r\n            class=\"input-w-2\"\r\n            placeholder=\"请输入内容\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"克重：\">\r\n          <el-input\r\n            @input.native=\"setNumberPrice($event)\"\r\n            :disabled=\"showDisabled\"\r\n            v-model=\"filtersData.productionMaterialOptional.grams\"\r\n            class=\"input-w-2\"\r\n            placeholder=\"请输入内容\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"花型：\">\r\n          <el-input\r\n            :disabled=\"showDisabled\"\r\n            v-model=\"filtersData.productionMaterialOptional.pattern\"\r\n            class=\"input-w-2\"\r\n            placeholder=\"请输入内容\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"季节：\">\r\n          <el-select\r\n            :disabled=\"showDisabled\"\r\n            class=\"input-w-2\"\r\n            placeholder=\"请选择\"\r\n            v-model=\"filtersData.productionMaterialOptional.season\"\r\n          >\r\n            <el-option\r\n              v-for=\"(item,index) in seasonOptions\"\r\n              :key=\"index.code\"\r\n              :label=\"item.name\"\r\n              :value=\"item.name\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <div class=\"item-footer\">\r\n          <el-button\r\n            v-if=\"_type == 'add'\"\r\n            size=\"small\"\r\n            @click=\"submitForm('filtersForm')\"\r\n            type=\"primary\"\r\n          >确定</el-button>\r\n          <el-button\r\n            v-else-if=\"_type == 'edit'\"\r\n            size=\"small\"\r\n            @click=\"submitForm('filtersForm')\"\r\n            type=\"primary\"\r\n          >修改</el-button>\r\n          <el-button size=\"small\" @click=\"routerback('filtersForm')\">取消</el-button>\r\n        </div>\r\n      </div>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n<script>\r\nlet mirroringMaterialCates=[];\r\nimport ElUploadImg from \"@/components/uploadImg/el_upload_img\";\r\nimport { validatePositiveNumber,numberPrice} from \"@/utils/validate\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      filtersData: {\r\n        type: 2, //很重要 区分原料和工艺的 原料类型（1：工艺，2：原料）\r\n        materialCateId: \"\",\r\n        name: \"\",\r\n        unitPrice:null,\r\n        image: \"\",\r\n        costPrice: null,\r\n        productionYear: \"\",\r\n        brandId: \"\",\r\n        valid: true,\r\n        description: \"\",\r\n        productionMaterialOptional: { //面料可选\r\n          type: 2, //选填 很重要 区分原料和工艺的 原料类型（1：工艺，2：原料）；\r\n          costPrice: null,\r\n          ingredient: \"\",\r\n          yarnCount: \"\",\r\n          grams: \"\",\r\n          pattern: \"\"\r\n        },\r\n        productionMaterialCates:[] //商品分类数组\r\n      },\r\n\r\n      productImages: [], //回显图片\r\n      showDisabled: false,\r\n      editDisabled: false,\r\n      _type: \"\",\r\n      _id: \"\",\r\n      rules: {\r\n        //规则验证\r\n        materialCateId: [\r\n          { required: true, message: \"请选择属性分类\", trigger: \"change\" }\r\n        ],\r\n        productionMaterialCates: [\r\n          { required: true, message: \"请选择商品分类\", trigger: \"change\" }\r\n        ],\r\n        brandId: [{ required: true, message: \"请选择品牌\", trigger: \"change\" }],\r\n        name: [{ required: true, message: \"输入原料名称\", trigger: \"blur\" }],\r\n        unitPrice: [\r\n          { required: true, message: \"请输入销售价格\", trigger: \"blur\" },\r\n           {validator:validatePositiveNumber,trigger: \"blur\"}\r\n        ],\r\n        productionYear: [\r\n          { required: true, message: \"请选择年份\", trigger: \"change\" }\r\n        ]\r\n      },\r\n      brandOptions: [], //品牌\r\n      cateNames:'',\r\n      //分类使用\r\n      cateIdArr:[],\r\n      classData: [], // 商品分类树 数据\r\n      listData: [], // 商品 分类 一维数据\r\n      attrClassData: [], //原料分类树数据\r\n      attrListData: [], //原料 一维数据\r\n      attrCateArr: [],\r\n      props: {\r\n        value: \"id\",\r\n        label: \"name\",\r\n        children: \"children\"\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n    this.getQueryparams();\r\n    this.getBrandOptions();\r\n  },\r\n  methods: {\r\n   setNumberPrice(_t){\r\n    numberPrice(_t)\r\n   },\r\n    //获取上页面参数\r\n    getQueryparams() {\r\n      this._type = this.$route.query._type;\r\n      this._id = this.$route.query._id;\r\n      let itemStatus = this._type;\r\n      switch (itemStatus.toString()) {\r\n        case \"add\": //新增\r\n          this.editDisabled = false;\r\n          this.showDisabled = false;\r\n           this.getClassData();\r\n          break;\r\n        case \"edit\": //修改\r\n          this.editDisabled = true;\r\n          this.showDisabled = false;\r\n          this.getEchoDisplayData();\r\n          break;\r\n        case \"show\": //查看\r\n          this.editDisabled = true;\r\n          this.showDisabled = true;\r\n          this.getEchoDisplayData();\r\n          break;\r\n      }\r\n    },\r\n    getClassData(_disabledIds) {\r\n      //获取商品分类  type 1\r\n      this.$common.getClassSelect(this, 1,_disabledIds).then(res => {\r\n        this.classData = res.ztree;\r\n        this.listData = res.list;\r\n      });\r\n      //获取属性分类  type 3\r\n      this.$common.getClassSelect(this, 3).then(res => {\r\n        this.attrClassData = res.ztree;\r\n        this.attrListData = res.list;\r\n      });\r\n    },\r\n    cateChangeGet(e) {\r\n      let careIdArr = this.cateIdArr,\r\n          careIdLen = careIdArr.length;\r\n        let list = this.listData,\r\n          listLen = list.length;\r\n        let categories = [];\r\n        for (let i = 0; i < careIdLen; i++) {\r\n          for (let k = 0; k < listLen; k++) {\r\n            if (careIdArr[i] == list[k].id) {\r\n              categories.push({\r\n                cateId: list[k].id,\r\n                cateName: list[k].name,\r\n                cateIdentifier: list[k].identifier,\r\n                fullCateName:list[k].fullCateName\r\n              });\r\n            }\r\n          }\r\n        }\r\n        this.filtersData.productionMaterialCates = [...categories,...mirroringMaterialCates];\r\n    },\r\n    attrCascaderGet(e) {\r\n      let cateId = JSON.parse(JSON.stringify(e)).pop();\r\n      let obj = this.attrListData.find(item => item.id == cateId);\r\n      this.filtersData.materialCateId = obj.id;\r\n      this.filtersData.materialCateName = obj.name;\r\n      this.filtersData.materialCateIdentifier = obj.identifier;\r\n      this.filtersData.materialFullCateName = obj.fullCateName;\r\n    },\r\n    brandIdGet(val) {\r\n      let _obj = this.brandOptions.find(item => item.id == val);\r\n      this.filtersData.brandName = _obj.name;\r\n    },\r\n    //品牌\r\n    getBrandOptions() {\r\n      this.request(this.api.product.productBrand_list, {valid:true}).then(data => {\r\n        //console.log(data.data);\r\n        let _data = data.data;\r\n        this.brandOptions = _data;\r\n      });\r\n    },\r\n    //提交\r\n    submitForm(formName) {\r\n      console.log(this.filtersData);\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          this.request(\r\n            this.api.product.productionMaterial_save,\r\n            this.filtersData\r\n          ).then(res => {\r\n            this.$message.success(\"保存成功\");\r\n            setTimeout(() => {\r\n              this.routerback();\r\n            }, 500);\r\n          });\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //回显\r\n    getEchoDisplayData() {\r\n      this.request(this.api.product.productionMaterial_get, {\r\n        id: this._id\r\n      }).then(res => {\r\n        console.log(res);\r\n        if(res.productionMaterialOptional == null){\r\n          res.productionMaterialOptional={}\r\n        }\r\n         this.filtersData = res;\r\n        if(!!res.image){\r\n          this.productImages = [{ url: res.image }];\r\n        }\r\n        this.attrCateArr = [res.materialCateId];\r\n        //回显 商品分类已选置灰\r\n         let arr = [],\r\n            cateIds = [];\r\n          let Categories = res.productionMaterialCates;\r\n          mirroringMaterialCates=[...Categories];\r\n          if(Categories.length > 0){\r\n            for (let i = 0; i < Categories.length; i++) {\r\n              arr.push(Categories[i].fullCateName); //此处的字段是错误的\r\n              cateIds.push(Categories[i].cateId);\r\n            }\r\n            this.cateNames = arr.join(\"、\");\r\n          }\r\n          this.getClassData(cateIds);\r\n      });\r\n    },\r\n    //后退\r\n    routerback() {\r\n      this.$router.go(-1);\r\n    }\r\n  },\r\n  computed: {\r\n    //季节\r\n    seasonOptions() {\r\n      let codeSet = this.$store.getters.codeData;\r\n      if (codeSet.PRO005) {\r\n        return codeSet.PRO005.codeItemList;\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    ElUploadImg\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.tlogy-item {\r\n  background-color: #ffffff;\r\n  margin: 10px;\r\n  padding: 10px;\r\n}\r\n.tlogy-footer {\r\n  background-color: #ffffff;\r\n  margin: 0 10px 10px;\r\n  padding: 10px;\r\n}\r\n.tlogy-title {\r\n  font-size: 22px ;\r\n  height: 50px;\r\n  line-height: 50px;\r\n  text-indent: 40px;\r\n  border-bottom: 1px solid #eeeeee;\r\n  margin-bottom: 20px;\r\n  em {\r\n    margin-left: 20px;\r\n    font-size: 14px;\r\n    color: #ff6677;\r\n  }\r\n}\r\n\r\n.popularYear-w {\r\n  width: 280px !important;\r\n}\r\n</style>\r\n"]}]}