{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\workorder\\category\\workOrder_detail.vue?vue&type=style&index=0&id=350ce5b0&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\workorder\\category\\workOrder_detail.vue","mtime":1572415123753},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\css-loader\\index.js","mtime":1558492728478},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1558492728890},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\postcss-loader\\src\\index.js","mtime":1558492728823},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\less-loader\\dist\\cjs.js","mtime":1566193719488},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  .jdbcType-image{\n    width: 35px;\n    height: 35px;\n  }\n  .the-results{\n    // width: 1500px;\n    display: flex;\n    text-align: right;\n    flex-wrap: wrap;\n    .the-results-span{\n      width: 370px;\n    }\n  }\n  .the-results-three-rows{\n    // width: 1150px;\n  }\n  .text-indent15{\n    text-indent: 15px;\n  }\n  .text-indent45{\n    text-indent: 45px;\n  }\n    .text-indent75{\n    text-indent: 75px;\n  }\n  .color243{\n    color:rgb(243, 131, 3);\n  }\n.spu {\n  li {\n    div{\n      display: flex;\n      border-bottom: 1px solid #f0f0f0;\n      span {\n        height: 50px;\n        flex: 1;\n        line-height: 50px;\n        position: relative;\n        text-align: center;\n      }\n      .text-left{\n        text-align: left;\n      }\n      img {\n        width: 40px;\n        height: 40px;\n      }\n    }\n    .spu-border {\n      border-bottom: 1px solid rgb(243, 131, 3);\n    }\n  }\n}\n  .display-flex{\n    display: flex;\n  }\n  .subImg{\n    width: 35px;\n    height: 35px;\n  }\n  .correlationData-p{\n    border-bottom: 1px solid #f0f0f0;\n    padding-bottom: 20px;\n    margin-bottom: 20px;\n  }\n  h5 {\n    color: #222;\n    margin-left: -30px;\n  }\n  .s{\n    margin-top:10px;\n    display:block;\n    font-size:15px;\n    color: #66b1ff;\n  }\n  .test {\n    color: #9d9d9d;\n  }\n  .work-order-info {\n    display: flex;\n    justify-content: space-between;\n  }\n  .info-list {\n    display: flex;\n    width: 80%;\n    flex-wrap: wrap;\n    padding: 15px 10px 0 10px;\n    li {\n      padding-bottom: 10px;\n      margin-right: 30px;\n    }\n  }\n  .correlationData{\n    height: 300px;\n    overflow-y:scroll;\n    padding:0 15px 15px 15px;\n      h3{\n        font-size: 16px;\n        padding: 15px 0;\n      }\n      ul{\n        display: flex;\n        flex-wrap:wrap;\n        li{\n          width: 20%;\n          text-indent: 20px;\n          padding: 5px 0;\n        }\n        img{\n          width: 120px;\n          height: 150px;\n        }\n        span{\n          display: block;\n          margin-top: 10px;\n        }\n      }\n  }\n",{"version":3,"sources":["workOrder_detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAueA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"workOrder_detail.vue","sourceRoot":"src/views/workorder/category","sourcesContent":["<!-- 工单池 -->\r\n<template>\r\n  <div>\r\n    <div class=\"item-margin\">\r\n      <div class=\"item-form\">\r\n        <!-- 工单基本信息 -->\r\n        <div class=\"work-order-info\">\r\n          <span>\r\n            工单基本信息：\r\n            <el-button type=\"primary\" size=\"mini\" disabled>{{ jobOrderStatus[historyWorkOrderGetByNumObj.jobOrderStatus] }}</el-button>\r\n          </span>\r\n          <span>累计耗时：{{ historyWorkOrderGetByNumObj._createTime }}</span>\r\n        </div>\r\n        <ul class=\"info-list\">\r\n          <li>工单名称：{{ historyWorkOrderGetByNumObj.name }}</li>\r\n          <li>业务类型：{{ \"CEN012\"| codeToName(historyWorkOrderGetByNumObj.businessType) }}</li>\r\n          <li>服务类型：{{ \"CEN013\"| codeToName(historyWorkOrderGetByNumObj.serviceType) }}</li>\r\n          <li>优先级：{{ priority[historyWorkOrderGetByNumObj.priority] }}</li>\r\n          <li>创建时间：{{ historyWorkOrderGetByNumObj.createTime | timestampToTime  }}</li>\r\n          <li v-if=\"historyWorkOrderGetByNumObj.assignee\">接单人：{{ historyWorkOrderGetByNumObj.assignee }}</li>\r\n          <br/>\r\n        </ul>\r\n          <p class=\"correlationData-p\" v-if=\"historyWorkOrderGetByNumObj.sourceChileType == 'measuringWorkOrder'\">\r\n            关联数据：\r\n            <el-button size=\"small\" type=\"primary\" @click=\"isCorrelationDataShow = !isCorrelationDataShow\">\r\n              查看量体工单\r\n              <i class=\"el-icon-arrow-down el-icon--right\" :class=\"{'el-icon-arrow-up':false}\"></i>\r\n            </el-button>\r\n          </p>\r\n          <p class=\"correlationData-p\" v-if=\"historyWorkOrderGetByNumObj.sourceChileType == 'consumerCustomizedOrder'\">\r\n            关联订单：\r\n            <el-button size=\"small\" type=\"primary\" @click=\"isConsumer = !isConsumer\">\r\n              查看定制订单\r\n              <i class=\"el-icon-arrow-down el-icon--right\" :class=\"{'el-icon-arrow-up':false}\"></i>\r\n            </el-button>\r\n          </p>\r\n          <!-- 定制 -->\r\n          <!-- <section> -->\r\n          <section v-if=\"isConsumer\">\r\n            <ul  class=\"spu\">\r\n              <li>\r\n                <div class=\"spu-border\">\r\n                  <span>定制清单</span>\r\n                  <span>图片</span>\r\n                  <span>数量</span>\r\n                  <span>销售单价</span>\r\n                  <span>备注</span>\r\n                  <span>累计金额</span>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n            <ul class=\"spu\">\r\n              <!-- 一级spu -->\r\n              <li v-for=\"(item, index) in consumerCustomizedOrder_obj.consumerCustomizedGoodsVOList\" :key=\"index\">\r\n                <div>\r\n                  <!-- spu名称 -->\r\n                  <span class=\"text-left text-indent15\" @click=\"item.isChecked = !item.isChecked\">\r\n                    <i :class=\"['el-icon-arrow-down',{'el-icon-arrow-up':item.isChecked}]\"></i>&nbsp;{{ item.customizedProductName }}\r\n                  </span>\r\n                  <!-- spu图片 -->\r\n                  <span>\r\n                    <img :src=\"item.image\" alt>\r\n                  </span>\r\n                  <!-- 数量 -->\r\n                  <span>{{ item.quantity || '--' }}</span>\r\n                  <!-- 销售单价 -->\r\n                  <span>{{ item.price }}</span>\r\n                  <!-- 备注 -->\r\n                  <span>{{ item.remarks || '--' }}</span>\r\n                  <!-- 累计金额 -->\r\n                  <span>--</span>\r\n                </div>\r\n                <!-- 二级sku -->\r\n                <ul class=\"spu\" v-if=\"item.isChecked\">\r\n                  <li>\r\n                    <div>\r\n                      <span  class=\"text-left text-indent45\">原料</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                    </div>\r\n                    <!-- 三级原料 -->\r\n                    <ul class=\"spu\">\r\n                      <li  v-for=\"(items, indexs) in item.material\" :key=\"indexs\">\r\n                        <div>\r\n                          <span  class=\"text-left text-indent75\">{{ items.name }}</span>\r\n                          <span><img :src=\"items.image\" alt></span>\r\n                          <span>{{ items.quantity || '--' }}</span>\r\n                          <span>{{ items.unitPrice || '--' }}</span>\r\n                          <span>{{ items.remarks || '--' }}</span>\r\n                          <span>{{ items.usageAmount || '--' }}</span>\r\n                        </div>\r\n                      </li>\r\n                    </ul>\r\n                  </li>\r\n                  <li>\r\n                    <div>\r\n                      <span style=\"background:#fff;\" class=\"text-left text-indent45\">工艺 </span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                    </div>\r\n                    <!-- 三级原料 -->\r\n                    <ul class=\"spu\">\r\n                      <li  v-for=\"(items, indexs) in item.craft\" :key=\"indexs\">\r\n                        <div>\r\n                          <span class=\"text-left text-indent75\">{{ items.name }}</span>\r\n                          <span><img :src=\"items.image\" alt></span>\r\n                          <span>{{ items.quantity || '--' }}</span>\r\n                          <span>{{ items.unitPrice || '--' }}</span>\r\n                          <span>{{ items.remarks || '--' }}</span>\r\n                          <span>{{ items.usageAmount || '--' }}</span>\r\n                        </div>\r\n                      </li>\r\n                    </ul>\r\n                  </li>\r\n                </ul>\r\n                <!-- 二级sku -->\r\n              </li>\r\n              <!-- 一级spu -->\r\n          </ul>\r\n          </section>\r\n        <!-- 定制 -->\r\n        <div class=\"correlationData mt-20\" v-if=\"isCorrelationDataShow\">\r\n          <section>\r\n            <h6 class=\"mt-10\">量体信息</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.measureData\" :key=\"item\">{{ item.name }}：{{ item.value }} CM</li>\r\n            </ul>\r\n          </section>\r\n          <section>\r\n            <h6 class=\"mt-10\">体型特征</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.bodyFeature\" :key=\"item\">{{ item.name }}：{{ item.value }}</li>\r\n            </ul>\r\n          </section>\r\n          <section>\r\n            <h6 class=\"mt-10\">体型实拍</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.bodyPicture\" :key=\"item\">\r\n                <img :src=\"item.value\" alt=\"\">\r\n                <span>{{ item.name }}</span>\r\n              </li>\r\n            </ul>\r\n          </section>\r\n        </div>\r\n        <p class=\"correlationData-p\" v-if=\"isCorrelationDataShow\">\r\n        </p>\r\n        <div class=\"work-order-info mt-25\">\r\n          <span>工单处理结果：</span>\r\n        </div>\r\n        <el-form class=\"item-form\" size=\"small\" :inline=\"true\">\r\n          <template>\r\n            <div v-for=\"(item, index) in listByWorkOrderCode\" :key=\"index\">\r\n              <span class=\"s\">{{ item.tableCn }}</span>\r\n              <br/>\r\n              <!-- 一对一 -->\r\n              <section :class=\"['the-results',{'the-results-three-rows':historyWorkOrderGetByNumObj.layout == '01'}]\">\r\n                <span class=\"the-results-span\" v-if=\"item.linkType == 1\" v-for=\"(items, indexs) in item.sublist\" :key=\"indexs\">\r\n                  <!-- 时间字段 -->\r\n                  <template v-if=\"items.jdbcType == 'timestamp' || items.jdbcType == 'date'\">\r\n                    <el-form-item\r\n                      :label=\"items.itemName\">\r\n                      <el-date-picker style=\"width:190px;\" type=\"datetime\" value-format=\"yyyy-MM-dd HH:mm:ss\" disabled v-model=\"item.tableData[items.itemCode]\" placeholder=\"请选择\"></el-date-picker>\r\n                    </el-form-item>\r\n                  </template>\r\n                  <!-- 普通字段 -->\r\n                  <template v-else>\r\n                    <el-form-item\r\n                      v-if=\"items.visible\"\r\n                      :label=\"items.itemName\">\r\n                      <el-input style=\"width:190px;\" v-if=\"items.jdbcType != 'image'\" disabled v-model=\"item.tableData[items.itemCode]\" placeholder=\"--\"></el-input>\r\n                      <img v-else :src=\"item.tableData[items.itemCode]\" alt=\"\" class=\"jdbcType-image\">\r\n                    </el-form-item>\r\n                  </template>\r\n                </span>\r\n              </section>\r\n              <!-- 一对多 -->\r\n              <el-table\r\n                :data=\"item.tableDataList\"\r\n                v-if=\"item.linkType == 2\"\r\n                border\r\n                stripe\r\n                style=\"width:1500px;\"\r\n                empty-text=\"暂无数据\"\r\n                header-align=\"center\"\r\n                header-row-class-name=\"item-table-header\"\r\n                :highlight-current-row=\"true\" >\r\n                <el-table-column v-if=\"items.visible\" max-width=\"370\" :label=\"items.itemName\" :key=\"names\" v-for=\"(items, names) in item.sublist\">\r\n                  <template slot-scope=\"scope\">\r\n                    <!-- 时间字段 -->\r\n                    <template v-if=\"items.jdbcType == 'timestamp' || items.jdbcType == 'date'\">\r\n                      <el-date-picker type=\"datetime\"  disabled v-model=\"scope.row[items.itemCode]\" placeholder=\"开始日期\"></el-date-picker>\r\n                    </template>\r\n                    <!-- 图片 -->\r\n                    <template v-else-if=\"items.jdbcType == 'image'\">\r\n                      <!-- <el-date-picker type=\"datetime\"  :disabled=\"!items.isRead\" v-model=\"scope.row[names]\" placeholder=\"开始日期\"></el-date-picker> -->\r\n                      <img :src=\"scope.row[items.itemCode]\" alt=\"\" class=\"subImg\">\r\n                    </template>\r\n                    <!-- 普通字段 -->\r\n                    <template v-else>\r\n                      <el-input disabled v-model=\"scope.row[items.itemCode]\" placeholder=\"--\"></el-input>\r\n                    </template>\r\n                  </template>\r\n                </el-table-column>\r\n              </el-table>\r\n            </div>\r\n          </template>\r\n        </el-form>\r\n      </div>\r\n      <div class=\"item-margin\"></div>\r\n    </div>\r\n    <div class=\"item-margin\">\r\n      <div class=\"item-form\">\r\n        <el-steps :active=\"active\" finish-status=\"success\">\r\n          <el-step title=\"新工单\"></el-step>\r\n          <el-step title=\"处理中\"></el-step>\r\n          <el-step title=\"已处理\"></el-step>\r\n        </el-steps>\r\n        <!-- 工单跟进记录 -->\r\n        <div class=\"work-order-info mt-30\">\r\n          <span>工单跟进记录：</span>\r\n          <el-button size=\"small\" plain mini @click=\"open\" v-if=\"isAddCourse\">添加跟进记录</el-button>\r\n        </div>\r\n        <!-- 时间线 -->\r\n        <div class=\"block mt-30\">\r\n          <el-timeline>\r\n            <el-timeline-item\r\n            :hide-timestamp=\"true\"\r\n            v-for=\"(activity, index) in workOrderLog_list\"\r\n            :key=\"index\"\r\n            :icon=\"activity.icon\"\r\n            :type=\"activity.type\"\r\n            :color=\"activity.color\"\r\n            :size=\"activity.size\"\r\n            :timestamp=\"activity.updateTime\"\r\n            >{{ activity.updateTime || '--' | timestampToTime }}&nbsp;&nbsp;{{activity.log}}</el-timeline-item>\r\n          </el-timeline>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<!-- 工单池 -->\r\n<script>\r\n  import axios from \"axios\";\r\n  import { getToken } from \"@/utils/auth\";\r\n  import codeSet from \"@/components/codeSet\";\r\n  import treeDept from \"@/components/treeDept\";\r\n  import { filter } from \"minimatch\";\r\n  import { get } from \"http\";\r\n  import { mapGetters } from 'vuex';\r\n  import * as userTypes from \"@/types/userConfig\";\r\n  let token = getToken();\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        // 量体信息\r\n        getDataByReservationObj:{},\r\n        isCorrelationDataShow:false,\r\n        historyWorkOrderGetByNumObj:{},\r\n        workOrderLog_list:{},\r\n        tableItemGetListMapObj:{},\r\n        consumerCustomizedOrder_obj:{},\r\n        // 处理结果字段list\r\n        listByWorkOrderCode:[],\r\n        // 处理结果字段对应名称\r\n        tableData_backups:{},\r\n        // 一对多字段集合\r\n        subObj:{},\r\n        // 物流列表\r\n        express_list:[],\r\n        // 供应商编码\r\n        tableListData:[],\r\n        // 添加进程是否显示\r\n        isAddCourse:this.$route.query.isAddCourse,\r\n        isConsumer:false,\r\n        jobOrderStatus:{\r\n          \"0\":\"未处理\",\r\n          \"1\":\"处理中\",\r\n          \"2\":\"已处理\"\r\n        },\r\n        priority:{\r\n          \"01\":\"高\",\r\n          \"02\":\"中\",\r\n          \"03\":\"低\",\r\n        },\r\n        storageValArr: [],\r\n        formInline: {},\r\n        active: 1,\r\n        reverse: true\r\n      };\r\n    },\r\n    created() {\r\n      this.getHistoryWorkOrderGetByNum(this.$route.query.number);\r\n      this.getWorkOrderLog_list(this.$route.query.number);\r\n      this.tableItemListByWorkOrderCode(this.$route.query.sourceChileType,this.$route.query.sourceId);\r\n\r\n\r\n    },\r\n    methods: {\r\n      consumerCustomizedOrder_get(orderId) {\r\n        this.request(\r\n          this.api.order.consumerCustomizedOrder_get,\r\n          {\r\n            // orderId: \"83e785b5-89fd-49eb-a6a5-5e3e76c9bf3f\"\r\n            orderId\r\n          }\r\n        ).then(res => {\r\n          res.consumerCustomizedGoodsVOList.forEach((item, index) => {\r\n            item.isChecked = false;\r\n            item.craft = [];// 工艺\r\n            item.material = [];// 原料\r\n            item.productGoodsMaterials.forEach((items, indexs) => {\r\n              if(items.type == 1) {\r\n                item.craft.push(items);\r\n              }else{\r\n                item.material.push(items);\r\n              }\r\n            });\r\n          });\r\n          this.consumerCustomizedOrder_obj = res;\r\n        });\r\n      },\r\n      /**\r\n       * 获取量体信息\r\n       */\r\n      reservationOrderMeasurement_getDataByReservationOrderId(reservationOrderId) {\r\n        this.request(\r\n          this.api.order.reservationOrderMeasurement_getDataByReservationOrderId,\r\n          {\r\n            // reservationOrderId:\"5f174e93-10af-4578-917d-5bc854e85949\"\r\n            reservationOrderId\r\n          }\r\n        ).then(res => {\r\n          this.getDataByReservationObj = res;\r\n        });\r\n      },\r\n      /**\r\n       * 跳转工单详情\r\n       */\r\n      href(routeName, param) {\r\n         this.$router.push({\r\n            path: '/' + routeName,\r\n            name: routeName,\r\n            query: param\r\n         })\r\n      },\r\n      /**\r\n       * 根据源单获取所有子表数据项\r\n       */\r\n      tableItemListByWorkOrderCode(sourceChileType, sourceId) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.tableItemListByWorkOrderCode,\r\n          {\r\n            code:sourceChileType,\r\n            sourceId\r\n          }\r\n        ).then(res => {\r\n          that.listByWorkOrderCode = res;\r\n          // 整理一对多字段集合\r\n          res.forEach((item, index) => {\r\n            if(item.linkType == 2) {\r\n              item.sublist.forEach((items, indexs) => {\r\n                if(!items.visible) return;\r\n                that.subObj[items.itemCode] = {\r\n                  name:items.itemName,\r\n                  isRead: items.isRead,\r\n                  jdbcType:items.jdbcType,\r\n                  visible:items.visible\r\n                  };\r\n              });\r\n            }\r\n          });\r\n          console.log(that.subObj)\r\n        });\r\n      },\r\n      /**\r\n       * 获取工单池详情基本信息\r\n       */\r\n      getHistoryWorkOrderGetByNum(number) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.getHistoryWorkOrderGetByNum,\r\n          {\r\n            number\r\n          }\r\n        ).then(res => {\r\n          const createTime = new Date('2019-06-04T09:54:58.000+0000').getTime();\r\n          const _createTime = new Date().getTime();\r\n          console.log(createTime)\r\n          console.log(this.formatDuring(_createTime-createTime))\r\n          that.historyWorkOrderGetByNumObj = res;\r\n          that.active = res.jobOrderStatus + 1;\r\n          that.historyWorkOrderGetByNumObj._createTime = this.formatDuring(_createTime-createTime);\r\n\r\n          if(that.historyWorkOrderGetByNumObj.sourceChileType == 'measuringWorkOrder') {\r\n            this.reservationOrderMeasurement_getDataByReservationOrderId(this.$route.query.sourceId);// 获取量体信息\r\n          }\r\n          if(that.historyWorkOrderGetByNumObj.sourceChileType == 'consumerCustomizedOrder'){\r\n            this.consumerCustomizedOrder_get(this.$route.query.sourceId);// 获取定制信息\r\n          }\r\n\r\n        });\r\n      },\r\n      /**\r\n       *\r\n       */\r\n      formatDuring(mss) {\r\n          var days = parseInt(mss / (1000 * 60 * 60 * 24));\r\n          var hours = parseInt((mss % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n          var minutes = parseInt((mss % (1000 * 60 * 60)) / (1000 * 60));\r\n          var seconds = (mss % (1000 * 60)) / 1000;\r\n          return `${days}天${hours}时${minutes}分`;\r\n      },\r\n      /**\r\n      * 提示\r\n      */\r\n      warn(message, type) {\r\n        this.$message({\r\n          message: message,\r\n          type: type || 'warning'\r\n        });\r\n      },\r\n      /**\r\n       * 获取工单跟进记录列表\r\n       */\r\n      getWorkOrderLog_list(number) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.getWorkOrderLog_list,\r\n          {\r\n            number\r\n          }\r\n        ).then(res => {\r\n          that.workOrderLog_list = res.data.reverse();\r\n        });\r\n      },\r\n      /**\r\n       * 添加一条跟进记录\r\n       */\r\n      addHistoryWorkOrderFollowUp() {\r\n        const that = this;\r\n        console.log(this.historyWorkOrderGetByNumObj)\r\n        this.request(\r\n          that.api.job_order.addHistoryWorkOrderFollowUp,\r\n          Object.assign(this.historyWorkOrderGetByNumObj, {\r\n            updateName: this.userInfo.loginName\r\n          })\r\n        ).then(res => {\r\n          this.warn('添加成功！','success');\r\n          this.getWorkOrderLog_list(this.$route.query.number);\r\n        });\r\n      },\r\n      open() {\r\n        this.$prompt(\"添加一条跟进记录\", \"提示\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\"\r\n        }).then(({ value }) => {\r\n          if(!value) return;\r\n          this.historyWorkOrderGetByNumObj.remarks = value;\r\n          this.addHistoryWorkOrderFollowUp();\r\n        })\r\n      }\r\n\r\n    },\r\n    computed: {\r\n      ...mapGetters({\r\n        userInfo: userTypes.GETTER_USERINFO\r\n      })\r\n    },\r\n    components: {\r\n      codeSet,\r\n      treeDept\r\n    }\r\n  }\r\n</script>\r\n<style  lang=\"less\" scoped>\r\n  .jdbcType-image{\r\n    width: 35px;\r\n    height: 35px;\r\n  }\r\n  .the-results{\r\n    // width: 1500px;\r\n    display: flex;\r\n    text-align: right;\r\n    flex-wrap: wrap;\r\n    .the-results-span{\r\n      width: 370px;\r\n    }\r\n  }\r\n  .the-results-three-rows{\r\n    // width: 1150px;\r\n  }\r\n  .text-indent15{\r\n    text-indent: 15px;\r\n  }\r\n  .text-indent45{\r\n    text-indent: 45px;\r\n  }\r\n    .text-indent75{\r\n    text-indent: 75px;\r\n  }\r\n  .color243{\r\n    color:rgb(243, 131, 3);\r\n  }\r\n.spu {\r\n  li {\r\n    div{\r\n      display: flex;\r\n      border-bottom: 1px solid #f0f0f0;\r\n      span {\r\n        height: 50px;\r\n        flex: 1;\r\n        line-height: 50px;\r\n        position: relative;\r\n        text-align: center;\r\n      }\r\n      .text-left{\r\n        text-align: left;\r\n      }\r\n      img {\r\n        width: 40px;\r\n        height: 40px;\r\n      }\r\n    }\r\n    .spu-border {\r\n      border-bottom: 1px solid rgb(243, 131, 3);\r\n    }\r\n  }\r\n}\r\n  .display-flex{\r\n    display: flex;\r\n  }\r\n  .subImg{\r\n    width: 35px;\r\n    height: 35px;\r\n  }\r\n  .correlationData-p{\r\n    border-bottom: 1px solid #f0f0f0;\r\n    padding-bottom: 20px;\r\n    margin-bottom: 20px;\r\n  }\r\n  h5 {\r\n    color: #222;\r\n    margin-left: -30px;\r\n  }\r\n  .s{\r\n    margin-top:10px;\r\n    display:block;\r\n    font-size:15px;\r\n    color: #66b1ff;\r\n  }\r\n  .test {\r\n    color: #9d9d9d;\r\n  }\r\n  .work-order-info {\r\n    display: flex;\r\n    justify-content: space-between;\r\n  }\r\n  .info-list {\r\n    display: flex;\r\n    width: 80%;\r\n    flex-wrap: wrap;\r\n    padding: 15px 10px 0 10px;\r\n    li {\r\n      padding-bottom: 10px;\r\n      margin-right: 30px;\r\n    }\r\n  }\r\n  .correlationData{\r\n    height: 300px;\r\n    overflow-y:scroll;\r\n    padding:0 15px 15px 15px;\r\n      h3{\r\n        font-size: 16px;\r\n        padding: 15px 0;\r\n      }\r\n      ul{\r\n        display: flex;\r\n        flex-wrap:wrap;\r\n        li{\r\n          width: 20%;\r\n          text-indent: 20px;\r\n          padding: 5px 0;\r\n        }\r\n        img{\r\n          width: 120px;\r\n          height: 150px;\r\n        }\r\n        span{\r\n          display: block;\r\n          margin-top: 10px;\r\n        }\r\n      }\r\n  }\r\n</style>\r\n"]}]}