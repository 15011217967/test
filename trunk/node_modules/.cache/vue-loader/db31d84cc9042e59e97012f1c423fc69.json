{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\OC\\components\\divisionList.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\OC\\components\\divisionList.vue","mtime":1572415125279},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n    name: \"division-list\",\n    props: {\n        viewModel: {\n            // 接收绑定参数\n\n        }\n    },\n    watch: {\n    },\n    data() {\n        return {\n            proList: [],\n            muniList: [],\n            areaList: []\n        };\n    },\n    created() {\n        // 获取数据\n        this.getAllDivision()\n    },\n    methods: {\n        // 省的选择事件\n        provinceChangeEvent(code) {\n            let pro = this.proList.find(t => t.code == code);\n            if(pro){\n                this.viewModel.province = pro.name;\n                this.viewModel.provinceCode = pro.code;\n                this.muniList = this.divisionInfo.municipalitys[code];\n            }else {\n                this.muniList = [];\n            }\n            this.viewModel.municipality = '';\n            this.viewModel.municipalityCode = '';\n            this.viewModel.area = '';\n            this.viewModel.areaCode = '';\n            this.areaList = [];\n        },\n        // 城市的选择事件\n        cityChangeEvent(code) {\n            let muti = this.muniList.find(t => t.code == code);\n            if(muti){\n                this.viewModel.municipality = muti.name;\n                this.viewModel.municipalityCode = muti.code;\n                this.areaList = this.divisionInfo.areas[code];\n            }else {\n                this.areaList = [];\n            }\n            this.viewModel.area = '';\n            this.viewModel.areaCode = '';\n        },\n        // 区的选择事件\n        areaChangeEvent(code) {\n            let area = this.areaList.find(t => t.code == code);\n            if(area){\n                this.viewModel.area = area.name;\n                this.viewModel.areaCode = area.code;\n                this.viewModel.divisionId = area.id;\n                this.$emit(\"set-division\", this.viewModel);\n            }\n        },\n        // 获取所有的省市区回显组合及下拉数据\n        async getAllDivision() {\n            if(localStorage.getItem(\"divisionInfo\") != null) {\n                this.divisionInfo = JSON.parse(localStorage.getItem(\"divisionInfo\"));\n                this.proList = this.divisionInfo.provinces;\n                this.getEditList();\n                return;\n            }\n            // 获取省市区下拉数据\n            let divisionInfo = await this.request(this.api.system.division_get_info, {});\n            // 初始化数据 转对象\n            if(divisionInfo && divisionInfo.municipalitys.length){\n                let municipalitys = {};\n                divisionInfo.municipalitys.forEach(item => {\n                    let key = Object.keys(item)[0];\n                    municipalitys[key] = item[key];\n                });\n                divisionInfo.municipalitys = municipalitys;\n            }else{\n                divisionInfo.municipalitys = {};\n            }\n            if(divisionInfo && divisionInfo.areas.length){\n                let areas = {};\n                divisionInfo.areas.forEach(item => {\n                    let key = Object.keys(item)[0];\n                    areas[key] = item[key];\n                })\n                divisionInfo.areas = areas;\n            }else {\n                divisionInfo.areas = {};\n            }\n            this.divisionInfo = divisionInfo;\n            // 获取省份数据\n            this.proList = this.divisionInfo.provinces;\n            // 获取市区数据\n            this.getEditList();\n            // 存储下拉数据\n            localStorage.setItem(\"divisionInfo\", JSON.stringify(this.divisionInfo));\n        },\n        // 编辑获取子集列表\n        getEditList(){\n            if(this.viewModel.provinceCode){\n                this.muniList = this.divisionInfo.municipalitys[this.viewModel.provinceCode];\n            }\n            if(this.viewModel.municipalityCode){\n                this.areaList = this.divisionInfo.areas[this.viewModel.municipalityCode];\n            }\n        }\n    }\n};\n",{"version":3,"sources":["divisionList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"divisionList.vue","sourceRoot":"src/views/OC/components","sourcesContent":["<template>\r\n    <div class=\"cont-inline\">\r\n        <el-select v-model=\"viewModel.provinceCode\" @change='provinceChangeEvent' clearable placeholder=\"省/直辖市\">\r\n            <el-option v-for=\"(item,index) in proList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n        <el-select v-model=\"viewModel.municipalityCode\" @change=\"cityChangeEvent\" clearable placeholder=\"市\">\r\n            <el-option v-for=\"(item,index) in muniList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n        <el-select v-model=\"viewModel.areaCode\" @change=\"areaChangeEvent\" clearable placeholder=\"区/县\">\r\n            <el-option v-for=\"(item,index) in areaList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        name: \"division-list\",\r\n        props: {\r\n            viewModel: {\r\n                // 接收绑定参数\r\n\r\n            }\r\n        },\r\n        watch: {\r\n        },\r\n        data() {\r\n            return {\r\n                proList: [],\r\n                muniList: [],\r\n                areaList: []\r\n            };\r\n        },\r\n        created() {\r\n            // 获取数据\r\n            this.getAllDivision()\r\n        },\r\n        methods: {\r\n            // 省的选择事件\r\n            provinceChangeEvent(code) {\r\n                let pro = this.proList.find(t => t.code == code);\r\n                if(pro){\r\n                    this.viewModel.province = pro.name;\r\n                    this.viewModel.provinceCode = pro.code;\r\n                    this.muniList = this.divisionInfo.municipalitys[code];\r\n                }else {\r\n                    this.muniList = [];\r\n                }\r\n                this.viewModel.municipality = '';\r\n                this.viewModel.municipalityCode = '';\r\n                this.viewModel.area = '';\r\n                this.viewModel.areaCode = '';\r\n                this.areaList = [];\r\n            },\r\n            // 城市的选择事件\r\n            cityChangeEvent(code) {\r\n                let muti = this.muniList.find(t => t.code == code);\r\n                if(muti){\r\n                    this.viewModel.municipality = muti.name;\r\n                    this.viewModel.municipalityCode = muti.code;\r\n                    this.areaList = this.divisionInfo.areas[code];\r\n                }else {\r\n                    this.areaList = [];\r\n                }\r\n                this.viewModel.area = '';\r\n                this.viewModel.areaCode = '';\r\n            },\r\n            // 区的选择事件\r\n            areaChangeEvent(code) {\r\n                let area = this.areaList.find(t => t.code == code);\r\n                if(area){\r\n                    this.viewModel.area = area.name;\r\n                    this.viewModel.areaCode = area.code;\r\n                    this.viewModel.divisionId = area.id;\r\n                    this.$emit(\"set-division\", this.viewModel);\r\n                }\r\n            },\r\n            // 获取所有的省市区回显组合及下拉数据\r\n            async getAllDivision() {\r\n                if(localStorage.getItem(\"divisionInfo\") != null) {\r\n                    this.divisionInfo = JSON.parse(localStorage.getItem(\"divisionInfo\"));\r\n                    this.proList = this.divisionInfo.provinces;\r\n                    this.getEditList();\r\n                    return;\r\n                }\r\n                // 获取省市区下拉数据\r\n                let divisionInfo = await this.request(this.api.system.division_get_info, {});\r\n                // 初始化数据 转对象\r\n                if(divisionInfo && divisionInfo.municipalitys.length){\r\n                    let municipalitys = {};\r\n                    divisionInfo.municipalitys.forEach(item => {\r\n                        let key = Object.keys(item)[0];\r\n                        municipalitys[key] = item[key];\r\n                    });\r\n                    divisionInfo.municipalitys = municipalitys;\r\n                }else{\r\n                    divisionInfo.municipalitys = {};\r\n                }\r\n                if(divisionInfo && divisionInfo.areas.length){\r\n                    let areas = {};\r\n                    divisionInfo.areas.forEach(item => {\r\n                        let key = Object.keys(item)[0];\r\n                        areas[key] = item[key];\r\n                    })\r\n                    divisionInfo.areas = areas;\r\n                }else {\r\n                    divisionInfo.areas = {};\r\n                }\r\n                this.divisionInfo = divisionInfo;\r\n                // 获取省份数据\r\n                this.proList = this.divisionInfo.provinces;\r\n                // 获取市区数据\r\n                this.getEditList();\r\n                // 存储下拉数据\r\n                localStorage.setItem(\"divisionInfo\", JSON.stringify(this.divisionInfo));\r\n            },\r\n            // 编辑获取子集列表\r\n            getEditList(){\r\n                if(this.viewModel.provinceCode){\r\n                    this.muniList = this.divisionInfo.municipalitys[this.viewModel.provinceCode];\r\n                }\r\n                if(this.viewModel.municipalityCode){\r\n                    this.areaList = this.divisionInfo.areas[this.viewModel.municipalityCode];\r\n                }\r\n            }\r\n        }\r\n    };\r\n</script>\r\n<style scoped>\r\n.el-form-item__content{\r\n    width: 80%;\r\n}\r\n.el-select{\r\n    width: 25%;\r\n}\r\n.cont-inline{\r\n    display: inline;\r\n}\r\n</style>\r\n"]}]}