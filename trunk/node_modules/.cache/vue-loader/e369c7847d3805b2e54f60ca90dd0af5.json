{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\orders\\business\\purchase\\purchaseOrder_editor.vue?vue&type=style&index=0&id=b9c5f7c4&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\orders\\business\\purchase\\purchaseOrder_editor.vue","mtime":1572415125101},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\css-loader\\index.js","mtime":1558492728478},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1558492728890},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\postcss-loader\\src\\index.js","mtime":1558492728823},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\less-loader\\dist\\cjs.js","mtime":1566193719488},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n/* .treeDept{\r\n backgroun\r\n} */\r\n.input-div {\r\n  .data-div {\r\n    width: 100%;\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 120px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n  .middle-data-div {\r\n    width: 100%;\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 90px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n  .last-data-div {\r\n    width: 100%;\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 110px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n}\r\n.actual-amount-input {\r\n  display: inline-block;\r\n  border: 1px solid #d4d4d4;\r\n  height: 32px;\r\n  width: 100px;\r\n  padding-left: 5px;\r\n  border-radius: 3px;\r\n}\r\n.recoment-input .contentInput {\r\n  display: inline-block;\r\n  width: 300px;\r\n}\r\n.remarks-textarea {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.remarks-textarea .textarea {\r\n  display: inline-block;\r\n  width: 300px;\r\n}\r\n.label-style {\r\n  display: inline-block;\r\n  width: 68px;\r\n}\r\n.title {\r\n  background-color: #fff;\r\n  padding: 15px 0 15px 30px;\r\n}\r\n.title > span {\r\n  display: inline-block;\r\n  background-color: #fff;\r\n  margin-left: 3px;\r\n}\r\n.middle {\r\n  background-color: #fff;\r\n  margin: 8px;\r\n  margin-bottom: 0;\r\n  height: 100%;\r\n}\r\n.middle > span {\r\n  display: inline-block;\r\n  margin: 20px 0 30px 30px;\r\n}\r\n.el-form-item__content {\r\n  line-height: 40px;\r\n  /* position: relative; */\r\n  font-size: 14px;\r\n  display: inline-block;\r\n  /* margin-right: 150px; */\r\n  // width: 300px;\r\n  white-space: nowrap;\r\n}\r\n.el-select {\r\n  display: inline-block;\r\n  /* position: relative; */\r\n  width: 130px;\r\n  margin-right: 10px;\r\n}\r\n.table-view {\r\n  /* margin-left: 30px; */\r\n  /* margin-bottom: 20px; */\r\n  padding: 0 30px;\r\n  background-color: #fff;\r\n}\r\n.title-div {\r\n  margin: 20px 0 30px;\r\n}\r\n.title-div span {\r\n  background-color: #409eff;\r\n  padding: 8px 20px;\r\n  color: #fff;\r\n  border-radius: 5px;\r\n}\r\n.title-div span:first-child {\r\n  background-color: #fff;\r\n  color: #222;\r\n  padding: 0 8px;\r\n  margin-right: 40px;\r\n}\r\n.money-div {\r\n  background-color: #fff;\r\n  width: 100%;\r\n  text-align: right;\r\n  padding-right: 30px;\r\n  margin-top: 30px;\r\n}\r\n.input-price {\r\n  display: inline-block;\r\n  padding: 10px;\r\n  width: 100px;\r\n  border-radius: 5px;\r\n}\r\n.money-content {\r\n  margin: 8px 0;\r\n}\r\n.price-msg {\r\n  padding: 30px;\r\n  background-color: #fff;\r\n}\r\n.price-msg > span {\r\n  display: inline-block;\r\n  margin-bottom: 20px;\r\n}\r\n.block {\r\n  display: flex;\r\n}\r\n.block > span {\r\n  display: inline-block;\r\n  margin-right: 10px;\r\n}\r\n\r\n.btn-div {\r\n  margin-left: 70px;\r\n  margin-top: 30px;\r\n}\r\n.division-type {\r\n  widows: 100%;\r\n  // background-color: aquamarine;\r\n  display: flex;\r\n  justify-items: center;\r\n}\r\n",{"version":3,"sources":["purchaseOrder_editor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAssBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"purchaseOrder_editor.vue","sourceRoot":"src/views/orders/business/purchase","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"middle\">\r\n      <span>基本信息</span>\r\n      <div class=\"input-div\">\r\n        <el-form\r\n          ref=\"formData\"\r\n          :inline=\"true\"\r\n          :model=\"signData\"\r\n          label-width=\"120px\"\r\n          :rules=\"rules\"\r\n          class=\"demo-ruleForm\"\r\n        >\r\n          <div class=\"data-div\">\r\n            <div>\r\n              <el-form-item label=\"组织机构：\" prop=\"organization\">\r\n                <el-input v-model=\"signData.organization\" disabled></el-input>\r\n              </el-form-item>\r\n            </div>\r\n            <div>\r\n              <el-form-item label=\"供应商：\" prop=\"supplier\">\r\n                <el-select\r\n                  disabled\r\n                  @change=\"selectSupplierChange\"\r\n                  v-model=\"signData.supplier\"\r\n                  placeholder=\"请选择\"\r\n                >\r\n                  <el-option\r\n                    v-for=\"item in signData.optionData\"\r\n                    :label=\"item.name\"\r\n                    :key=\"item.id\"\r\n                    :value=\"item.name\"\r\n                  ></el-option>\r\n                </el-select>\r\n                <!-- <code-set v-model=\"signData.supplier\" code=\"COM003\"/> -->\r\n              </el-form-item>\r\n            </div>\r\n            <div>\r\n              <el-form-item label=\"采购合同号：\" prop>\r\n                <el-input placeholder=\"请输入内容\" v-model=\"signData.contractSn\"></el-input>\r\n              </el-form-item>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"middle-data-div\">\r\n            <div>\r\n              <el-form-item label=\"交货日期：\" prop>\r\n                <el-date-picker v-model=\"signData.deliveryTime\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\r\n              </el-form-item>\r\n            </div>\r\n\r\n            <div>\r\n              <el-form-item label=\"合同签订日期：\" prop>\r\n                <el-date-picker v-model=\"signData.signTime\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\r\n              </el-form-item>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"last-data-div\">\r\n            <div class=\"el-form-item\">\r\n              <el-form-item label=\"是否按税点采购：\" label-width=\"140px\">\r\n                <el-radio v-model=\"signData.radio\" label=\"1\" @change='radioStatusChange'>否</el-radio>\r\n                <el-radio v-model=\"signData.radio\" label=\"2\" @change='radioStatusChange'>是</el-radio>\r\n                <!-- <el-form-item label=\"税点：\" label-width=\"60px\"> -->\r\n                <span style='margin-right:10px;'>税点</span>\r\n                  <el-select\r\n                    @change=\"taxPointChange\"\r\n                    :disabled=\"signData.radio==1\"\r\n                    v-model=\"signData.tax\"\r\n                    placeholder=\"请选择\"\r\n                  >\r\n                    <el-option label=\"3%\" value=\"3%\"></el-option>\r\n                    <el-option label=\"13%\" value=\"13%\"></el-option>\r\n                  </el-select>\r\n                </el-form-item>\r\n              <!-- </el-form-item> -->\r\n            </div>\r\n          </div>\r\n        </el-form>\r\n      </div>\r\n\r\n      <div class=\"table-view\">\r\n        <div class=\"title-div\">\r\n          <span>商品信息</span>\r\n          <span @click=\"selectShopClickEvent\">选择商品</span>\r\n        </div>\r\n        <div class=\"table-div\">\r\n          <el-table\r\n            :data=\"signData.channelOrderGoodsVOList\"\r\n            style=\"width: 100%\"\r\n            header-row-class-name=\"item-table-header\"\r\n          >\r\n            <el-table-column prop=\"productCode\" label=\"商品款号\" width></el-table-column>\r\n            <el-table-column prop=\"code\" label=\"商品货号\" width align=\"center\"></el-table-column>\r\n            <el-table-column label=\"商品图片\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <img :src=\"scope.row.image\" style=\"width:32px;height:32px;\" />\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"name\" label=\"商品名称\" width align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"type\" label=\"商品类型\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{scope.row.type?scope.row.type:'--'}}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"brandName\" label=\"品牌\" width align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"category\" label=\"商品品类\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{scope.row.category?scope.row.category:'--'}}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"originalCode\" label=\"原始款号\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{scope.row.originalCode?scope.row.originalCode:'--'}}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"规格属性\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <span>颜色：{{scope.row.color?scope.row.color:'--'}}</span>\r\n                <br />\r\n                <span>尺寸：{{scope.row.size?scope.row.size:'--'}}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"采购单价\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input\r\n                  v-model=\"scope.row.purchasePrice\"\r\n                  placeholder=\"请输入内容\"\r\n                  type=\"number\"\r\n                  @change=\"purchasePriceChange\"\r\n                ></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"tax\" label=\"税点\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{scope.row.tax?scope.row.tax:'--'}}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"采购单价(含税)\" width align=\"center\">\r\n              <template  slot-scope=\"scope\">\r\n                <input\r\n                  v-model=\"scope.row.actualAmount\"\r\n                  class=\"actual-amount-input\"\r\n                  type=\"number\"\r\n                  placeholder=\"请输入内容\"\r\n                  @input=\"actualAmountChange(scope.row)\"\r\n                  v-if=\"scope.row.actualAmount\"\r\n                />\r\n                <span v-else>--</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"数量\" width=\"200\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input-number\r\n                  v-model=\"scope.row.num\"\r\n                  @change=\"shopNumberChange($event,scope.row)\"\r\n                  :min=\"0\"\r\n                  v-enter-number\r\n                ></el-input-number>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"采购金额\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input\r\n                  v-model=\"scope.row.amount\"\r\n                  placeholder=\"请输入内容\"\r\n                  @input=\"amountChange($event,scope.row)\"\r\n                ></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"备注\" width align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input v-model=\"scope.row.remarks\" placeholder=\"请输入内容\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </div>\r\n\r\n        <div class=\"money-div\">\r\n          <span>采购商品总金额：￥{{signData.amount?signData.amount:'0.00'}}</span>\r\n          <div class=\"money-content\">\r\n            <span>其他扣减项金额：</span>\r\n            <input\r\n              type=\"text\"\r\n              v-model=\"signData.preferentialRemarks\"\r\n              class=\"input-price\"\r\n              placeholder=\"填写优惠项\"\r\n            />\r\n            <span>￥</span>\r\n            <input\r\n              type=\"number\"\r\n              min=\"0\"\r\n              max=\"100\"\r\n              @change=\"priceInputChangeEvent\"\r\n              class=\"input-price\"\r\n              v-model=\"signData.preferentialAmount\"\r\n              placeholder=\"0.00\"\r\n            />\r\n          </div>\r\n          <span>采购应付金额：￥{{signData.actualAmount?signData.actualAmount:'0.00'}}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"price-msg\">\r\n        <span>付款信息</span>\r\n        <el-form :inline=\"true\" :model=\"signData\" ref=\"formInlineFrom\" class=\"demo-form-inline\">\r\n          <el-form-item label=\"付款方式：\">\r\n            <code-set v-model=\"signData.paymentCode\" code=\"COM003\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"支付流水号(支付单据)：\">\r\n            <el-input v-model=\"signData.orderTradeNo\" placeholder=\"请输入内容\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"实付金额：\">\r\n            <el-input type=\"number\" v-model=\"signData.validAmount\" placeholder=\"请输入内容\" @input=\"validAmountValueChangeEvent\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <div class=\"block\">\r\n              <span class=\"demonstration\">支付时间:</span>\r\n              <el-date-picker v-model=\"signData.createTime\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\r\n            </div>\r\n          </el-form-item>\r\n        </el-form>\r\n\r\n        <span class=\"other-msg\">其他信息</span>\r\n\r\n        <div class=\"remarks-textarea\">\r\n          <span>采购备注：</span>\r\n          <el-input\r\n            class=\"textarea\"\r\n            type=\"textarea\"\r\n            :rows=\"2\"\r\n            placeholder=\"请输入内容\"\r\n            v-model=\"signData.remarks\"\r\n            resize=\"none\"\r\n          ></el-input>\r\n        </div>\r\n        <div class=\"btn-div\">\r\n          <el-button type=\"primary\" @click=\"primaryBtnClick\" size=\"small\">确认</el-button>\r\n          <el-button plain @click=\"plainBtnClick\" size=\"small\">取消</el-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport codeSet from \"@/components/codeSet\";\r\nimport treeDept from \"@/components/treeDept\";\r\nimport { constants } from \"crypto\";\r\nexport default {\r\n  components: {\r\n    codeSet,\r\n    treeDept\r\n  },\r\n  data() {\r\n    return {\r\n      signData: {\r\n        orderType: \"0301\",\r\n        //组织机构\r\n        organizationCode: \"\",\r\n        organization: \"\",\r\n        //selectChange\r\n        //货主\r\n        goodsOwner:'',\r\n        //税点\r\n        tax: \"\",\r\n        deliveryDate: \"\",\r\n        //供货商\r\n        supplier: \"\",\r\n        //供货商编码\r\n        supplierCode: \"\",\r\n        //采购合同号\r\n        contractSn: \"\",\r\n        signTime: \"\",\r\n        //采购备注\r\n        remarks: \"\",\r\n        //选择日期\r\n        createTime: \"\",\r\n        //支付方式\r\n        paymentCode: \"\",\r\n        //商品数据表\r\n        channelOrderGoodsVOList: null,\r\n        optionData: [],\r\n        //实付金额\r\n        validAmount:'0.00',\r\n        //扣减原因\r\n        preferentialRemarks: \"\",\r\n        //扣减金额\r\n        preferentialAmount: \"\",\r\n        //采购商品金额\r\n        amount: \"\",\r\n        //采购付款金额\r\n        actualAmount: \"\",\r\n        //选项框\r\n        radio: \"1\"\r\n      },\r\n      rules: {\r\n        tax: [{ required: true, message: \"请选择税点\", trigger: \"change\" }],\r\n        supplier: [\r\n          { required: true, message: \"供货商不能为空\", trigger: \"change\" }\r\n        ],\r\n        organization: [\r\n          { required: true, message: \"组织机构不能为空\", trigger: \"change\" }\r\n        ],\r\n      },\r\n\r\n      //填写的优惠金额\r\n      price: \"\",\r\n\r\n      //文本域输入\r\n      textarea: \"\",\r\n\r\n      orderPrice: \"\",\r\n      shopRetailPrice: \"\"\r\n    };\r\n  },\r\n  created() {\r\n    //得到组织机构数据\r\n    this.getWarehouseListData();\r\n\r\n    let _type = localStorage.getItem(\"type\") || \"\";\r\n    console.log(_type);\r\n    if (_type == \"add\") {\r\n      //得到需要编辑的数据\r\n      this.getEditorData(this.$route.query.orderSn)\r\n    } else {\r\n      if (localStorage.getItem(\"localTableData\") == null) {\r\n        return;\r\n      }\r\n      console.log(\"channelOrderGoodsVOList\")\r\n      //存储填写的信息\r\n      var shopData = localStorage.getItem(\"shopMsgData\");\r\n      this.$nextTick(() => {\r\n        this.signData = JSON.parse(shopData);\r\n        var amount = localStorage.getItem(\"allShopPrice\");\r\n        console.log(amount)\r\n        //赋值订单总金额\r\n        this.signData.amount=parseFloat(amount).toFixed(2)\r\n        this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n        this.signData.channelOrderGoodsVOList = JSON.parse(\r\n          localStorage.getItem(\"localTableData\")\r\n        );\r\n        this.taxPointChange(this.signData.tax)\r\n        console.log(this.signData.channelOrderGoodsVOList);\r\n        this.setOrderShopDataArr();\r\n      });\r\n    }\r\n  },\r\n  watch: {\r\n    \"signData.preferentialAmount\": function(newPrice) {\r\n      var actualAmount = this.signData.amount - newPrice;\r\n      this.signData.actualAmount=actualAmount.toFixed(2)\r\n    }\r\n  },\r\n  filters: {\r\n    rowType(type) {\r\n      switch (type) {\r\n        case 1:\r\n          return \"成衣\";\r\n          break;\r\n        case 2:\r\n          return \"样衣\";\r\n          break;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    //得到组织机构数据\r\n    async getWarehouseListData() {\r\n      let info = await this.request(this.api.user.get_userinfo, {}, true);\r\n      console.log(info);\r\n      //得到部门Id\r\n      this.signData.relationDepId = info.departId;\r\n\r\n      this.request(this.api.user.userCompany_getUserOrgByUserId, {\r\n        userId: info.userId,\r\n        type: 0\r\n      }).then(data => {\r\n        console.log(data);\r\n        // this.organizationListData=data\r\n        //得到机构\r\n        this.signData.organization = data.name;\r\n        //得到机构code\r\n        this.signData.organizationCode = data.id;\r\n        //获取货主列表\r\n        this.getGoodsOwnerListData(this.signData.organizationCode);\r\n        //得到供货商数据\r\n        this.getSupplierListData(this.signData.organizationCode)\r\n      });\r\n    },\r\n    //得到供货商数据\r\n    getSupplierListData(organizationId) {\r\n      console.log(246);\r\n      //cooperation 为true得到有合作的供应商 不传 得到全部的供应商\r\n      this.request(this.api.product.supplier_list, {organizationId:organizationId,cooperation:true}).then(data => {\r\n        console.log(data);\r\n        this.signData.optionData = data.data;\r\n      });\r\n    },\r\n    //获取货主列表\r\n    getGoodsOwnerListData(organizationId) {\r\n      this.request(this.api.system.goodsOwner_list, {\r\n        orgId: organizationId\r\n      }).then(data => {\r\n        console.log(data.data);\r\n        this.signData.goodsOwner = data.data[0].code;\r\n      });\r\n    },\r\n    //设置采购金额\r\n    setOrderShopDataArr() {\r\n      let orderData = this.signData.channelOrderGoodsVOList;\r\n      let _that = this;\r\n      if (orderData.length > 0) {\r\n        orderData.forEach(item => {\r\n          _that.$set(\r\n            item,\r\n            \"amount\",\r\n            (item.purchasePrice * item.num).toFixed(2)\r\n          );\r\n        });\r\n      }\r\n    },\r\n    //实付金额值改变的事件\r\n    validAmountValueChangeEvent(val){\r\n      if(!val)return\r\n      var validAmount=val.match(/^\\d*(\\.?\\d{0,2})/g)\r\n      this.signData.validAmount=validAmount[0]\r\n    },\r\n    //价格变化事件\r\n    priceInputChangeEvent() {\r\n      console.log(this.price);\r\n    },\r\n    //选择支付方式\r\n    paySelectWay(item) {\r\n      console.log(item);\r\n    },\r\n    //点击选择商品\r\n    selectShopClickEvent() {\r\n      console.log(\"selectShopClickEvent======show_purchaseOrder_shop======236\");\r\n      this.$router.push({\r\n        path: \"/show_procureOrder_shop\",\r\n        name: \"show_procureOrder_shop\",\r\n        query:{\r\n          tenantId:this.signData.goodsOwner,\r\n          organizationName: this.signData.organization,\r\n        }\r\n      });\r\n      //存储填写的信息\r\n      localStorage.setItem(\"shopMsgData\", JSON.stringify(this.signData));\r\n      localStorage.setItem(\"localTableData\",JSON.stringify(this.signData.channelOrderGoodsVOList));\r\n    },\r\n     //得到初始数据\r\n    getEditorData(orderSn) {\r\n      this.request(this.api.order.channelPurchaseOrder_getByOrderSn, {\r\n        orderSn: orderSn,\r\n        pageIndex:'',\r\n        pageSize:''\r\n      }).then(data => {\r\n        console.log(data);\r\n        if(data.tax){\r\n          var tmpTax=data.tax*100\r\n          data.tax=tmpTax+\"%\"\r\n          this.signData=data\r\n          this.$set(this.signData,'radio','2')\r\n          data.channelOrderGoodsVOList.data.forEach(item => {\r\n            this.$set(item,'tax', data.tax)\r\n          });\r\n        }else{\r\n          this.signData=data\r\n          this.$set(this.signData,'radio','1')\r\n        }\r\n        if(data.channelOrderGoodsVOList.data){\r\n            data.channelOrderGoodsVOList.data.forEach(item=>{\r\n                if(item.actualAmount){\r\n                    item.amount=parseFloat(item.actualAmount*item.num).toFixed(2)\r\n                }else{\r\n                    item.amount=parseFloat(item.purchasePrice*item.num).toFixed(2)\r\n                }\r\n            })\r\n         this.signData.channelOrderGoodsVOList=data.channelOrderGoodsVOList.data\r\n        }\r\n        var amount=0\r\n        this.signData.channelOrderGoodsVOList.forEach(item => {\r\n          amount+=parseFloat(item.amount)\r\n        })\r\n        this.signData.amount=parseFloat(amount).toFixed(2)\r\n        this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n        });\r\n    },\r\n    //确认按钮的点击事件\r\n    primaryBtnClick() {\r\n      this.$refs.formData.validate(valid => {\r\n        if (valid) {\r\n          // this.signData.organization = this.$refs.treeDept.$refs.input.value;\r\n          if (this.signData.channelOrderGoodsVOList) {\r\n            this.signData.channelOrderGoodsVOList.forEach(item => {\r\n              item.unitPrice = item.purchasePrice;\r\n            });\r\n          }else{\r\n            this.$message.error('商品数量不能全部为0');\r\n            return\r\n          }\r\n          let validAmount=this.signData.validAmount;\r\n          console.log(typeof(validAmount) )\r\n          if((validAmount == '' && typeof(validAmount) != 'number') || typeof(validAmount) == \"undefined\"){\r\n            this.$message.error('请输入实付金额');\r\n            return\r\n          }\r\n          //过滤商品数量\r\n          var filterOrderGoodsVOListData=this.signData.channelOrderGoodsVOList.filter(item=>{\r\n            return item.num && item.num!=0\r\n          })\r\n          if(filterOrderGoodsVOListData.length==0){\r\n            this.$message.error('采购商品数量不能全部为0');\r\n            return\r\n          }\r\n          this.signData.channelCode='04'\r\n          this.signData.channelOrderGoodsVOList=filterOrderGoodsVOListData\r\n          console.log(\"primaryBtnClick\");\r\n          if (this.signData.tax) {\r\n            let subTax = this.signData.tax.slice(0, this.signData.tax.length - 1);\r\n            let taxNum = subTax / 100;\r\n            this.signData.tax = taxNum;\r\n          }\r\n          this.request(\r\n            this.api.order.channelPurchaseOrder_save,\r\n            this.signData\r\n          ).then(data => {\r\n            //此处应该时上传成功后，再删除\r\n            localStorage.removeItem(\"localTableData\");\r\n            this.signData.channelOrderGoodsVOList = [];\r\n            this.$router.go(-1);\r\n          });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //存储供应商编码\r\n    selectSupplierChange(val) {\r\n      let suppliceObj = this.signData.optionData.find(item => item.name == val);\r\n      this.signData.supplierCode = suppliceObj.code;\r\n    },\r\n    //取消按钮的点击事件\r\n    plainBtnClick() {\r\n      this.$router.go(-1);\r\n    },\r\n    //数量检测\r\n    shopNumberChange(val, row) {\r\n      console.log(val)\r\n      if(!val){\r\n        val=0\r\n      }\r\n      if (row.tax && row.tax!='--') {\r\n        row.amount = parseFloat(row.actualAmount * val).toFixed(2);\r\n      } else {\r\n        row.amount = (row.purchasePrice * val).toFixed(2);\r\n      }\r\n      var amount=0\r\n      this.signData.channelOrderGoodsVOList.forEach(item => {\r\n        amount+=parseFloat(item.amount)\r\n      })\r\n      this.signData.amount=parseFloat(amount).toFixed(2)\r\n      if(this.signData.preferentialAmount){\r\n          this.signData.actualAmount =parseFloat(amount-Number(this.signData.preferentialAmount)).toFixed(2)\r\n        }else{\r\n          this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n        }\r\n      // this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n    },\r\n    //税点改变时\r\n    taxPointChange(val) {\r\n      console.log(val)\r\n      if (!val) {\r\n        return;\r\n      }\r\n      let subVal = val.slice(0, val.length - 1);\r\n      console.log(subVal)\r\n      if (this.signData.channelOrderGoodsVOList.length > 0) {\r\n        this.signData.channelOrderGoodsVOList.forEach(item => {\r\n          // item.tax = val;\r\n          this.$set(item,'tax',val)\r\n          //含税单价\r\n          item.actualAmount = parseFloat(item.purchasePrice * (subVal / 100+1)).toFixed(2);\r\n          //采购金额\r\n          item.amount = parseFloat(item.actualAmount * item.num).toFixed(2);\r\n        });\r\n        var amount=0\r\n        this.signData.channelOrderGoodsVOList.forEach(item => {\r\n          amount+=parseFloat(item.amount)\r\n        })\r\n        this.signData.amount=parseFloat(amount).toFixed(2)\r\n        if(this.signData.preferentialAmount){\r\n          this.signData.actualAmount =parseFloat(amount-Number(this.signData.preferentialAmount)).toFixed(2)\r\n        }else{\r\n          this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n        }\r\n        // this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n      }\r\n    },\r\n    //采购单价发生变化\r\n    purchasePriceChange(val) {\r\n      console.log(val);\r\n      if (!this.signData.tax) {\r\n        this.signData.channelOrderGoodsVOList.forEach(item => {\r\n          item.amount = (item.purchasePrice * item.num).toFixed(2)\r\n        });\r\n      } else {\r\n          let selectSubStr = (this.signData.tax.slice(0, this.signData.tax.length - 1) / 100).toFixed(2);\r\n          var subStr=parseFloat(selectSubStr)+1\r\n          this.signData.channelOrderGoodsVOList.forEach(item => {\r\n            item.actualAmount =(item.purchasePrice * subStr).toFixed(2);\r\n            item.amount = (item.actualAmount * item.num).toFixed(2)\r\n          });\r\n      }\r\n      var amount=0\r\n      this.signData.channelOrderGoodsVOList.forEach(item => {\r\n        amount+=parseFloat(item.amount)\r\n      })\r\n      this.signData.amount=parseFloat(amount).toFixed(2)\r\n      if(this.signData.preferentialAmount){\r\n          this.signData.actualAmount =parseFloat(amount-Number(this.signData.preferentialAmount)).toFixed(2)\r\n        }else{\r\n          this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n        }\r\n      // this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n    },\r\n    //采购金额发生变化了\r\n    amountChange(val, row) {\r\n      console.log(val);\r\n      console.log(row);\r\n    if(row.num==0)return\r\n    if (this.signData.tax) {\r\n        let selectVal = (this.signData.tax.slice(0, this.signData.tax.length - 1) / 100).toFixed(2);\r\n        var subStr=parseFloat(selectVal)+1\r\n        row.actualAmount = (row.amount / row.num).toFixed(2);\r\n        row.purchasePrice = (row.actualAmount / subStr).toFixed(2);\r\n      } else {\r\n        row.purchasePrice = (row.amount / row.num).toFixed(2);\r\n      }\r\n      var amount=0\r\n      this.signData.channelOrderGoodsVOList.forEach(item => {\r\n        if(!item.amount){\r\n          item.amount=\"0.00\"\r\n        }\r\n          amount+=parseFloat(item.amount)\r\n      })\r\n      this.signData.amount=parseFloat(amount).toFixed(2)\r\n      if(this.signData.preferentialAmount){\r\n          this.signData.actualAmount =parseFloat(amount-Number(this.signData.preferentialAmount)).toFixed(2)\r\n        }else{\r\n          this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n        }\r\n      // this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n    },\r\n    //含税金额发生改变\r\n    actualAmountChange(val) {\r\n      if (this.signData.tax) {\r\n        let selectVal = parseFloat(this.signData.tax.slice(0,this.signData.tax.length - 1)/100).toFixed(2);\r\n        var subStr=parseFloat(selectVal)+1\r\n        val.purchasePrice = parseFloat(val.actualAmount/subStr).toFixed(2);\r\n        val.amount = parseFloat(val.actualAmount * val.num).toFixed(2);\r\n      }\r\n      var amount=0\r\n      this.signData.channelOrderGoodsVOList.forEach(item => {\r\n        amount+=parseFloat(item.amount)\r\n      })\r\n      this.signData.amount=parseFloat(amount).toFixed(2)\r\n      if(this.signData.preferentialAmount){\r\n          this.signData.actualAmount =parseFloat(amount-Number(this.signData.preferentialAmount)).toFixed(2)\r\n        }else{\r\n          this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n        }\r\n      // this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n    },\r\n    //radio改变时触发\r\n    radioStatusChange(val){\r\n      console.log(val)\r\n     if(val==1){\r\n      //radio==否\r\n       this.signData.tax=\"0\"\r\n       var amount=0\r\n      if (this.signData.channelOrderGoodsVOList.length > 0) {\r\n        this.signData.channelOrderGoodsVOList.forEach(item => {\r\n          item.tax = '--';\r\n          //含税单价\r\n          item.actualAmount=null\r\n          //采购金额\r\n          item.amount = (item.purchasePrice * item.num).toFixed(2);\r\n        });\r\n      }\r\n      this.signData.channelOrderGoodsVOList.forEach(item => {\r\n        amount+=parseFloat(item.amount)\r\n      })\r\n      this.signData.amount=parseFloat(amount).toFixed(2)\r\n      if(this.signData.preferentialAmount){\r\n        this.signData.actualAmount =parseFloat(amount-Number(this.signData.preferentialAmount)).toFixed(2)\r\n      }else{\r\n        this.signData.actualAmount = parseFloat(amount).toFixed(2);\r\n      }\r\n     }else{\r\n      //radio==是\r\n      this.signData.tax=\"3%\"\r\n      this.taxPointChange(this.signData.tax)\r\n     }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/* .treeDept{\r\n backgroun\r\n} */\r\n.input-div {\r\n  .data-div {\r\n    width: 100%;\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 120px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n  .middle-data-div {\r\n    width: 100%;\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 90px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n  .last-data-div {\r\n    width: 100%;\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 110px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n}\r\n.actual-amount-input {\r\n  display: inline-block;\r\n  border: 1px solid #d4d4d4;\r\n  height: 32px;\r\n  width: 100px;\r\n  padding-left: 5px;\r\n  border-radius: 3px;\r\n}\r\n.recoment-input .contentInput {\r\n  display: inline-block;\r\n  width: 300px;\r\n}\r\n.remarks-textarea {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.remarks-textarea .textarea {\r\n  display: inline-block;\r\n  width: 300px;\r\n}\r\n.label-style {\r\n  display: inline-block;\r\n  width: 68px;\r\n}\r\n.title {\r\n  background-color: #fff;\r\n  padding: 15px 0 15px 30px;\r\n}\r\n.title > span {\r\n  display: inline-block;\r\n  background-color: #fff;\r\n  margin-left: 3px;\r\n}\r\n.middle {\r\n  background-color: #fff;\r\n  margin: 8px;\r\n  margin-bottom: 0;\r\n  height: 100%;\r\n}\r\n.middle > span {\r\n  display: inline-block;\r\n  margin: 20px 0 30px 30px;\r\n}\r\n.el-form-item__content {\r\n  line-height: 40px;\r\n  /* position: relative; */\r\n  font-size: 14px;\r\n  display: inline-block;\r\n  /* margin-right: 150px; */\r\n  // width: 300px;\r\n  white-space: nowrap;\r\n}\r\n.el-select {\r\n  display: inline-block;\r\n  /* position: relative; */\r\n  width: 130px;\r\n  margin-right: 10px;\r\n}\r\n.table-view {\r\n  /* margin-left: 30px; */\r\n  /* margin-bottom: 20px; */\r\n  padding: 0 30px;\r\n  background-color: #fff;\r\n}\r\n.title-div {\r\n  margin: 20px 0 30px;\r\n}\r\n.title-div span {\r\n  background-color: #409eff;\r\n  padding: 8px 20px;\r\n  color: #fff;\r\n  border-radius: 5px;\r\n}\r\n.title-div span:first-child {\r\n  background-color: #fff;\r\n  color: #222;\r\n  padding: 0 8px;\r\n  margin-right: 40px;\r\n}\r\n.money-div {\r\n  background-color: #fff;\r\n  width: 100%;\r\n  text-align: right;\r\n  padding-right: 30px;\r\n  margin-top: 30px;\r\n}\r\n.input-price {\r\n  display: inline-block;\r\n  padding: 10px;\r\n  width: 100px;\r\n  border-radius: 5px;\r\n}\r\n.money-content {\r\n  margin: 8px 0;\r\n}\r\n.price-msg {\r\n  padding: 30px;\r\n  background-color: #fff;\r\n}\r\n.price-msg > span {\r\n  display: inline-block;\r\n  margin-bottom: 20px;\r\n}\r\n.block {\r\n  display: flex;\r\n}\r\n.block > span {\r\n  display: inline-block;\r\n  margin-right: 10px;\r\n}\r\n\r\n.btn-div {\r\n  margin-left: 70px;\r\n  margin-top: 30px;\r\n}\r\n.division-type {\r\n  widows: 100%;\r\n  // background-color: aquamarine;\r\n  display: flex;\r\n  justify-items: center;\r\n}\r\n</style>\r\n"]}]}