{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\OS\\customOrder\\booking_order_detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\OS\\customOrder\\booking_order_detail.vue","mtime":1572415124453},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from \"axios\";\nimport { getToken } from \"@/utils/auth\";\nimport codeSet from \"@/components/codeSet\";\nimport treeDept from \"@/components/treeDept\";\nimport { filter } from \"minimatch\";\nimport { get } from \"http\";\nimport { mapGetters } from 'vuex';\nimport * as userTypes from \"@/types/userConfig\";\nlet token = getToken();\n\nexport default {\n  data() {\n    return {\n      orderStatus:{\n          100:'量体待确认',\n          101:'量体安排中',\n          102:'等待量体中',\n          103:'量体中',\n          104:'已量体',\n          105:'量体订单待回访'\n       },\n       orderType:{\n          20001:'量体预约单',\n          20002:'定制订单',\n       },\n      consumerReservationOrder_getObj:{},\n      workOrderLog_list:{},\n      tableItemGetListMapObj:{},\n      active: 3\n    };\n  },\n  created() {\n    this.consumerReservationOrder_get(this.$route.query.orderId);\n    this.getWorkOrderLog_list(this.$route.query.number);\n  },\n  methods: {\n    /**\n     * 获取量体订单详情基本信息\n     */\n    consumerReservationOrder_get(orderId) {\n      const that = this;\n\n      this.request(\n        that.api.order.consumerReservationOrder_get,\n        {\n          orderId\n        }\n      ).then(res => {\n        that.consumerReservationOrder_getObj = res;\n      });\n    },\n    /**\n    * 提示\n    */\n    warn(message, type) {\n      this.$message({\n        message: message,\n        type: type || 'warning'\n      });\n    },\n    /**\n     * 获取工单跟进记录列表\n     */\n    getWorkOrderLog_list(number) {\n      const that = this;\n\n      this.request(\n        that.api.job_order.getWorkOrderLog_list,\n        {\n          number\n        }\n      ).then(res => {\n        that.workOrderLog_list = res.data.reverse();\n      });\n    },\n    /**\n     * 添加一条跟进记录\n     */\n    addHistoryWorkOrderFollowUp() {\n      const that = this;\n      console.log(this.consumerReservationOrder_getObj)\n      this.request(\n        that.api.job_order.addHistoryWorkOrderFollowUp,\n        Object.assign(this.consumerReservationOrder_getObj, {\n          updateName: this.userInfo.loginName\n        })\n      ).then(res => {\n        this.warn('添加成功！','success');\n        this.getWorkOrderLog_list();\n      });\n    },\n    open() {\n      this.$prompt(\"添加一条跟进记录\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\"\n      }).then(({ value }) => {\n        if(!value) return;\n        this.consumerReservationOrder_getObj.remarks = value;\n        this.addHistoryWorkOrderFollowUp();\n      })\n    }\n\n  },\n  computed: {\n    ...mapGetters({\n      userInfo: userTypes.GETTER_USERINFO\n    })\n  },\n  components: {\n    codeSet,\n    treeDept\n  }\n}\n",{"version":3,"sources":["booking_order_detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"booking_order_detail.vue","sourceRoot":"src/views/OS/customOrder","sourcesContent":["<!-- 工单池 -->\r\n<template>\r\n  <div>\r\n    <div class=\"item-margin\">\r\n      <div class=\"booking_top\">\r\n        <!-- 工单基本信息 -->\r\n        <div class=\"work-order-info booking_info\">\r\n          <h4>\r\n            预约单号：{{ consumerReservationOrder_getObj.orderSn || '--' }}\r\n            <!-- <el-button type=\"primary\" size=\"mini\" class=\"ml-20\" disabled>量体中</el-button> -->\r\n          </h4>\r\n          <div class=\"booking_info_r\">\r\n            <span>量体</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"user\">\r\n          <div class=\"userInfo\">\r\n            <span class=\"userInfo-img\">\r\n              <img src=\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1560636369707&di=660b9e0aa82cbb69272a92683fc8f6ce&imgtype=0&src=http%3A%2F%2Fimg.zcool.cn%2Fcommunity%2F01786557e4a6fa0000018c1bf080ca.png\" alt=\"\">\r\n            </span>\r\n            <!-- <span class=\"userInfo-name\">客服ID 女</span> -->\r\n          </div>\r\n          <ul class=\"info-list\">\r\n            <li>预约单号：{{ consumerReservationOrder_getObj.orderSn || '--' }}</li>\r\n            <li>状态：{{ orderStatus[consumerReservationOrder_getObj.businessStatus] || '--' }}</li>\r\n            <li>量体类型：{{ orderType[consumerReservationOrder_getObj.orderType] || '--' }}</li>\r\n            <li>客户姓名：{{ consumerReservationOrder_getObj.userName || '--' }}</li>\r\n            <li>预约电话：{{ consumerReservationOrder_getObj.mobile || '--' }}</li>\r\n            <li>量体地址：{{ consumerReservationOrder_getObj.address || '--' }}</li>\r\n            <li>量体师：{{ consumerReservationOrder_getObj.measuringMasterName || '--' }}</li>\r\n            <li>关联版式：{{ consumerReservationOrder_getObj.fit || '--' }}</li>\r\n            <li>预约定金：{{ consumerReservationOrder_getObj.expectTime || '--' }}</li>\r\n            <!-- <li>期望量体时间：{{ consumerReservationOrder_getObj.expectTime || '--' | timestampToTime }}</li> -->\r\n            <li>关联订单：{{ consumerReservationOrder_getObj.customizedOrderSn || '--' }}</li>\r\n            <li>所属机构：{{ consumerReservationOrder_getObj.organization || '--' }}</li>\r\n            <li>创建时间：{{ consumerReservationOrder_getObj.createTime | timestampToTime}}</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n      <div class=\"item-margin\"></div>\r\n    </div>\r\n    <div class=\"item-margin\">\r\n      <div class=\"item-form\">\r\n        <!-- <el-steps :active=\"active\" finish-status=\"success\">\r\n          <el-step title=\"测试数据\"></el-step>\r\n          <el-step title=\"确认预约\"></el-step>\r\n          <el-step title=\"上门量体\"></el-step>\r\n          <el-step title=\"客户评价/回访\"></el-step>\r\n          <el-step title=\"已完成\"></el-step>\r\n        </el-steps> -->\r\n        <!-- 工单跟进记录 -->\r\n        <div class=\"work-order-info mt-40\" v-if=\"consumerReservationOrder_getObj.orderLogsVOList && consumerReservationOrder_getObj.orderLogsVOList.length > 0\">\r\n          <span class=\"order-course\">预约服务进程：</span>\r\n        </div>\r\n        <!-- 时间线 -->\r\n        <div class=\"block mt-20 order-record\" v-if=\"consumerReservationOrder_getObj.orderLogsVOList && consumerReservationOrder_getObj.orderLogsVOList.length > 0\">\r\n          <el-timeline>\r\n            <el-timeline-item\r\n            :hide-timestamp=\"true\"\r\n            v-for=\"(activity, index) in consumerReservationOrder_getObj.orderLogsVOList\"\r\n            :key=\"index\"\r\n            :icon=\"activity.icon\"\r\n            :type=\"activity.type\"\r\n            :color=\"activity.color\"\r\n            :size=\"activity.size\"\r\n            :timestamp=\"activity.updateTime\"\r\n            >{{ activity.createTime | timestampToTime }}&nbsp;&nbsp;{{activity.logContent}}</el-timeline-item>\r\n          </el-timeline>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<!-- 工单池 -->\r\n<script>\r\n  import axios from \"axios\";\r\n  import { getToken } from \"@/utils/auth\";\r\n  import codeSet from \"@/components/codeSet\";\r\n  import treeDept from \"@/components/treeDept\";\r\n  import { filter } from \"minimatch\";\r\n  import { get } from \"http\";\r\n  import { mapGetters } from 'vuex';\r\n  import * as userTypes from \"@/types/userConfig\";\r\n  let token = getToken();\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        orderStatus:{\r\n            100:'量体待确认',\r\n            101:'量体安排中',\r\n            102:'等待量体中',\r\n            103:'量体中',\r\n            104:'已量体',\r\n            105:'量体订单待回访'\r\n         },\r\n         orderType:{\r\n            20001:'量体预约单',\r\n            20002:'定制订单',\r\n         },\r\n        consumerReservationOrder_getObj:{},\r\n        workOrderLog_list:{},\r\n        tableItemGetListMapObj:{},\r\n        active: 3\r\n      };\r\n    },\r\n    created() {\r\n      this.consumerReservationOrder_get(this.$route.query.orderId);\r\n      this.getWorkOrderLog_list(this.$route.query.number);\r\n    },\r\n    methods: {\r\n      /**\r\n       * 获取量体订单详情基本信息\r\n       */\r\n      consumerReservationOrder_get(orderId) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.order.consumerReservationOrder_get,\r\n          {\r\n            orderId\r\n          }\r\n        ).then(res => {\r\n          that.consumerReservationOrder_getObj = res;\r\n        });\r\n      },\r\n      /**\r\n      * 提示\r\n      */\r\n      warn(message, type) {\r\n        this.$message({\r\n          message: message,\r\n          type: type || 'warning'\r\n        });\r\n      },\r\n      /**\r\n       * 获取工单跟进记录列表\r\n       */\r\n      getWorkOrderLog_list(number) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.getWorkOrderLog_list,\r\n          {\r\n            number\r\n          }\r\n        ).then(res => {\r\n          that.workOrderLog_list = res.data.reverse();\r\n        });\r\n      },\r\n      /**\r\n       * 添加一条跟进记录\r\n       */\r\n      addHistoryWorkOrderFollowUp() {\r\n        const that = this;\r\n        console.log(this.consumerReservationOrder_getObj)\r\n        this.request(\r\n          that.api.job_order.addHistoryWorkOrderFollowUp,\r\n          Object.assign(this.consumerReservationOrder_getObj, {\r\n            updateName: this.userInfo.loginName\r\n          })\r\n        ).then(res => {\r\n          this.warn('添加成功！','success');\r\n          this.getWorkOrderLog_list();\r\n        });\r\n      },\r\n      open() {\r\n        this.$prompt(\"添加一条跟进记录\", \"提示\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\"\r\n        }).then(({ value }) => {\r\n          if(!value) return;\r\n          this.consumerReservationOrder_getObj.remarks = value;\r\n          this.addHistoryWorkOrderFollowUp();\r\n        })\r\n      }\r\n\r\n    },\r\n    computed: {\r\n      ...mapGetters({\r\n        userInfo: userTypes.GETTER_USERINFO\r\n      })\r\n    },\r\n    components: {\r\n      codeSet,\r\n      treeDept\r\n    }\r\n  }\r\n</script>\r\n<style  lang=\"less\" scoped>\r\n  .order-record{\r\n    height: 700px;\r\n    overflow-y: scroll;\r\n  }\r\n  h5 {\r\n    color: #222;\r\n    margin-left: -15px;\r\n  }\r\n  .order-course{\r\n    font-size: 16px;\r\n  }\r\n  .test {\r\n    color: #9d9d9d;\r\n  }\r\n  .work-order-info {\r\n    display: flex;\r\n    justify-content: space-between;\r\n  }\r\n  .booking_top{\r\n    background: #fff;\r\n  }\r\n  .booking_info{\r\n    h4{\r\n      padding: 10px 0 10px 30px;\r\n    }\r\n    border-bottom: 1px solid #f5f5f5;\r\n    .booking_info_r{\r\n      width: 0px;\r\n      height: 0px;\r\n      border-color: transparent #a0cfff;\r\n      border-width: 0px 100px 50px 0px;\r\n      border-style: solid;\r\n      position: relative;\r\n      span{\r\n        width: 50px;\r\n        position: absolute;\r\n        top: 5px;\r\n        left: 60px;\r\n        color: #fff;\r\n      }\r\n    }\r\n  }\r\n  .user{\r\n    display: flex;\r\n    // align-items:center;\r\n  }\r\n  .userInfo{\r\n    padding: 20px 30px 30px 30px;\r\n    .userInfo-img{\r\n      display: block;\r\n      width: 50px;\r\n      height: 50px;\r\n      img{\r\n        width: 100%;\r\n        height: 100%;\r\n        border-radius: 50px;\r\n      }\r\n    }\r\n  }\r\n  .examine{\r\n    align-self:flex-end;\r\n    margin: 0 30px 20px 0;\r\n  }\r\n  .info-list {\r\n    flex-grow: 1;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    padding-top: 20px;\r\n    li {\r\n      width: 25%;\r\n      padding-bottom: 15px;\r\n    }\r\n  }\r\n</style>\r\n"]}]}