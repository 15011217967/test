{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\components\\division.vue?vue&type=style&index=0&id=89504386&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\components\\division.vue","mtime":1576427226859},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\css-loader\\index.js","mtime":1558492728478},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1558492728890},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\postcss-loader\\src\\index.js","mtime":1558492728823},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.el-form-item__content{\r\n    width: 80%;\r\n}\r\n.el-select{\r\n    width: 25%;\r\n}\r\n.cont-inline{\r\n    display: inline;\r\n}\r\n",{"version":3,"sources":["division.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"division.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"cont-inline\">\r\n        <el-select :class=\"[widthClass]\" v-model=\"viewModel.provinceCode\" :disabled=\"isDisabled\" @change='provinceChangeEvent' clearable placeholder=\"省/直辖市\" v-if=\"level >= 1\">\r\n            <el-option v-for=\"(item,index) in proList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n        <el-select :class=\"[widthClass]\" v-model=\"viewModel.municipalityCode\" :disabled=\"isDisabled\" @change=\"cityChangeEvent\" clearable placeholder=\"市\" v-if=\"level >= 2\" style=\"margin:0 5px;\">\r\n            <el-option v-for=\"(item,index) in muniList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n        <el-select :class=\"[widthClass]\" v-model=\"viewModel.areaCode\" :disabled=\"isDisabled\" @change=\"areaChangeEvent\" clearable placeholder=\"区/县\" v-if=\"level >= 3\">\r\n            <el-option v-for=\"(item,index) in areaList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        name: \"division\",\r\n        props: {\r\n            // 接收绑定参数\r\n            value: String,\r\n            label:'地址',\r\n            // 输入框宽度\r\n            widthClass: {\r\n                default: ''\r\n            },\r\n            // 输入框占位符\r\n            placeholder: {\r\n                type: String,\r\n                default: \"请选择\"\r\n            },\r\n            // 显示几级\r\n            level: {\r\n                type: Number,\r\n                default: 3\r\n            },\r\n            // 是否查询使用  如果查询使用  组件绑定的v-model值返回为code\r\n            isSearch: {\r\n                type: Boolean,\r\n                default: false\r\n            },\r\n            // 是否禁止修改\r\n            isDisabled: {\r\n                type: Boolean,\r\n                default: false\r\n            }\r\n        },\r\n        watch: {\r\n            value(val) {\r\n                if(!val){\r\n                    // 如果是查询使用的话  会有重置\r\n                    if(this.isSearch){\r\n                        this.init();\r\n                    }\r\n                    return;\r\n                }\r\n                // 编辑\r\n                if(!this.isSearch){\r\n                    // 保存回显id\r\n                    this.divisionId = val;\r\n                    // 获取数据\r\n                    this.getAllDivision();\r\n                }\r\n            },\r\n        },\r\n        data() {\r\n            return {\r\n                viewModel: {\r\n                    province: '',\r\n                    provinceCode: '',\r\n                    provinceId: '',\r\n                    municipality: '',\r\n                    municipalityCode: '',\r\n                    municipalityId: '',\r\n                    area: '',\r\n                    areaCode: '',\r\n                    areaId: '',\r\n                    divisionId: '',\r\n                },\r\n                proList: [],\r\n                muniList: [],\r\n                areaList: [],\r\n                // 通过divisionId回显的数据\r\n                divisionList: [],\r\n                // 所有的省市区下拉数据\r\n                divisionInfo: {},\r\n                // 选中的id\r\n                divisionId: ''\r\n            };\r\n        },\r\n        created() {\r\n            this.divisionId = this.value;\r\n            this.getAllDivision();\r\n        },\r\n        methods: {\r\n            // 初始化选择\r\n            init(){\r\n                this.viewModel = {\r\n                    province: '',\r\n                    provinceCode: '',\r\n                    provinceId: '',\r\n                    municipality: '',\r\n                    municipalityCode: '',\r\n                    municipalityId: '',\r\n                    area: '',\r\n                    areaCode: '',\r\n                    areaId: '',\r\n                    divisionId: '',\r\n                };\r\n                this.muniList = [];\r\n                this.areaList = [];\r\n            },\r\n            // 省的选择事件\r\n            provinceChangeEvent(code) {\r\n                let pro = this.proList.find(t => t.code == code);\r\n                if(pro){\r\n                    this.viewModel.province = pro.name;\r\n                    this.viewModel.provinceCode = pro.code;\r\n                    this.viewModel.provinceId = pro.id;\r\n                    this.muniList = this.divisionInfo.municipalitys[code];\r\n                    this.$emit('input', pro.code);\r\n                }else {\r\n                    this.viewModel.province = '';\r\n                    this.viewModel.provinceCode = '';\r\n                    this.viewModel.provinceId = '';\r\n                    this.muniList = [];\r\n                    this.$emit('input', '');\r\n                }\r\n                this.viewModel.municipality = '';\r\n                this.viewModel.municipalityCode = '';\r\n                this.viewModel.municipalityId = '';\r\n                this.viewModel.area = '';\r\n                this.viewModel.areaCode = '';\r\n                this.viewModel.areaId = '';\r\n                this.areaList = [];\r\n                this.viewModel.divisionId = '';\r\n                this.$emit(\"set-division\", this.viewModel);\r\n            },\r\n            // 城市的选择事件\r\n            cityChangeEvent(code) {\r\n                let muti = this.muniList.find(t => t.code == code);\r\n                if(muti){\r\n                    this.viewModel.municipality = muti.name;\r\n                    this.viewModel.municipalityCode = muti.code;\r\n                    this.viewModel.municipalityId = muti.id;\r\n                    this.areaList = this.divisionInfo.areas[code];\r\n                    this.$emit('input', muti.code);\r\n                }else {\r\n                    if(this.viewModel.provinceId){\r\n                        this.$emit('input', this.viewModel.provinceCode);\r\n                    }\r\n                    this.viewModel.municipality = '';\r\n                    this.viewModel.municipalityCode = '';\r\n                    this.viewModel.municipalityId = '';\r\n                    this.areaList = [];\r\n                }\r\n                this.viewModel.area = '';\r\n                this.viewModel.areaCode = '';\r\n                this.viewModel.areaId = '';\r\n                this.viewModel.divisionId = '';\r\n                this.$emit(\"set-division\", this.viewModel);\r\n            },\r\n            // 区的选择事件\r\n            areaChangeEvent(code) {\r\n                let area = this.areaList.find(t => t.code == code);\r\n                if(area){\r\n                    this.viewModel.area = area.name;\r\n                    this.viewModel.areaCode = area.code;\r\n                    this.viewModel.areaId = area.id;\r\n                    this.viewModel.divisionId = area.id;\r\n                    this.$emit('input', area.code);\r\n                }else {\r\n                    if(this.viewModel.municipalityId){\r\n                        this.$emit('input', this.viewModel.municipalityCode);\r\n                    }\r\n                    this.viewModel.area = '';\r\n                    this.viewModel.areaCode = '';\r\n                    this.viewModel.areaId = '';\r\n                    this.viewModel.divisionId = '';\r\n                }\r\n                this.$emit(\"set-division\", this.viewModel);\r\n            },\r\n            // 获取所有的省市区回显组合及下拉数据\r\n            async getAllDivision() {\r\n                if(localStorage.getItem(\"division\") != null && localStorage.getItem(\"divisionInfo\") != null) {\r\n                    this.divisionList = JSON.parse(localStorage.getItem(\"division\"));\r\n                    // 有id 视为编辑  获取回显数据\r\n                    if(this.divisionId){\r\n                        this.viewModel = this.divisionList.find(t => t.id == this.divisionId);\r\n                    }\r\n                    this.divisionInfo = JSON.parse(localStorage.getItem(\"divisionInfo\"));\r\n                    this.proList = this.divisionInfo.provinces;\r\n                    this.getEditList();\r\n                    return;\r\n                }\r\n                // 获取省市区回显组合\r\n                this.divisionList = await this.request(this.api.system.division_all, {}, true);\r\n                // 有id 视为编辑  获取回显数据\r\n                if(this.divisionId){\r\n                    this.viewModel = this.divisionList.find(t => t.id == this.divisionId);\r\n                }\r\n                // 存储回显组合数据\r\n                localStorage.setItem(\"division\", JSON.stringify(this.divisionList));\r\n                // 获取省市区下拉数据\r\n                let divisionInfo = await this.request(this.api.system.division_get_info, {}, true);\r\n                // 初始化数据 转对象\r\n                // 市\r\n                if(divisionInfo && divisionInfo.municipalitys.length){\r\n                    let municipalitys = {};\r\n                    divisionInfo.municipalitys.forEach(item => {\r\n                        let key = Object.keys(item)[0];\r\n                        municipalitys[key] = item[key];\r\n                    });\r\n                    divisionInfo.municipalitys = municipalitys;\r\n                }else{\r\n                    divisionInfo.municipalitys = {};\r\n                }\r\n                // 区\r\n                if(divisionInfo && divisionInfo.areas.length){\r\n                    let areas = {};\r\n                    divisionInfo.areas.forEach(item => {\r\n                        let key = Object.keys(item)[0];\r\n                        areas[key] = item[key];\r\n                    })\r\n                    divisionInfo.areas = areas;\r\n                }else {\r\n                    divisionInfo.areas = {};\r\n                }\r\n                this.divisionInfo = divisionInfo;\r\n                // 获取省份数据\r\n                this.proList = this.divisionInfo.provinces;\r\n                // 获取市  区数据\r\n                this.getEditList();\r\n                // 存储下拉数据\r\n                localStorage.setItem(\"divisionInfo\", JSON.stringify(this.divisionInfo));\r\n            },\r\n            // 获取市  区列表\r\n            getEditList(){\r\n                if(this.viewModel.provinceCode){\r\n                    this.muniList = this.divisionInfo.municipalitys[this.viewModel.provinceCode];\r\n                }\r\n                if(this.viewModel.municipalityCode){\r\n                    this.areaList = this.divisionInfo.areas[this.viewModel.municipalityCode];\r\n                }\r\n            }\r\n\r\n        }\r\n    };\r\n</script>\r\n<style scoped>\r\n.el-form-item__content{\r\n    width: 80%;\r\n}\r\n.el-select{\r\n    width: 25%;\r\n}\r\n.cont-inline{\r\n    display: inline;\r\n}\r\n</style>\r\n"]}]}