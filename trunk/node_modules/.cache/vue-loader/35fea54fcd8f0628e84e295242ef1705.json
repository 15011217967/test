{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\product\\version\\upgrade_details.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\product\\version\\upgrade_details.vue","mtime":1572415123975},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { validatDwnloadUrl } from \"@/utils/validate\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      filtersData: {\r\n        description: \"\",\r\n        version: \"\",\r\n        versionId:\"\",\r\n        type:\"\",\r\n        forcedUpgrade:null,\r\n        downloadUrl:'',\r\n        upgradeScope:'',\r\n      },\r\n      typeListData:[{name:'Android'},{name:'iOS'}],\r\n      forcedUpgradeOpts:[{name:'强制',type:true},{name:'可选',type:false}],\r\n      upgradeScopeOpts:[{name:'全部',type:'all'}],\r\n      versionListData:[],\r\n      showDisabled: false,\r\n      editDisabled: false,\r\n      _type: \"\",\r\n      _id: \"\",\r\n      rules: {\r\n        //规则验证\r\n        type: [\r\n          { required: true, message: \"请选择操作系统\", trigger: \"change\" }\r\n        ],\r\n        version: [{ required: true, message: \"请选择版本号\", trigger: \"change\" }],\r\n        forcedUpgrade: [\r\n          { required: true, message: \"请选择升级形式\", trigger: \"change\" }\r\n        ],\r\n         upgradeScope: [\r\n          { required: true, message: \"请选择升级范围\", trigger: \"change\" }\r\n        ],\r\n        downloadUrl: [\r\n          { required: true, message: \"请输入升级地址\", trigger: \"blur\" },\r\n           { validator: validatDwnloadUrl, trigger: \"blur\" }\r\n        ],\r\n      },\r\n      //分类使用\r\n    };\r\n  },\r\n  created() {\r\n    this.init();\r\n    this.getQueryparams();\r\n  },\r\n  methods: {\r\n    init(){\r\n      this.filtersData= {\r\n        description: \"\",\r\n        version: \"\",\r\n        versionId:\"\",\r\n        type:\"\",\r\n        forcedUpgrade:null,\r\n        downloadUrl:'',\r\n        upgradeScope:'',\r\n      };\r\n    },\r\n    //获取上页面参数\r\n    getQueryparams() {\r\n      this._type = this.$route.query.type;\r\n      this._id = this.$route.query.id;\r\n      let itemStatus = this._type;\r\n      switch (itemStatus.toString()) {\r\n        case \"add\": //新增\r\n          this.editDisabled = false;\r\n          this.showDisabled = false;\r\n          break;\r\n        case \"edit\": //修改\r\n          this.editDisabled = true;\r\n          this.showDisabled = false;\r\n          this.getEchoDisplayData();\r\n          break;\r\n        case \"show\": //查看\r\n          this.editDisabled = true;\r\n          this.showDisabled = true;\r\n          this.getEchoDisplayData();\r\n          break;\r\n      }\r\n    },\r\n    //切换处理\r\n    handleTypeChange(item){\r\n      this.filtersData.version='';\r\n      this.filtersData.versionId='';\r\n      this.getVersionList(item);\r\n    },\r\n    getVersionList(item){\r\n      this.request(this.api.version.applicationVersion_list, {type:item}).then(data => {\r\n        let _data = data.data;\r\n        console.log(_data);\r\n        this.versionListData= _data;\r\n      });\r\n    },\r\n    //版本号发生改变时 获取版本号ID 并赋值\r\n    handleVersionGet(e){\r\n      let obj =this.versionListData.find(item => item.version == e );\r\n      this.filtersData.versionId=obj.id;\r\n    },\r\n    //提交\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          this.request(\r\n            this.api.version.applicationVersionControl_save,\r\n            this.filtersData\r\n          ).then(res => {\r\n            this.$message.success(\"保存成功\");\r\n            setTimeout(() => {\r\n              this.routerback();\r\n            }, 500);\r\n          });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n\r\n    //回显\r\n    getEchoDisplayData() {\r\n      this.request(this.api.version.applicationVersionControl_get, {\r\n        id: this._id\r\n      }).then(res => {\r\n          this.filtersData=res;\r\n          this.getVersionList(res.type)\r\n      });\r\n    },\r\n    //后退\r\n    routerback() {\r\n      this.$router.go(-1);\r\n    }\r\n  }\r\n\r\n};\r\n",{"version":3,"sources":["upgrade_details.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"upgrade_details.vue","sourceRoot":"src/views/product/version","sourcesContent":["<template>\r\n  <div>\r\n    <el-form :rules=\"rules\" label-width=\"110px\" :model=\"filtersData\" size=\"small\" ref=\"filtersForm\">\r\n      <div class=\"tlogy-item\">\r\n        <el-form-item prop=\"type\" label=\"操作系统：\">\r\n          <el-select\r\n            placeholder=\"请选择\"\r\n            class=\"input-w-2\"\r\n            :disabled=\"showDisabled\"\r\n            :value=\"filtersData.type\"\r\n            v-model=\"filtersData.type\"\r\n            @change=\"handleTypeChange\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in typeListData\"\r\n              :key=\"item.name\"\r\n              :label=\"item.name\"\r\n              :value=\"item.name\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n         <el-form-item prop=\"version\" label=\"升级版本：\">\r\n          <el-select\r\n            @change=\"handleVersionGet\"\r\n            :placeholder=\"!!filtersData.type ? '请选择':'请先选择操作系统'\"\r\n            class=\"input-w-2\"\r\n            :disabled=\"showDisabled || !filtersData.type\"\r\n            :value=\"filtersData.version\"\r\n            v-model=\"filtersData.version\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in versionListData\"\r\n              :key=\"item.version\"\r\n              :label=\"item.version\"\r\n              :value=\"item.version\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n         <el-form-item prop=\"forcedUpgrade\" label=\"升级形式：\">\r\n          <el-select\r\n            placeholder=\"请选择\"\r\n            class=\"input-w-2\"\r\n            :disabled=\"showDisabled\"\r\n            :value=\"filtersData.forcedUpgrade\"\r\n            v-model=\"filtersData.forcedUpgrade\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in forcedUpgradeOpts\"\r\n              :key=\"item.type\"\r\n              :label=\"item.name\"\r\n              :value=\"item.type\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n         <el-form-item prop=\"upgradeScope\" label=\"升级范围：\">\r\n          <el-select\r\n            placeholder=\"请选择\"\r\n            class=\"input-w-2\"\r\n            :disabled=\"showDisabled\"\r\n            :value=\"filtersData.upgradeScope\"\r\n            v-model=\"filtersData.upgradeScope\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in upgradeScopeOpts\"\r\n              :key=\"item.type\"\r\n              :label=\"item.name\"\r\n              :value=\"item.type\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item prop=\"downloadUrl\" label=\"升级URL：\">\r\n          <el-input\r\n            :disabled=\"showDisabled\"\r\n            v-model=\"filtersData.downloadUrl\"\r\n            class=\"input-w-2\"\r\n            placeholder=\"http://或https://\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"description\" label=\"升级提示：\">\r\n          <el-input\r\n            type=\"textarea\"\r\n            class=\"input-w-2\"\r\n            autosize\r\n            :disabled=\"showDisabled\"\r\n            placeholder=\"请输入内容\"\r\n            v-model=\"filtersData.description\"\r\n          ></el-input>\r\n        </el-form-item>\r\n         <div class=\"item-footer\">\r\n          <el-button\r\n            v-if=\"_type == 'add'\"\r\n            size=\"small\"\r\n            @click=\"submitForm('filtersForm')\"\r\n            type=\"primary\"\r\n          >确定</el-button>\r\n          <el-button\r\n            v-else-if=\"_type == 'edit'\"\r\n            size=\"small\"\r\n            @click=\"submitForm('filtersForm')\"\r\n            type=\"primary\"\r\n          >修改</el-button>\r\n          <el-button size=\"small\" @click=\"routerback('filtersForm')\">取消</el-button>\r\n        </div>\r\n      </div>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { validatDwnloadUrl } from \"@/utils/validate\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      filtersData: {\r\n        description: \"\",\r\n        version: \"\",\r\n        versionId:\"\",\r\n        type:\"\",\r\n        forcedUpgrade:null,\r\n        downloadUrl:'',\r\n        upgradeScope:'',\r\n      },\r\n      typeListData:[{name:'Android'},{name:'iOS'}],\r\n      forcedUpgradeOpts:[{name:'强制',type:true},{name:'可选',type:false}],\r\n      upgradeScopeOpts:[{name:'全部',type:'all'}],\r\n      versionListData:[],\r\n      showDisabled: false,\r\n      editDisabled: false,\r\n      _type: \"\",\r\n      _id: \"\",\r\n      rules: {\r\n        //规则验证\r\n        type: [\r\n          { required: true, message: \"请选择操作系统\", trigger: \"change\" }\r\n        ],\r\n        version: [{ required: true, message: \"请选择版本号\", trigger: \"change\" }],\r\n        forcedUpgrade: [\r\n          { required: true, message: \"请选择升级形式\", trigger: \"change\" }\r\n        ],\r\n         upgradeScope: [\r\n          { required: true, message: \"请选择升级范围\", trigger: \"change\" }\r\n        ],\r\n        downloadUrl: [\r\n          { required: true, message: \"请输入升级地址\", trigger: \"blur\" },\r\n           { validator: validatDwnloadUrl, trigger: \"blur\" }\r\n        ],\r\n      },\r\n      //分类使用\r\n    };\r\n  },\r\n  created() {\r\n    this.init();\r\n    this.getQueryparams();\r\n  },\r\n  methods: {\r\n    init(){\r\n      this.filtersData= {\r\n        description: \"\",\r\n        version: \"\",\r\n        versionId:\"\",\r\n        type:\"\",\r\n        forcedUpgrade:null,\r\n        downloadUrl:'',\r\n        upgradeScope:'',\r\n      };\r\n    },\r\n    //获取上页面参数\r\n    getQueryparams() {\r\n      this._type = this.$route.query.type;\r\n      this._id = this.$route.query.id;\r\n      let itemStatus = this._type;\r\n      switch (itemStatus.toString()) {\r\n        case \"add\": //新增\r\n          this.editDisabled = false;\r\n          this.showDisabled = false;\r\n          break;\r\n        case \"edit\": //修改\r\n          this.editDisabled = true;\r\n          this.showDisabled = false;\r\n          this.getEchoDisplayData();\r\n          break;\r\n        case \"show\": //查看\r\n          this.editDisabled = true;\r\n          this.showDisabled = true;\r\n          this.getEchoDisplayData();\r\n          break;\r\n      }\r\n    },\r\n    //切换处理\r\n    handleTypeChange(item){\r\n      this.filtersData.version='';\r\n      this.filtersData.versionId='';\r\n      this.getVersionList(item);\r\n    },\r\n    getVersionList(item){\r\n      this.request(this.api.version.applicationVersion_list, {type:item}).then(data => {\r\n        let _data = data.data;\r\n        console.log(_data);\r\n        this.versionListData= _data;\r\n      });\r\n    },\r\n    //版本号发生改变时 获取版本号ID 并赋值\r\n    handleVersionGet(e){\r\n      let obj =this.versionListData.find(item => item.version == e );\r\n      this.filtersData.versionId=obj.id;\r\n    },\r\n    //提交\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          this.request(\r\n            this.api.version.applicationVersionControl_save,\r\n            this.filtersData\r\n          ).then(res => {\r\n            this.$message.success(\"保存成功\");\r\n            setTimeout(() => {\r\n              this.routerback();\r\n            }, 500);\r\n          });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n\r\n    //回显\r\n    getEchoDisplayData() {\r\n      this.request(this.api.version.applicationVersionControl_get, {\r\n        id: this._id\r\n      }).then(res => {\r\n          this.filtersData=res;\r\n          this.getVersionList(res.type)\r\n      });\r\n    },\r\n    //后退\r\n    routerback() {\r\n      this.$router.go(-1);\r\n    }\r\n  }\r\n\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.tlogy-item {\r\n  background-color: #ffffff;\r\n  margin: 10px;\r\n  padding: 10px;\r\n}\r\n\r\n</style>\r\n"]}]}