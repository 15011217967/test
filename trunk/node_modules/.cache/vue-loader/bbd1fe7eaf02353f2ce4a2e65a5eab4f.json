{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\content\\risk\\examine.vue?vue&type=style&index=0&id=c88d3cde&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\content\\risk\\examine.vue","mtime":1574160264894},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\css-loader\\index.js","mtime":1558492728478},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1558492728890},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\postcss-loader\\src\\index.js","mtime":1558492728823},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\less-loader\\dist\\cjs.js","mtime":1566193719488},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["\n@import \"../style/contentPublic.less\";\n.examine{\n  .page-main-inner{\n    .table-img{width: 60px;height: 60px;}\n    .create-time{\n      .table-tab{margin-left: 10px;}\n    }\n    .table-tab{margin-right: 10px;}\n    .table-reason{color: #e6a23c;}\n  }\n}\n",{"version":3,"sources":["examine.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"examine.vue","sourceRoot":"src/views/content/risk","sourcesContent":["<style lang=\"less\" scoped>\r\n  @import \"../style/contentPublic.less\";\r\n  .examine{\r\n    .page-main-inner{\r\n      .table-img{width: 60px;height: 60px;}\r\n      .create-time{\r\n        .table-tab{margin-left: 10px;}\r\n      }\r\n      .table-tab{margin-right: 10px;}\r\n      .table-reason{color: #e6a23c;}\r\n    }\r\n  }\r\n</style>\r\n<template>\r\n  <div class=\"examine page-public\">\r\n    <div class=\"page-main\">\r\n      <div class=\"page-main-inner item-margin\">\r\n        <el-menu :default-active=\"typeActiveIndex\" class=\"el-menu-demo page-menu-border\" mode=\"horizontal\" @select=\"typeActiveSelect\">\r\n          <el-menu-item index=\"4\">文章</el-menu-item>\r\n          <el-menu-item index=\"3\">图集</el-menu-item>\r\n          <el-menu-item index=\"2\">小视频</el-menu-item>\r\n          <el-menu-item index=\"1\">视频</el-menu-item>\r\n        </el-menu>\r\n        <div class=\"menu-small\">\r\n          <el-menu :default-active=\"stateActiveIndex\" class=\"el-menu-demo\" mode=\"horizontal\" @select=\"stateActiveSelect\">\r\n            <el-menu-item index=\"1\">待审核</el-menu-item>\r\n            <el-menu-item index=\"5\">审核中</el-menu-item>\r\n            <el-menu-item index=\"2\">已通过</el-menu-item>\r\n            <el-menu-item index=\"3\">已驳回</el-menu-item>\r\n            <el-menu-item index=\"4\">全部</el-menu-item>\r\n          </el-menu>\r\n        </div>\r\n        <page-table :form-data=\"formData\" :get-data=\"getData\" :table-data=\"tableData\">\r\n          <el-table :data=\"tableData.data\" style=\"width: 100%\" :show-header=\"false\">\r\n            <el-table-column label=\"\"  width=\"90\">\r\n              <template slot-scope=\"scope\">\r\n                <img :src=\"scope.row.baseContent.coverList[0].url\" alt=\"\" class=\"table-img\" v-if=\"scope.row.baseContent && scope.row.baseContent.coverList.length\">\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"\">\r\n              <template slot-scope=\"scope\">\r\n                <h6>{{scope.row.baseContent.title}}</h6>\r\n                <p class=\"create-time\">{{ scope.row.baseContent.createTime | timestampToTime}}\r\n                  <el-tag size=\"mini\" type=\"info\" class=\"table-tab\" v-if=\"scope.row.baseContent._categoryName\">\r\n                    {{ scope.row.baseContent._categoryName  }}\r\n                  </el-tag>\r\n                </p>\r\n                <el-tag size=\"mini\" type=\"info\" v-for=\"item in scope.row.baseContent.tagList\" :key=\"item\" class=\"table-tab\">{{ item.name }}</el-tag>\r\n                <p v-if=\"scope.row.timingStatus === 3 && scope.row.baseContent.reason\" class=\"table-reason\">驳回理由：<span>{{ scope.row.baseContent.reason }}</span></p>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" width=\"300\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button type=\"text\" size=\"small\" @click=\"auditPass(scope.row)\" v-show=\"scope.row.timingStatus === 1\">审核通过</el-button>\r\n                <el-button type=\"text\" size=\"small\" @click=\"auditReject(scope.row)\" v-show=\"scope.row.timingStatus === 1\">驳回</el-button>\r\n                <el-button type=\"text\" size=\"small\" @click=\"auditOffline(scope.row)\" v-show=\"scope.row.timingStatus === 2\">强制下线</el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </page-table>\r\n      </div>\r\n    </div>\r\n    <!--驳回信息-->\r\n    <el-dialog title=\"驳回\" :visible.sync=\"auditRejectDialog\" width=\"40%\" :close-on-click-modal=\"false\">\r\n      <el-form :model=\"auditRejectFormData\" :rules=\"rules\" ref=\"auditRejectForm\" label-width=\"130px\" class=\"demo-ruleForm\">\r\n        <el-form-item label=\"请确认驳回原因\" prop=\"reason\">\r\n          <el-input type=\"textarea\" :rows=\"3\" placeholder=\"请输入内容\" v-model=\"auditRejectFormData.reason\">\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"auditRejectDialog = false\" size=\"small\">取 消</el-button>\r\n        <el-button @click=\"auditRejectSub\" type=\"primary\" size=\"small\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\n  import PageTable from '@/views/content/components/PageTable.vue'\r\n  import { timestampToTime } from '@/utils/util'\r\n  export default {\r\n    name: 'examine',\r\n    // 数据\r\n    data() {\r\n      return {\r\n        // 类型默认选中\r\n        typeActiveIndex:'4',\r\n        // 状态默认选中\r\n        stateActiveIndex: '1',\r\n        // 表格数据\r\n        tableData: {},\r\n        formData: {\r\n          pageIndex: 1,\r\n          pageSize: 10,\r\n          type: 4,\r\n          timingStatus: 1\r\n        },\r\n        // 驳回\r\n        auditRejectDialog: false,\r\n        auditRejectRow: null,\r\n        rules: {\r\n          reason: [\r\n            {type: 'string',required: true, message: '请输入内容', trigger: 'blur'}\r\n          ]\r\n        },\r\n        auditRejectFormData: {\r\n          reason: '',\r\n          id: null\r\n        }\r\n      }\r\n    },\r\n    // 组件\r\n    components: {\r\n      PageTable\r\n    },\r\n    // 初始化数据\r\n    mounted() {\r\n      this.$nextTick(() => {\r\n        this.getData()\r\n      })\r\n    },\r\n    // keepAlive 页面显示时\r\n    activated() {\r\n      this.getData();\r\n    },\r\n    // 方法\r\n    methods: {\r\n      init(){\r\n\r\n      },\r\n      // 获取数据\r\n      getData(){\r\n        this.request(this.api.contentCore.audit_list, this.formData).then(data => {\r\n          if(data.data && data.data.length){\r\n            data.data.forEach(item => {\r\n              // 初始显示分类\r\n              if(item.baseContent && item.baseContent.showIdentifier){\r\n                let showIdentifier = item.baseContent.showIdentifier\r\n                if(showIdentifier.indexOf('$') > -1){\r\n                  // 获取最后一个分类\r\n                  let items = showIdentifier.split('$')[showIdentifier.split('$').length - 1]\r\n                  if(items.split('&').length > 2){\r\n                    item.baseContent._categoryName = items.split('&')[items.split('&').length - 1]\r\n                  }else{\r\n                    item.baseContent._categoryName = null\r\n                  }\r\n\r\n                }else {\r\n                  if(showIdentifier.split('&').length > 2){\r\n                    item.baseContent._categoryName = showIdentifier.split('&')[showIdentifier.split('&').length - 1]\r\n                  }else{\r\n                    item.baseContent._categoryName = null\r\n                  }\r\n                }\r\n              }\r\n              // 初始显示标签\r\n              /*if(item.baseContent && item.baseContent.tagList && item.baseContent.tagList.length){\r\n                item.baseContent.tags = item.baseContent.tagList\r\n              }else if(item.baseContent && item.baseContent.tags && item.baseContent.tags.length){\r\n                let tags = item.baseContent.tags\r\n                if(tags.indexOf('$') > -1){\r\n                  item.baseContent.tags = tags.split('$').map(item => {\r\n                    return {\r\n                      name: item\r\n                    }\r\n                  })\r\n                }else {\r\n                  item.baseContent.tags = [{\r\n                    name: tags\r\n                  }]\r\n                }\r\n              }else {\r\n                item.baseContent.tags = []\r\n              }*/\r\n            })\r\n          }\r\n          this.tableData = data\r\n        });\r\n      },\r\n      // 审核通过\r\n      auditPass(row){\r\n        this.$confirm('确认审核通过吗？', '审核', {\r\n          confirmButtonText: '确认',\r\n          cancelButtonText: '取消',\r\n          showClose:false\r\n        }).then(() => {\r\n          this.request(this.api.contentCore.audit_pass, {id: row.id}).then(data => {\r\n            this.$notify.success({ title: '成功',message: '审核成功'})\r\n            this.getData()\r\n          });\r\n        }).catch(() => {\r\n        });\r\n\r\n      },\r\n      // 驳回\r\n      auditReject(row){\r\n        this.auditRejectFormData.reason = ''\r\n        this.auditRejectDialog = true\r\n        this.auditRejectRow = row\r\n      },\r\n      // 驳回确认\r\n      auditRejectSub(){\r\n        this.$refs.auditRejectForm.validate((valid) => {\r\n          if (valid) {\r\n            this.auditRejectFormData.id = this.auditRejectRow.id\r\n            this.request(this.api.contentCore.audit_reject, this.auditRejectFormData).then(data => {\r\n              this.$notify.success({ title: '成功',message: '驳回成功'})\r\n              this.auditRejectDialog = false\r\n              this.auditRejectRow = null\r\n              this.getData()\r\n            });\r\n          } else {\r\n            return false;\r\n          }\r\n        });\r\n\r\n      },\r\n      // 强制下线\r\n      auditOffline(row){\r\n        this.$confirm('确认强制下线吗？', '强制下线', {\r\n          confirmButtonText: '确认',\r\n          cancelButtonText: '取消',\r\n          showClose:false\r\n        }).then(() => {\r\n          this.request(this.api.contentCore.audit_offline, {id: row.id}).then(data => {\r\n            this.$notify.success({ title: '成功',message: '强制下线成功'})\r\n            this.getData()\r\n          });\r\n        }).catch(() => {\r\n        });\r\n\r\n      },\r\n      // 类型切换\r\n      typeActiveSelect(index,indexPath,event) {\r\n        this.formData.pageIndex = 1\r\n        this.formData.type = index\r\n        this.getData()\r\n      },\r\n      // 状态切换\r\n      stateActiveSelect(index,indexPath,event){\r\n        this.formData.pageIndex = 1\r\n        // 等于4时   为全部\r\n        if(index === '4'){\r\n          this.formData.timingStatus = ''\r\n        }else{\r\n          this.formData.timingStatus = index\r\n        }\r\n        this.getData()\r\n      }\r\n    },\r\n    // 计算属性\r\n    computed: {},\r\n    // 监听数据变化\r\n    watch: {}\r\n  }\r\n</script>\r\n"]}]}