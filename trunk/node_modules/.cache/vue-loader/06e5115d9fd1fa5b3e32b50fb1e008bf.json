{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\OS\\store\\other_bill\\refund_list.vue?vue&type=style&index=0&id=251b984a&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\OS\\store\\other_bill\\refund_list.vue","mtime":1572415124334},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\css-loader\\index.js","mtime":1558492728478},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1558492728890},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\postcss-loader\\src\\index.js","mtime":1558492728823},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\less-loader\\dist\\cjs.js","mtime":1566193719488},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.search_div {\r\n  margin: 0 10px;\r\n  padding-top: 20px;\r\n  background-color: #fff;\r\n  .first-input {\r\n    width: 300px;\r\n  }\r\n}\r\n.remark /deep/ .el-textarea__inner {\r\n  height: 100px;\r\n}\r\n.table_div {\r\n  margin: 10px;\r\n  background-color: #fff;\r\n  padding-top: 20px;\r\n  padding-left: 10px;\r\n}\r\n",{"version":3,"sources":["refund_list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAojBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"refund_list.vue","sourceRoot":"src/views/OS/store/other_bill","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"search_div\">\r\n      <el-form ref=\"formData\" :model=\"signData\" label-width=\"110px\" :inline=\"true\">\r\n        <el-form-item label=\"模糊查询：\" prop=\"fuzzyQuery\">\r\n          <el-input class=\"first-input\" v-model=\"signData.fuzzyQuery\" placeholder=\"退款单号/源订单号\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"单据状态：\" prop=\"refundMoneyOrderStatus\">\r\n          <el-select v-model=\"signData.refundMoneyOrderStatus\" placeholder=\"请选择\">\r\n            <el-option label=\"退款中\" value=\"0\"></el-option>\r\n            <el-option label=\"已退款\" value=\"1\"></el-option>\r\n            <el-option label=\"退款异常\" value=\"2\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"所属门店：\" prop=\"storeId\" label-width=\"140px\">\r\n          <el-select v-model=\"signData.storeId\" placeholder=\"请选择\">\r\n            <el-option\r\n              v-for=\"item in storeListData\"\r\n              :label=\"item.name\"\r\n              :key=\"item.id\"\r\n              :value=\"item.id\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"生成时间：\" prop=\"startTime\">\r\n          <el-date-picker\r\n            v-model=\"startTime\"\r\n            type=\"daterange\"\r\n            range-separator=\"-\"\r\n            start-placeholder=\"开始日期\"\r\n            end-placeholder=\"结束日期\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item label=\"退款时间：\" prop=\"endTime\">\r\n          <el-date-picker\r\n            v-model=\"refundStarTime\"\r\n            type=\"daterange\"\r\n            range-separator=\"-\"\r\n            start-placeholder=\"开始日期\"\r\n            end-placeholder=\"结束日期\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"searchFormData('formData')\" size=\"small\">查询</el-button>\r\n          <el-button @click=\"resetFormData('formData')\" size=\"small\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    <div class=\"table_div\">\r\n      <el-button\r\n        :disabled=\"multipleSelectionData.length==0\"\r\n        plain\r\n        @click=\"exportExcel\"\r\n        size=\"small\"\r\n      >导出</el-button>\r\n      <el-table\r\n        ref=\"multipleTable\"\r\n        :data=\"tableData\"\r\n        tooltip-effect=\"dark\"\r\n        style=\"width: 100%\"\r\n        header-row-class-name=\"item-table-header\"\r\n        @selection-change=\"selectionChange\"\r\n      >\r\n        <el-table-column type=\"selection\" width=\"55\"></el-table-column>\r\n        <el-table-column label=\"退款单号\" width=\"210\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.refundMoneyOrderNum }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"refundMoneyOrderStatus\" label=\"单据状态\" width=\"120\" align=\"center\">\r\n          <template\r\n            slot-scope=\"scope\"\r\n          >{{ scope.row.refundMoneyOrderStatus | filterRefundMoneyOrderStatus }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"refundMoneyWayCode\" label=\"退款方式\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.refundMoneyWayCode | filterRefundMoneyWayCode }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"refundMoney\" label=\"退款金额\" width=\"120\" align=\"center\"></el-table-column>\r\n        <el-table-column prop=\"reason\" label=\"退款原因\" width=\"120\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.reason?scope.row.reason:\"--\" }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"refundMoneyTime\" label=\"退款时间\" width=\"160\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.refundMoneyTime | timestampToTime }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createTime\" label=\"生成时间\" width=\"160\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.createTime | timestampToTime }}</template>\r\n        </el-table-column>\r\n        <el-table-column label=\"源订单号\" width=\"210\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.sourceOrderNum }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"refundMoneySource\" label=\"退款来源\" width=\"100\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.refundMoneySource | filterRefundMoneySource}}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"paymentNum\" label=\"支付订单号\" width=\"180\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.paymentNum?scope.row.paymentNum:'--'}}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"storeName\" label=\"所属门店\" width=\"120\" align=\"center\">\r\n          <template slot-scope=\"scope\">{{ scope.row.storeName }}</template>\r\n        </el-table-column>\r\n        <el-table-column fixed=\"right\" label=\"操作\" width=\"160\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button @click=\"checkBtnClick(scope.row)\" type=\"text\" size=\"small\">查看</el-button>\r\n            <el-button\r\n              v-show=\"(scope.row.refundMoneyOrderStatus==2&&scope.row.refundMoneyWayCode==2)||(scope.row.refundMoneyOrderStatus==0&&scope.row.refundMoneyWayCode==3)\"\r\n              @click=\"refundBtnClick(scope.row)\"\r\n              type=\"text\"\r\n              size=\"small\"\r\n            >退款</el-button>\r\n            <el-button\r\n              v-show=\"scope.row.refundMoneyOrderStatus==0&&scope.row.refundMoneyWayCode==3\"\r\n              @click=\"addRemarkBtnClick(scope.row)\"\r\n              type=\"text\"\r\n              size=\"small\"\r\n            >添加备注</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div style=\"margin-top:20px;padding-bottom:10px;margin-right:20px;\">\r\n        <el-pagination\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page.sync=\"signData.pageIndex\"\r\n          :page-sizes=\"[10, 20, 30, 40]\"\r\n          :page-size=\"signData.pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"totalCount\"\r\n        ></el-pagination>\r\n      </div>\r\n      <el-dialog\r\n        title=\"提示\"\r\n        :visible.sync=\"showRefundDialog\"\r\n        @close=\"hideRefundDialogEvent\"\r\n        width=\"600px\"\r\n        height=\"600px\"\r\n      >\r\n        <el-form :model=\"accountVO\" ref=\"refundForm\" :rules=\"accountVORules\">\r\n          <el-form-item label=\"退款金额：\" label-width=\"100px\">\r\n            <span>￥{{refundMoney}}</span>\r\n          </el-form-item>\r\n          <el-form-item label=\"退款账户：\" label-width=\"100px\" prop=\"refundMoneyAccountNum\">\r\n            <el-input\r\n              v-model=\"accountVO.refundMoneyAccountNum\"\r\n              :maxlength=\"23\"\r\n              style=\"width:260px;\"\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"showRefundDialog=false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"sureRefundDailogBtnClick('refundForm')\">确 定</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <el-dialog\r\n        title=\"添加备注\"\r\n        :visible.sync=\"showRemarkDialog\"\r\n        @close=\"hideRemarksDialogEvent\"\r\n        width=\"600px\"\r\n        height=\"600px\"\r\n      >\r\n        <el-form :model=\"accountVO\" ref=\"remarkForm\" :rules=\"remarkFormRules\">\r\n          <el-form-item label=\"添加备注：\" label-width=\"100px\" prop=\"remark\">\r\n            <el-input\r\n              v-model=\"accountVO.remark\"\r\n              style=\"width:300px;\"\r\n              class=\"remark\"\r\n              type=\"textarea\"\r\n              resize=\"none\"\r\n              placeholder=\"请输入内容\"\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"showRemarkDialog=false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"sureRemarkDailogBtnClick('remarkForm')\">确 定</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {isBankAccount} from '@/utils/validate'\r\nimport { mapGetters } from \"vuex\";\r\nimport * as userTypes from \"@/types/userConfig\";\r\nlet bankaccount=(rule, value,callback)=>{\r\n  if(!value){\r\n    callback(new Error('请输入银行账号'));\r\n  }else if (!isBankAccount(value) && value){\r\n    callback(new Error('请输入正确的银行账号'));\r\n  }else {\r\n    callback();\r\n  }\r\n};\r\nexport default {\r\n  data() {\r\n    return {\r\n      signData: {\r\n        // orderType:'0202',\r\n        fuzzyQuery: \"\",\r\n        //标记单据状态\r\n        refundMoneyOrderStatus: \"\",\r\n        //标记门店状态\r\n        storeId: \"\",\r\n        //标记生成时间\r\n        startDate: \"\",\r\n        endDate: \"\",\r\n        //标记退款时间\r\n        refundStartDate: \"\",\r\n        refundEndDate: \"\",\r\n        //当前页数\r\n        pageIndex: 1,\r\n        //每页要显示的数据条数,默认10条\r\n        pageSize: 10\r\n      },\r\n      //退款金额\r\n      refundMoney: null,\r\n      //退款Dialog的数据源\r\n      accountVO: {\r\n        id: \"\",\r\n        //银行账号\r\n        refundMoneyAccountNum: \"\",\r\n        //备注\r\n        remark: \"\"\r\n      },\r\n      accountVORules: {\r\n        refundMoneyAccountNum: [\r\n          { required: true, trigger: \"blur\", validator: bankaccount}\r\n        ]\r\n      },\r\n      //标识是否显示退款dialog\r\n      showRefundDialog: false,\r\n      //添加备注Dialog的数据源\r\n      remarkFormData: {\r\n        id: \"\"\r\n      },\r\n      //确认收款校验规则\r\n      remarkFormRules: {\r\n        remark: [{ required: true, message: \"备注不能为空\", trigger: \"blur\" }]\r\n      },\r\n      //标识是否显示添加备注的dialog\r\n      showRemarkDialog: false,\r\n      //存储表格选择项改变时的数据\r\n      multipleSelectionData: [],\r\n      //表格数据\r\n      tableData: [],\r\n      //总条数\r\n      totalCount: 1,\r\n      //存储门店数据\r\n      storeListData: [],\r\n      //生成时间\r\n      startTime: \"\",\r\n      //退款时间\r\n      refundStarTime: \"\"\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      userInfo: userTypes.GETTER_USERINFO\r\n    })\r\n  },\r\n  //过滤器\r\n  filters: {\r\n    //过滤单据状态\r\n    filterRefundMoneyOrderStatus(val) {\r\n      switch (val) {\r\n        case 0:\r\n          return \"退款中\";\r\n          break;\r\n        case 1:\r\n          return \"已退款\";\r\n          break;\r\n        case 2:\r\n          return \"退款异常\";\r\n          break;\r\n      }\r\n    },\r\n    //过滤退款方式\r\n    filterRefundMoneyWayCode(val) {\r\n      switch (val) {\r\n        case 1:\r\n          return \"现金\";\r\n          break;\r\n        case 2:\r\n          return \"微信付款\";\r\n          break;\r\n        case 3:\r\n          return \"刷卡\";\r\n          break;\r\n        case 4:\r\n          return \"余额支付\";\r\n          break;\r\n      }\r\n    },\r\n    //过滤退款来源\r\n    filterRefundMoneySource(val) {\r\n      switch (val) {\r\n        case 0:\r\n          return \"门店\";\r\n          break;\r\n        default:\r\n          return \"--\";\r\n          break;\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    //得到组织机构数据\r\n    this.getWarehouseListData();\r\n    //得到列表数据\r\n    this.getChannelReturnListData();\r\n  },\r\n  watch: {\r\n    \"accountVO.refundMoneyAccountNum\": function(val) {\r\n      this.$nextTick(() => {\r\n        this.accountVO.refundMoneyAccountNum = val.replace(/\\D/g, \"\").replace(/....(?!$)/g, \"$& \");\r\n      });\r\n    }\r\n  },\r\n  methods: {\r\n    //得到组织机构数据\r\n    async getWarehouseListData() {\r\n      let info = await this.request(this.api.user.get_userinfo, {}, true);\r\n      console.log(info);\r\n      //得到部门Id\r\n      // this.signData.relationDepId = info.departId;\r\n      this.request(this.api.user.userCompany_getUserOrgByUserId, {\r\n        userId: info.userId,\r\n        type: 0\r\n      }).then(data => {\r\n        //得到门店列表数据\r\n        this.getStoreBasicListData(data.id);\r\n      });\r\n    },\r\n    //得到门店列表数据\r\n    getStoreBasicListData(organizationId) {\r\n      this.request(this.api.store.storeBasic_list, {}).then(res => {\r\n        console.log(res);\r\n        this.storeListData = res.data;\r\n      });\r\n    },\r\n    //得到列表数据\r\n    getChannelReturnListData() {\r\n      if (this.startTime) {\r\n        this.signData.startDate = this.startTime[0];\r\n        this.signData.endDate = this.startTime[1];\r\n      }\r\n      if (this.refundStarTime) {\r\n        this.signData.refundStartDate = this.refundStarTime[0];\r\n        this.signData.refundEndDate = this.refundStarTime[1];\r\n      }\r\n      this.request(\r\n        this.api.retailStore.storeConsumerRefundMoney_list,\r\n        this.signData\r\n      ).then(data => {\r\n        this.totalCount = data.totalCount;\r\n        this.tableData = data.data;\r\n        console.log(data);\r\n      });\r\n    },\r\n    //查询表单数据\r\n    searchFormData(ref) {\r\n      this.$refs[ref].validate(valid => {\r\n        console.log(valid);\r\n        if (valid) {\r\n          this.getChannelReturnListData();\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //重置表单数据\r\n    resetFormData(formData) {\r\n      console.log(this.$refs[formData]);\r\n      this.$refs[formData].resetFields();\r\n      this.signData.startDate = \"\";\r\n      this.signData.endDate = \"\";\r\n      this.signData.refundStartDate = \"\";\r\n      this.signData.refundEndDate = \"\";\r\n\r\n      this.startTime = \"\";\r\n      this.refundStarTime = \"\";\r\n    },\r\n    //导出\r\n    exportExcel() {\r\n      console.log(\"导出Excel表格...+++++++++++++++++++\");\r\n      require.ensure([], () => {\r\n        let { export_json_to_excel } = require(\"@/vendor/Export2Excel\");\r\n        let tHeader = [\r\n          \"退款单号\",\r\n          \"单据状态\",\r\n          \"退款方式\",\r\n          \"退款金额\",\r\n          \"退款原因\",\r\n          \"退款时间\",\r\n          \"生成时间\",\r\n          \"源订单号\",\r\n          \"退款来源\",\r\n          \"支付订单号\",\r\n          \"所属门店\"\r\n        ];\r\n        // 上面设置Excel的表格第一行的标题\r\n        let filterVal = [\r\n          \"refundMoneyOrderNum\",\r\n          \"refundMoneyOrderStatusName\",\r\n          \"refundMoneyWayCodeName\",\r\n          \"refundMoney\",\r\n          \"reason\",\r\n          \"refundMoneyTimeFilter\",\r\n          \"createTimeFilter\",\r\n          \"sourceOrderNum\",\r\n          \"refundMoneySourceName\",\r\n          \"paymentNum\",\r\n          \"storeName\"\r\n        ];\r\n        // 上面的index、nickName、name是tableData里对象的属性\r\n        let list = this.multipleSelectionData; //把data里的multipleSelectionData存到list\r\n        let data = this.formatJson(filterVal, list);\r\n        export_json_to_excel(tHeader, data, \"渠道退款表单\");\r\n      });\r\n    },\r\n    formatJson(filterVal, jsonData) {\r\n      return jsonData.map(v => filterVal.map(j => v[j]));\r\n    },\r\n    //表格选择项改变时触发\r\n    selectionChange(val) {\r\n      val.forEach(item => {\r\n        item.refundMoneyOrderStatusName = this.$options.filters.filterRefundMoneyOrderStatus(\r\n          item.refundMoneyOrderStatus\r\n        );\r\n        item.refundMoneyWayCodeName = this.$options.filters.filterRefundMoneyWayCode(\r\n          item.refundMoneyWayCode\r\n        );\r\n        item.refundMoneySourceName = this.$options.filters.filterRefundMoneySource(\r\n          item.refundMoneySource\r\n        );\r\n        item.refundMoneyTimeFilter = this.$options.filters.timestampToTime(\r\n          item.refundMoneyTime\r\n        );\r\n        item.createTimeFilter = this.$options.filters.timestampToTime(\r\n          item.createTime\r\n        );\r\n      });\r\n      console.log(val);\r\n      this.multipleSelectionData = val;\r\n    },\r\n    //查看Btn的事件\r\n    checkBtnClick(row) {\r\n      console.log(row);\r\n      this.$router.push({\r\n        path: \"/store_refund_check\",\r\n        query: {\r\n          refundId: row.id\r\n        }\r\n      });\r\n    },\r\n    //退款Btn的事件\r\n    refundBtnClick(row) {\r\n      console.log(row);\r\n\r\n      // updateName: row.goodsOwner\r\n      switch (row.refundMoneyWayCode) {\r\n        case 2:\r\n          //微信支付\r\n          this.wxPay(row);\r\n          break;\r\n        case 3:\r\n          this.refundMoney = row.refundMoney;\r\n          this.accountVO.id = row.id;\r\n          //银行卡支付\r\n          this.showRefundDialog = true;\r\n          break;\r\n      }\r\n    },\r\n    //添加备注Btn的事件\r\n    addRemarkBtnClick(row) {\r\n      this.showRemarkDialog = true;\r\n      this.accountVO.id = row.id;\r\n    },\r\n    //退款-微信支付\r\n    wxPay(row) {\r\n      this.$confirm(\"确认再次发起退款？\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\"\r\n      })\r\n        .then(() => {\r\n          this.request(\r\n            this.api.retailStore.storeConsumerRefundMoney_againRefundMoney,\r\n            {\r\n              id: row.id,\r\n              updateName: this.userInfo.name\r\n            }\r\n          ).then(data => {\r\n            console.log(data);\r\n            //刷新数据\r\n            this.getChannelReturnListData();\r\n          });\r\n        })\r\n        .catch(action => {});\r\n    },\r\n    //每页条数改变时\r\n    handleSizeChange(page) {\r\n      this.signData.pageSize = page;\r\n      this.getChannelReturnListData();\r\n    },\r\n    //当前页改变时\r\n    handleCurrentChange(page) {\r\n      this.signData.pageIndex = page;\r\n      this.getChannelReturnListData();\r\n    },\r\n    //退款dialog中确认btn的点击事件\r\n    sureRefundDailogBtnClick(ref) {\r\n      console.log(\"sureRefundDailogBtnClick--------\");\r\n      this.$refs[ref].validate(valid => {\r\n        console.log(valid);\r\n        if (valid) {\r\n          this.request(\r\n            this.api.retailStore\r\n              .storeConsumerRefundMoney_updateStoreConsumerRefundMoney,\r\n            this.accountVO\r\n          ).then(res => {\r\n            this.hideRefundDialogEvent();\r\n            this.getChannelReturnListData();\r\n          });\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //退款Dialog的隐藏事件\r\n    hideRefundDialogEvent() {\r\n      this.$refs.refundForm.resetFields();\r\n      this.showRefundDialog = false;\r\n      console.log(\"hideRefundDialogEvent-------\");\r\n    },\r\n    //添加备注Dialog中确认btn的点击事件\r\n    sureRemarkDailogBtnClick(ref) {\r\n      this.$refs[ref].validate(valid => {\r\n        console.log(valid);\r\n        if (valid) {\r\n          this.request(\r\n            this.api.retailStore\r\n              .storeConsumerRefundMoney_updateStoreConsumerRefundMoney,\r\n            this.accountVO\r\n          ).then(res => {\r\n            this.hideRemarksDialogEvent();\r\n            this.getChannelReturnListData();\r\n          });\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //添加备注Dialog的隐藏事件\r\n    hideRemarksDialogEvent() {\r\n      this.showRemarkDialog = false;\r\n      this.$refs.remarkForm.resetFields();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search_div {\r\n  margin: 0 10px;\r\n  padding-top: 20px;\r\n  background-color: #fff;\r\n  .first-input {\r\n    width: 300px;\r\n  }\r\n}\r\n.remark /deep/ .el-textarea__inner {\r\n  height: 100px;\r\n}\r\n.table_div {\r\n  margin: 10px;\r\n  background-color: #fff;\r\n  padding-top: 20px;\r\n  padding-left: 10px;\r\n}\r\n</style>\r\n\r\n\r\n\r\n"]}]}