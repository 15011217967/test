{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\content\\create\\components\\Atlas.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\content\\create\\components\\Atlas.vue","mtime":1572415123607},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport ReleasePublic from '@/views/content/create/components/ReleasePublic';\nimport UploadImg from '@/components/editor/UploadImg';\nimport RadioList from '@/views/content/create/components/RadioList';\nimport Sortable from 'sortablejs';\nexport default {\n  props: {\n    formData: {\n      type: Object\n    }\n  },\n  // 数据\n  data: function data() {\n    return {\n      // 修改的行\n      uploadRow: null,\n      // 选择图片弹窗\n      imgCheckDialog: false,\n      // tabs 默认选中的\n      activeName: 'local',\n      // 素材列表\n      materialRadioCheck: [],\n      materialImgList: [],\n      materialImgFrom: {\n        pageIndex: 1,\n        pageSize: 12,\n        type: 2 // 1 -- 视频  2 -- 图片\n\n      }\n    };\n  },\n  // 组件\n  components: {\n    ReleasePublic: ReleasePublic,\n    UploadImg: UploadImg,\n    RadioList: RadioList\n  },\n  created: function created() {},\n  // 初始化数据\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.$nextTick(function () {\n      // 初始行拖拽\n      _this2.rowDrop();\n    });\n  },\n  // 方法\n  methods: {\n    // 初始化\n    init: function init() {\n      // 初始化公共的\n      this.$refs.releasePublic.init();\n    },\n    // 表格行拖拽\n    rowDrop: function rowDrop() {\n      var tbody = this.$refs.dragTable.$el.querySelector('.el-table__body-wrapper > table > tbody');\n\n      var _this = this;\n\n      Sortable.create(tbody, {\n        onEnd: function onEnd(_ref) {\n          var newIndex = _ref.newIndex,\n              oldIndex = _ref.oldIndex;\n          if (newIndex === oldIndex) return;\n\n          var currRow = _this.formData.atlasList.splice(oldIndex, 1)[0];\n\n          _this.formData.atlasList.splice(newIndex, 0, currRow);\n        }\n      });\n    },\n    // 删除\n    delTableItem: function delTableItem(scope) {\n      var _this3 = this;\n\n      this.$confirm('确认删除吗？', '删除', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        showClose: false\n      }).then(function () {\n        _this3.$message.success('删除成功');\n\n        _this3.formData.atlasList.splice(scope.$index, 1);\n      }).catch(function () {});\n    },\n    // 更改\n    uploadTableImg: function uploadTableImg(scope) {\n      this.uploadRow = scope;\n      this.imgCheckDialogShow();\n    },\n    // 选择图片弹窗显示\n    imgCheckDialogShow: function imgCheckDialogShow() {\n      this.imgCheckDialog = true;\n      this.materialImgFrom.pageIndex = 1;\n      this.activeName = 'local';\n    },\n    imgCheckDialogClose: function imgCheckDialogClose() {\n      this.uploadRow = null;\n    },\n    //图片 素材 本地 切换\n    handleClick: function handleClick(node) {\n      if (node.name === 'material') {\n        this.getMaterialImgData(false);\n      }\n    },\n    // 图片回调\n    uploadImgCallBack: function uploadImgCallBack(url) {\n      if (url) {\n        if (this.uploadRow) {\n          this.uploadRow.row.url = url;\n          this.uploadRow = null;\n        } else {\n          this.formData.atlasList.push({\n            url: url,\n            description: '',\n            type: 2 // 图片类型  1  封面  2  内容\n\n          });\n        }\n\n        this.imgCheckDialog = false;\n      }\n    },\n    // 选中素材\n    imgCheckDialogSub: function imgCheckDialogSub() {\n      if (this.materialRadioCheck) {\n        if (this.uploadRow) {\n          this.uploadRow.row.url = this.materialRadioCheck[0].url;\n        } else {\n          this.formData.atlasList.push({\n            url: this.materialRadioCheck[0].url,\n            libraryId: this.materialRadioCheck[0].id,\n            description: '',\n            type: 2 // 图片类型  1  封面  2  内容\n\n          });\n        }\n\n        this.imgCheckDialog = false;\n        this.uploadRow = null;\n      } else {\n        this.$message.error('请选择图片');\n      }\n    },\n    // 获取素材信息\n    getMaterialImgData: function getMaterialImgData(flag) {\n      var _this4 = this;\n\n      if (flag) {\n        this.materialImgFrom.pageIndex++;\n      }\n\n      this.request(this.api.contentCore.library_list, this.materialImgFrom).then(function (data) {\n        if (flag) {\n          _this4.materialImgList = _this4.materialImgList.concat(data.data);\n        } else {\n          _this4.materialImgList = data.data;\n        }\n      });\n    }\n  },\n  // 计算属性\n  computed: {},\n  // 监听数据变化\n  watch: {}\n};",{"version":3,"sources":["Atlas.vue"],"names":[],"mappings":"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","sourcesContent":["<style lang=\"less\" scoped>\r\n  .my-atlas{\r\n    .atlas-upload-img{padding: 20px;}\r\n    .table-img{height: 100px;}\r\n    .material-upload{height: 80px;width: 80px;border-radius: 5px;border: 1px dashed #d9d9d9;cursor: pointer;text-align: center;float: left;margin-right: 20px;line-height: 80px;\r\n    }\r\n    .material-upload:hover{border: 1px dashed #409EFF;}\r\n    .img-list{height: 200px;overflow: auto;}\r\n  }\r\n</style>\r\n<template>\r\n  <div class=\"my-atlas\">\r\n    <release-public :form-data=\"formData\" ref=\"releasePublic\">\r\n      <!--发布图集-->\r\n      <el-table :data=\"formData.atlasList\" ref=\"dragTable\" style=\"width: 100%\"  row-key=\"url\" :show-header=\"false\">\r\n        <el-table-column prop=\"name\" label=\"图片\" width=\"300\">\r\n          <template slot-scope=\"scope\">\r\n            <img :src=\"scope.row.url\" alt=\"\" class=\"table-img\" v-if=\"scope.row.url\">\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"description\" label=\"描述\">\r\n          <template slot-scope=\"scope\">\r\n            <el-input type=\"textarea\" :rows=\"4\" placeholder=\"请输入图片说明\" v-model=\"scope.row.description\">\r\n            </el-input>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" width=\"160\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"text\" size=\"small\" @click=\"uploadTableImg(scope)\">更换</el-button>\r\n            <el-button type=\"text\" size=\"small\"  @click=\"delTableItem(scope)\">删除</el-button>\r\n            <el-button type=\"text\" size=\"small\">移动</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div class=\"atlas-upload-img clearfix\">\r\n        <div class=\"material-upload\" @click=\"imgCheckDialogShow\">选择图片</div>\r\n      </div>\r\n    </release-public>\r\n    <el-dialog title=\"选择图片\" :visible.sync=\"imgCheckDialog\" width=\"45%\" :close-on-click-modal=\"false\" :close=\"imgCheckDialogClose\">\r\n      <div class=\"upload-list\">\r\n        <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\r\n          <el-tab-pane label=\"本地上传\" name=\"local\">\r\n            <upload-img :call-back=\"uploadImgCallBack\" content-txt=\"本地选择\"></upload-img>\r\n          </el-tab-pane>\r\n          <el-tab-pane label=\"素材库\" name=\"material\">\r\n            <div class=\"img-list\">\r\n              <radio-list :radio-list=\"materialImgList\" :type=\"2\" :radio-check=\"materialRadioCheck\" v-if=\"activeName === 'material'\"></radio-list>\r\n              <el-button type=\"primary\" @click=\"getMaterialImgData(true)\" size=\"small\">加载更多</el-button>\r\n            </div>\r\n          </el-tab-pane>\r\n        </el-tabs>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\" v-if=\"activeName === 'material'\">\r\n        <el-button @click=\"imgCheckDialog = false\" size=\"small\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"imgCheckDialogSub\" size=\"small\">确 定</el-button>\r\n        </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\n  import ReleasePublic from '@/views/content/create/components/ReleasePublic'\r\n  import UploadImg from '@/components/editor/UploadImg'\r\n  import RadioList from '@/views/content/create/components/RadioList'\r\n  import Sortable from 'sortablejs'\r\n  export default {\r\n    props:{\r\n      formData:{\r\n        type: Object\r\n      }\r\n    },\r\n    // 数据\r\n    data() {\r\n      return {\r\n        // 修改的行\r\n        uploadRow:null,\r\n\r\n        // 选择图片弹窗\r\n        imgCheckDialog: false,\r\n        // tabs 默认选中的\r\n        activeName: 'local',\r\n        // 素材列表\r\n        materialRadioCheck: [],\r\n        materialImgList: [],\r\n        materialImgFrom: {\r\n          pageIndex: 1,\r\n          pageSize: 12,\r\n          type: 2  // 1 -- 视频  2 -- 图片\r\n        }\r\n      }\r\n    },\r\n    // 组件\r\n    components: {\r\n      ReleasePublic,\r\n      UploadImg,\r\n      RadioList\r\n    },\r\n    created(){\r\n\r\n    },\r\n    // 初始化数据\r\n    mounted() {\r\n      this.$nextTick(() => {\r\n        // 初始行拖拽\r\n        this.rowDrop()\r\n      })\r\n    },\r\n    // 方法\r\n    methods: {\r\n      // 初始化\r\n      init(){\r\n        // 初始化公共的\r\n        this.$refs.releasePublic.init()\r\n      },\r\n      // 表格行拖拽\r\n      rowDrop() {\r\n        const tbody = this.$refs.dragTable.$el.querySelector('.el-table__body-wrapper > table > tbody')\r\n        const _this = this\r\n        Sortable.create(tbody, {\r\n          onEnd({ newIndex, oldIndex }) {\r\n            if(newIndex === oldIndex) return\r\n            const currRow = _this.formData.atlasList.splice(oldIndex, 1)[0]\r\n            _this.formData.atlasList.splice(newIndex, 0, currRow)\r\n          }\r\n        })\r\n      },\r\n      // 删除\r\n      delTableItem(scope){\r\n        this.$confirm('确认删除吗？', '删除', {\r\n          confirmButtonText: '确认',\r\n          cancelButtonText: '取消',\r\n          showClose:false\r\n        }).then(() => {\r\n          this.$message.success('删除成功');\r\n          this.formData.atlasList.splice(scope.$index, 1)\r\n        }).catch(() => {\r\n        });\r\n\r\n      },\r\n      // 更改\r\n      uploadTableImg(scope){\r\n        this.uploadRow = scope\r\n        this.imgCheckDialogShow()\r\n      },\r\n\r\n\r\n      // 选择图片弹窗显示\r\n      imgCheckDialogShow(){\r\n        this.imgCheckDialog = true\r\n        this.materialImgFrom.pageIndex = 1\r\n        this.activeName = 'local'\r\n      },\r\n      imgCheckDialogClose(){\r\n        this.uploadRow = null\r\n      },\r\n      //图片 素材 本地 切换\r\n      handleClick(node){\r\n        if(node.name === 'material'){\r\n          this.getMaterialImgData(false)\r\n        }\r\n      },\r\n      // 图片回调\r\n      uploadImgCallBack(url){\r\n        if(url){\r\n          if(this.uploadRow){\r\n            this.uploadRow.row.url = url\r\n            this.uploadRow = null\r\n          }else{\r\n            this.formData.atlasList.push({\r\n              url: url,\r\n              description: '',\r\n              type: 2   // 图片类型  1  封面  2  内容\r\n            })\r\n          }\r\n          this.imgCheckDialog = false\r\n        }\r\n      },\r\n\r\n      // 选中素材\r\n      imgCheckDialogSub(){\r\n        if(this.materialRadioCheck){\r\n          if(this.uploadRow){\r\n            this.uploadRow.row.url = this.materialRadioCheck[0].url\r\n          }else{\r\n            this.formData.atlasList.push({\r\n              url: this.materialRadioCheck[0].url,\r\n              libraryId: this.materialRadioCheck[0].id,\r\n              description: '',\r\n              type: 2   // 图片类型  1  封面  2  内容\r\n            })\r\n          }\r\n          this.imgCheckDialog = false\r\n          this.uploadRow = null\r\n        }else{\r\n          this.$message.error('请选择图片')\r\n        }\r\n      },\r\n      // 获取素材信息\r\n      getMaterialImgData(flag){\r\n        if(flag){\r\n          this.materialImgFrom.pageIndex++\r\n        }\r\n        this.request(this.api.contentCore.library_list, this.materialImgFrom).then(data => {\r\n          if(flag){\r\n            this.materialImgList = this.materialImgList.concat(data.data)\r\n          }else {\r\n            this.materialImgList =  data.data\r\n          }\r\n        });\r\n      },\r\n\r\n    },\r\n    // 计算属性\r\n    computed: {},\r\n    // 监听数据变化\r\n    watch: {\r\n\r\n    }\r\n  }\r\n</script>\r\n"],"sourceRoot":"src/views/content/create/components"}]}