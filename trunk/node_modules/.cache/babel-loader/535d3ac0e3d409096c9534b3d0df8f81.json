{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\product\\video\\video_list.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\product\\video\\video_list.vue","mtime":1574160265127},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _toConsumableArray from \"C:\\\\Users\\\\EDZ\\\\Desktop\\\\\\u7814\\u53D1\\u9879\\u76EE\\\\vue-project\\\\trunk\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport VideoPlayView from \"../components/videoPlay.vue\";\nvar selectedVideoList = []; //已选视频数据\n\nvar selectedVideoChannelList = []; //已选视频频道列表\n\nexport default {\n  name: 'video_list',\n  data: function data() {\n    var _this = this;\n\n    return {\n      pickerOptions0: {\n        disabledDate: function disabledDate(time) {\n          if (_this.filtersData.endTime != \"\") {\n            return time.getTime() > Date.now() || time.getTime() > _this.filtersData.endTime;\n          } else {\n            return time.getTime() > Date.now();\n          }\n        }\n      },\n      pickerOptions1: {\n        disabledDate: function disabledDate(time) {\n          return (//time.getTime() <  ( new Date(this.filtersData.startTime).getTime() - 1 * 24 * 60 * 60 * 1000) || time.getTime() < Date.now()\n            time.getTime() < new Date(_this.filtersData.startTime).getTime()\n          ); //减去一天的时间代表可以选择同一天;\n        }\n      },\n      filtersData: {\n        pageIndex: 1,\n        //当前页码\n        pageSize: 12,\n        //每页数量\n        searchWords: \"\",\n        subset: true,\n        channelId: null,\n        endTime: \"\",\n        startTime: \"\"\n      },\n      listData: [],\n      total: null,\n      //总条目数\n      batchDialogVisible: false,\n      //dialog 状态\n      btnStatus: true,\n      viewStatus: false,\n      selectStatus: false,\n      dialogFormData: {\n        setVideoChannelData: [] //Channelmodel 数据\n\n      },\n      videoChannelOptions: [] //opt列表数据\n\n    };\n  },\n  created: function created() {\n    this.getTableList(); //获取视频频道列表\n\n    this.getVideoChannel();\n  },\n  activated: function activated() {\n    this.getTableList();\n  },\n  methods: {\n    //获取视频频道列表\n    getVideoChannel: function getVideoChannel() {\n      var _this2 = this;\n\n      this.request(this.api.product.videoChannel_list, {}).then(function (res) {\n        _this2.videoChannelOptions = res.data;\n      });\n    },\n    //获取列表\n    getTableList: function getTableList() {\n      var _this3 = this;\n\n      var filter = this.$common.deepCopy(this.filtersData);\n\n      if (filter.endTime != null) {\n        var date = new Date(filter.endTime);\n        var t = (date.getTime() / 1000 + 86399) * 1000;\n        filter.endTime = new Date(t);\n      }\n\n      this.request(this.api.product.video_list, filter).then(function (data) {\n        var _data = data.data,\n            _dataLen = _data.length;\n\n        for (var i = 0; i < _dataLen; i++) {\n          _data[i]._time = _this3.$options.filters.timestampToTime(_data[i].createTime, \"ymd\");\n          _data[i]._status = false;\n\n          var _channelNames = _data[i].videoChannelAssociates || [];\n\n          var arr = [];\n\n          for (var k = 0; k < _channelNames.length; k++) {\n            arr.push(_channelNames[k].channelName);\n          }\n\n          _data[i].channelNames = arr.join(\"、\");\n        }\n\n        _this3.listData = _data;\n        _this3.total = data.totalCount;\n      });\n      filter = null;\n    },\n    //打开视频播放\n    openPlay: function openPlay(item) {\n      this.$refs.videoRef.videoInit(item.url);\n    },\n    //当前选中\n    setCheck: function setCheck(item) {\n      item._status = !item._status;\n    },\n    //全选本页面\n    allHandleSelect: function allHandleSelect(type) {\n      if (type == \"off\") {\n        for (var i = 0; i < this.listData.length; i++) {\n          this.listData[i]._status = false;\n        }\n      } else {\n        this.selectStatus = !this.selectStatus;\n\n        for (var _i = 0; _i < this.listData.length; _i++) {\n          this.listData[_i]._status = this.selectStatus;\n        }\n      }\n    },\n    offHandleSelected: function offHandleSelected() {\n      this.btnStatus = true;\n      this.viewStatus = false;\n      this.selectStatus = false;\n      this.allHandleSelect(\"off\");\n    },\n    //批量操作\n    allHandleChannel: function allHandleChannel() {\n      var list = [];\n      selectedVideoList = [];\n      var _data = this.listData;\n\n      for (var i = 0; i < _data.length; i++) {\n        if (_data[i]._status == true) {\n          list.push(_data[i]);\n        }\n      }\n\n      if (list.length <= 0) {\n        this.$message.error(\"请选择需要操作的视频\");\n        return false;\n      }\n\n      selectedVideoList = list;\n      this.batchDialogVisible = true;\n    },\n    //dialog提交\n    dialogSubmitForm: function dialogSubmitForm(formName) {\n      var _this4 = this;\n\n      //已选视频标签列表\n      if (selectedVideoChannelList.length <= 0) {\n        this.$message.error(\"请选择关联频道\");\n        return false;\n      } //已选视频列表\n\n\n      var videoList = this.$common.deepCopy(selectedVideoList); //循环视频列表\n\n      for (var i = 0; i < videoList.length; i++) {\n        var associates = videoList[i].videoChannelAssociates; //更换另一种方法\n\n        var videoChannelList = this.$common.deepCopy(selectedVideoChannelList);\n        var arr = [].concat(_toConsumableArray(associates), _toConsumableArray(videoChannelList));\n        var obj = {};\n        arr = arr.reduce(function (item, next) {\n          obj[next.channelId] ? \"\" : obj[next.channelId] = true && item.push(next);\n          return item;\n        }, []);\n\n        for (var o = 0; o < arr.length; o++) {\n          arr[o].videoName = videoList[i].name;\n          arr[o].videoId = videoList[i].id;\n        }\n\n        videoList[i].videoChannelAssociates = arr;\n      }\n\n      this.request(this.api.product.video_saveBatch, videoList).then(function (res) {\n        _this4.$message.success(\"保存成功\");\n\n        _this4.offHandleSelected();\n\n        setTimeout(function () {\n          _this4.closeDialog();\n\n          _this4.handleSearch();\n        }, 1500);\n      });\n    },\n    //关闭\n    closeDialog: function closeDialog() {\n      selectedVideoChannelList = [];\n      this.$refs[\"dialogForm\"].resetFields(); //重置选项\n\n      this.batchDialogVisible = false;\n    },\n    //多选发生改变\n    setChannelGet: function setChannelGet(item) {\n      var mutex = this.dialogFormData.setVideoChannelData,\n          mutexLen = mutex.length;\n      var mutexList = this.videoChannelOptions,\n          mutexListLen = mutexList.length;\n      var categories = [];\n\n      for (var i = 0; i < mutexLen; i++) {\n        for (var k = 0; k < mutexListLen; k++) {\n          if (mutex[i] == mutexList[k].id) {\n            categories.push({\n              channelId: mutexList[k].id,\n              channelName: mutexList[k].name\n            });\n          }\n        }\n      }\n\n      selectedVideoChannelList = categories;\n    },\n    //removeVideo\n    removeVideo: function removeVideo(params) {\n      var _this5 = this;\n\n      this.$confirm('此操作将删除, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this5.request(_this5.api.product.video_logicDelete, params).then(function (res) {\n          _this5.$message.success(\"删除成功\");\n\n          _this5.handleSearch();\n        });\n      }).catch(function () {\n        _this5.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    //新增视频  跳转页面\n    openAddDetails: function openAddDetails() {\n      this.$router.push({\n        path: \"/product/video/add_video\",\n        query: {\n          type: \"add\"\n        }\n      });\n    },\n    //查看视频\n    openShowDetails: function openShowDetails(params) {\n      this.$router.push({\n        path: \"/product/video/show_video\",\n        query: {\n          id: params,\n          type: \"show\"\n        }\n      });\n    },\n    //修改视频\n    openEditDetails: function openEditDetails(params) {\n      this.$router.push({\n        path: \"/product/video/edit_video\",\n        query: {\n          id: params,\n          type: \"edit\"\n        }\n      });\n    },\n    //搜索\n    handleSearch: function handleSearch() {\n      this.filtersData.pageIndex = 1;\n      this.getTableList();\n    },\n    //清空重置\n    handleResetFilters: function handleResetFilters(formName) {\n      this.filtersData.endTime = '';\n      this.$refs[formName].resetFields();\n    },\n    //当前页数修改时发生改变\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.filtersData.pageIndex = val;\n      this.getTableList();\n    },\n    // 每页显示多少条时发生改变\n    handleSizeChange: function handleSizeChange(val) {\n      this.filtersData.pageSize = val;\n      this.getTableList();\n    }\n  },\n  components: {\n    VideoPlayView: VideoPlayView\n  }\n};",{"version":3,"sources":["video_list.vue"],"names":[],"mappings":"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","sourcesContent":["<!--\r\n * @Description: 视频列表\r\n * @Author: elephant\r\n * @Date: 2019-08-13 18:04:11\r\n * @LastEditTime: 2019-11-14 15:41:56\r\n * @LastEditors: your name\r\n -->\r\n<template>\r\n  <div>\r\n    <div class=\"item-margin\">\r\n      <el-form\r\n        class=\"item-form\"\r\n        :model=\"filtersData\"\r\n        label-width=\"90px\"\r\n        size=\"small\"\r\n        ref=\"filtersForm\"\r\n        inline\r\n      >\r\n        <el-form-item prop=\"channelId\" label=\"关联频道：\">\r\n          <el-select class=\"input-w\" placeholder=\"请选择\" v-model=\"filtersData.channelId\">\r\n            <el-option\r\n              v-for=\"item in videoChannelOptions\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.id\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item prop=\"startTime\" label=\"日期选择：\">\r\n          <el-date-picker\r\n          :clearable=\"false\"\r\n            v-model=\"filtersData.startTime\"\r\n            type=\"date\"\r\n            placeholder=\"开始日期\"\r\n            :picker-options=\"pickerOptions0\"\r\n            class=\"input-w\"\r\n          ></el-date-picker>-\r\n          <el-date-picker\r\n          :clearable=\"false\"\r\n            v-model=\"filtersData.endTime\"\r\n            type=\"date\"\r\n            placeholder=\"结束日期\"\r\n            :picker-options=\"pickerOptions1\"\r\n            class=\"input-w\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item prop=\"searchWords\" label=\"综合搜索：\">\r\n          <el-input class=\"input-w\" placeholder=\"请输入内容\" v-model=\"filtersData.searchWords\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button size=\"small\" @click=\"handleSearch\" type=\"primary\" plain>搜索</el-button>\r\n          <el-button size=\"small\" @click=\"handleResetFilters('filtersForm')\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    <!--table  -->\r\n    <div class=\"item-margin\">\r\n      <div class=\"item-cont\">\r\n        <el-button size=\"small\" type=\"primary\" @click=\"openAddDetails\">上传视频</el-button>\r\n        <el-button\r\n          v-if=\"btnStatus\"\r\n          size=\"small\"\r\n          type=\"primary\"\r\n          @click=\"btnStatus=false;viewStatus=true;\"\r\n          plain\r\n        >进行选择</el-button>\r\n        <el-button v-if=\"!btnStatus\" size=\"small\" @click=\"allHandleSelect\" type=\"primary\" plain>全选本页</el-button>\r\n        <el-button\r\n          v-if=\"!btnStatus\"\r\n          size=\"small\"\r\n          type=\"primary\"\r\n          @click=\"offHandleSelected();\"\r\n          plain\r\n        >取消选择</el-button>\r\n        <el-button\r\n          v-if=\"!btnStatus\"\r\n          size=\"small\"\r\n          type=\"primary\"\r\n          @click=\"allHandleChannel\"\r\n          plain\r\n        >批量操作</el-button>\r\n      </div>\r\n      <div class=\"item-table\">\r\n        <!-- 视频 -->\r\n        <div class=\"box-wrap\">\r\n          <ul v-for=\"(item,index) in listData\" :key=\"index\" class=\"view-wrap\">\r\n            <li class=\"view-item\">\r\n              <el-image class=\"view-img\" :src=\"item.cover\" fit=\"contain\"></el-image>\r\n              <div v-if=\"!viewStatus\" @click.stop=\"openPlay(item)\" class=\"view-play-wrap\"></div>\r\n              <div v-if=\"viewStatus\" @click.stop=\"setCheck(item)\" class=\"view-check-wrap\">\r\n                <nav :class=\"{'view-check':true, 'active':item._status}\">\r\n                  <i v-show=\"item._status\" class=\"el-icon-check\"></i>\r\n                </nav>\r\n              </div>\r\n            </li>\r\n            <li>{{item.name}}</li>\r\n            <li>关联频道：{{item.channelNames}}</li>\r\n            <li>上传时间：{{item._time}}</li>\r\n            <li>\r\n              <el-button @click=\"openEditDetails(item.id)\" size=\"small\" type=\"text\">编辑</el-button>\r\n              <el-button @click=\"removeVideo(item)\" size=\"small\" type=\"text\">删除</el-button>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n        <!-- 视频END  -->\r\n        <div v-show=\"btnStatus\" class=\"pagination mt-10 mb-20\">\r\n          <el-pagination\r\n            class=\"mr-20\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"filtersData.pageIndex\"\r\n            :page-size=\"filtersData.pageSize\"\r\n            layout=\"total, prev, pager, next, jumper\"\r\n            :total=\"total\"\r\n          ></el-pagination>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!--table END  -->\r\n    <!-- dialog  -->\r\n    <el-dialog\r\n      title=\"批量操作\"\r\n      :visible.sync=\"batchDialogVisible\"\r\n      class=\"alarmPopup\"\r\n      width=\"500px\"\r\n      :before-close=\"closeDialog\"\r\n      append-to-body\r\n    >\r\n      <el-form\r\n        class=\"item-form\"\r\n        :model=\"dialogFormData\"\r\n        label-width=\"100px\"\r\n        size=\"small\"\r\n        ref=\"dialogForm\"\r\n      >\r\n        <el-form-item prop=\"setVideoChannelData\" label=\"关联频道：\">\r\n          <el-select\r\n            multiple\r\n            v-model=\"dialogFormData.setVideoChannelData\"\r\n            @change=\"setChannelGet\"\r\n            placeholder=\"可多选\"\r\n            class=\"input-w-2\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in videoChannelOptions\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.id\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div class=\"item-right\">\r\n        <el-button size=\"small\" @click=\"closeDialog('dialogForm')\">取消</el-button>\r\n        <el-button size=\"small\" @click=\"dialogSubmitForm('dialogForm')\" type=\"primary\">确定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n    <!-- 视频组件 -->\r\n    <video-play-view ref=\"videoRef\"></video-play-view>\r\n  </div>\r\n</template>\r\n<script>\r\nimport VideoPlayView from \"../components/videoPlay.vue\";\r\nlet selectedVideoList = []; //已选视频数据\r\nlet selectedVideoChannelList = []; //已选视频频道列表\r\nexport default {\r\n  name:'video_list',\r\n  data() {\r\n    return {\r\n      pickerOptions0: {\r\n        disabledDate: time => {\r\n          if (this.filtersData.endTime != \"\") {\r\n            return (\r\n              time.getTime() > Date.now() ||\r\n              time.getTime() > this.filtersData.endTime\r\n            );\r\n          } else {\r\n            return time.getTime() > Date.now();\r\n          }\r\n        }\r\n      },\r\n      pickerOptions1: {\r\n        disabledDate: time => {\r\n          return (\r\n            //time.getTime() <  ( new Date(this.filtersData.startTime).getTime() - 1 * 24 * 60 * 60 * 1000) || time.getTime() < Date.now()\r\n              time.getTime() <  new Date(this.filtersData.startTime).getTime()\r\n          ); //减去一天的时间代表可以选择同一天;\r\n        }\r\n      },\r\n      filtersData: {\r\n        pageIndex: 1, //当前页码\r\n        pageSize: 12, //每页数量\r\n        searchWords: \"\",\r\n        subset: true,\r\n        channelId: null,\r\n        endTime: \"\",\r\n        startTime: \"\"\r\n      },\r\n      listData: [],\r\n      total: null, //总条目数\r\n      batchDialogVisible: false, //dialog 状态\r\n      btnStatus: true,\r\n      viewStatus: false,\r\n      selectStatus: false,\r\n      dialogFormData: {\r\n        setVideoChannelData: [] //Channelmodel 数据\r\n      },\r\n      videoChannelOptions: [] //opt列表数据\r\n    };\r\n  },\r\n  created() {\r\n    this.getTableList();\r\n    //获取视频频道列表\r\n    this.getVideoChannel();\r\n  },\r\n   activated () {\r\n      this.getTableList();\r\n    },\r\n  methods: {\r\n    //获取视频频道列表\r\n    getVideoChannel() {\r\n      this.request(this.api.product.videoChannel_list, {}).then(res => {\r\n        this.videoChannelOptions = res.data;\r\n      });\r\n    },\r\n    //获取列表\r\n    getTableList() {\r\n      let filter = this.$common.deepCopy(this.filtersData);\r\n      if (filter.endTime != null) {\r\n        let date = new Date(filter.endTime);\r\n        let t = (date.getTime() / 1000 + 86399) * 1000;\r\n        filter.endTime = new Date(t);\r\n      }\r\n      this.request(this.api.product.video_list, filter).then(data => {\r\n        let _data = data.data,\r\n          _dataLen = _data.length;\r\n        for (let i = 0; i < _dataLen; i++) {\r\n          _data[i]._time = this.$options.filters.timestampToTime(\r\n            _data[i].createTime,\r\n            \"ymd\"\r\n          );\r\n          _data[i]._status = false;\r\n          let _channelNames = _data[i].videoChannelAssociates || [];\r\n          let arr = [];\r\n          for (let k = 0; k < _channelNames.length; k++) {\r\n            arr.push(_channelNames[k].channelName);\r\n          }\r\n          _data[i].channelNames = arr.join(\"、\");\r\n        }\r\n        this.listData = _data;\r\n        this.total = data.totalCount;\r\n      });\r\n      filter = null;\r\n    },\r\n\r\n    //打开视频播放\r\n    openPlay(item) {\r\n      this.$refs.videoRef.videoInit(item.url);\r\n    },\r\n    //当前选中\r\n    setCheck(item) {\r\n      item._status = !item._status;\r\n    },\r\n    //全选本页面\r\n    allHandleSelect(type) {\r\n      if (type == \"off\") {\r\n        for (let i = 0; i < this.listData.length; i++) {\r\n          this.listData[i]._status = false;\r\n        }\r\n      } else {\r\n        this.selectStatus = !this.selectStatus;\r\n        for (let i = 0; i < this.listData.length; i++) {\r\n          this.listData[i]._status = this.selectStatus;\r\n        }\r\n      }\r\n    },\r\n    offHandleSelected() {\r\n      this.btnStatus = true;\r\n      this.viewStatus = false;\r\n      this.selectStatus = false;\r\n      this.allHandleSelect(\"off\");\r\n    },\r\n    //批量操作\r\n    allHandleChannel() {\r\n      let list = [];\r\n      selectedVideoList = [];\r\n      let _data = this.listData;\r\n      for (let i = 0; i < _data.length; i++) {\r\n        if (_data[i]._status == true) {\r\n          list.push(_data[i]);\r\n        }\r\n      }\r\n      if (list.length <= 0) {\r\n        this.$message.error(\"请选择需要操作的视频\");\r\n        return false;\r\n      }\r\n      selectedVideoList = list;\r\n      this.batchDialogVisible = true;\r\n    },\r\n    //dialog提交\r\n    dialogSubmitForm(formName) {\r\n      //已选视频标签列表\r\n      if (selectedVideoChannelList.length <= 0) {\r\n        this.$message.error(\"请选择关联频道\");\r\n        return false;\r\n      }\r\n      //已选视频列表\r\n      let videoList = this.$common.deepCopy(selectedVideoList);\r\n      //循环视频列表\r\n      for (let i = 0; i < videoList.length; i++) {\r\n        let associates = videoList[i].videoChannelAssociates;\r\n        //更换另一种方法\r\n        let videoChannelList = this.$common.deepCopy(selectedVideoChannelList);\r\n        let arr = [...associates, ...videoChannelList];\r\n        var obj = {};\r\n        arr = arr.reduce(function(item, next) {\r\n          obj[next.channelId]\r\n            ? \"\"\r\n            : (obj[next.channelId] = true && item.push(next));\r\n          return item;\r\n        }, []);\r\n        for (let o = 0; o < arr.length; o++) {\r\n          arr[o].videoName = videoList[i].name;\r\n          arr[o].videoId = videoList[i].id;\r\n        }\r\n        videoList[i].videoChannelAssociates = arr;\r\n      }\r\n      this.request(this.api.product.video_saveBatch, videoList).then(res => {\r\n        this.$message.success(\"保存成功\");\r\n        this.offHandleSelected();\r\n        setTimeout(() => {\r\n          this.closeDialog();\r\n          this.handleSearch();\r\n        }, 1500);\r\n      });\r\n    },\r\n    //关闭\r\n    closeDialog() {\r\n      selectedVideoChannelList = [];\r\n      this.$refs[\"dialogForm\"].resetFields(); //重置选项\r\n      this.batchDialogVisible = false;\r\n    },\r\n    //多选发生改变\r\n    setChannelGet(item) {\r\n      let mutex = this.dialogFormData.setVideoChannelData,\r\n        mutexLen = mutex.length;\r\n      let mutexList = this.videoChannelOptions,\r\n        mutexListLen = mutexList.length;\r\n      let categories = [];\r\n      for (let i = 0; i < mutexLen; i++) {\r\n        for (let k = 0; k < mutexListLen; k++) {\r\n          if (mutex[i] == mutexList[k].id) {\r\n            categories.push({\r\n              channelId: mutexList[k].id,\r\n              channelName: mutexList[k].name\r\n            });\r\n          }\r\n        }\r\n      }\r\n      selectedVideoChannelList = categories;\r\n    },\r\n    //removeVideo\r\n    removeVideo(params) {\r\n       this.$confirm('此操作将删除, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n             this.request(this.api.product.video_logicDelete, params).then(res => {\r\n            this.$message.success(\"删除成功\");\r\n            this.handleSearch();\r\n          });\r\n        }).catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '已取消删除'\r\n          });          \r\n        });\r\n    },\r\n    //新增视频  跳转页面\r\n    openAddDetails() {\r\n      this.$router.push({\r\n        path: \"/product/video/add_video\",\r\n        query: {\r\n          type: \"add\"\r\n        }\r\n      });\r\n    },\r\n    //查看视频\r\n    openShowDetails(params) {\r\n      this.$router.push({\r\n        path: \"/product/video/show_video\",\r\n        query: {\r\n          id: params,\r\n          type: \"show\"\r\n        }\r\n      });\r\n    },\r\n    //修改视频\r\n    openEditDetails(params) {\r\n      this.$router.push({\r\n        path: \"/product/video/edit_video\",\r\n        query: {\r\n          id: params,\r\n          type: \"edit\"\r\n        }\r\n      });\r\n    },\r\n    //搜索\r\n    handleSearch() {\r\n      this.filtersData.pageIndex = 1;\r\n      this.getTableList();\r\n    },\r\n    //清空重置\r\n    handleResetFilters(formName) {\r\n      this.filtersData.endTime='';\r\n      this.$refs[formName].resetFields();\r\n    },\r\n    //当前页数修改时发生改变\r\n    handleCurrentChange(val) {\r\n      this.filtersData.pageIndex = val;\r\n      this.getTableList();\r\n    },\r\n    // 每页显示多少条时发生改变\r\n    handleSizeChange(val) {\r\n      this.filtersData.pageSize = val;\r\n      this.getTableList();\r\n    }\r\n  },\r\n  components: {\r\n    VideoPlayView\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.box-wrap {\r\n  padding: 0 20px;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  flex-wrap: wrap;\r\n}\r\n.view-wrap {\r\n  width: 155px;\r\n  margin: 0 18px 5px 0;\r\n  > li {\r\n    font-size: 14px;\r\n  }\r\n  > li:nth-child(1) {\r\n    width: 155px;\r\n    height: 112px;\r\n    border: 1px solid #dddddd;\r\n    border-radius: 3px;\r\n    margin-bottom: 5px;\r\n  }\r\n  > li:nth-child(3) {\r\n    width: 155px;\r\n    overflow: hidden;\r\n    text-overflow:ellipsis;\r\nwhite-space: nowrap;\r\n  }\r\n  > li:nth-child(4) {\r\n    color: #999999;\r\n  }\r\n}\r\n.view-check-wrap,\r\n.view-play-wrap {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n.view-check-wrap {\r\n  cursor: pointer;\r\n}\r\n.view-item {\r\n  position: relative;\r\n  cursor: pointer;\r\n}\r\n.view-check {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: absolute;\r\n  right: 10px;\r\n  top: 10px;\r\n  border-radius: 50%;\r\n  width: 20px;\r\n  height: 20px;\r\n  border: 1px solid #999999;\r\n}\r\n.view-check.active {\r\n  background-color: #daa479;\r\n  border: 1px solid #daa479;\r\n  i {\r\n    color: #ffffff;\r\n  }\r\n}\r\n.view-img {\r\n  width: 155px;\r\n  height: 112px;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/product/video"}]}