{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\scb\\price\\price_list.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\scb\\price\\price_list.vue","mtime":1576217636750},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.find\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport { getToken } from \"@/utils/auth\";\nimport codeSet from \"@/components/codeSet\";\nimport treeDept from \"@/components/treeDept\";\nimport { filter } from \"minimatch\";\nimport { get } from \"http\";\nimport PageTable from \"@/views/collocation/components/PageTable\";\nvar token = getToken();\nexport default {\n  data: function data() {\n    return {\n      dialogTableVisible: false,\n      // 新建商品折扣提交参数\n      addFormData: {\n        \"administrator\": \"\",\n        // 管理员\n        \"merchantId\": \"\",\n        // 商品id\n        \"merchantName\": \"\",\n        // 商品名称\n        \"phone\": \"\",\n        // 采购商管理员手机号\n        \"purchaseAgentId\": \"\",\n        // 采购商id\n        \"purchaseAgentName\": \"\",\n        // 采购商名称\n        \"purchaserDiscountType\": 1,\n        // 采购商类型（0：满减，1：折扣）；\n        \"purchaserDiscountValue\": null // 采购折扣\n\n      },\n      // 折扣列表\n      discountData: [],\n      data_obj: {},\n      // 折扣类型\n      discountType: [\"预约折扣\", \"阶梯折扣\", \"单品折扣\"],\n      // 门店列表\n      storeList: {},\n      // 检索\n      filtersData: {\n        pageIndex: 1,\n        // 当前页码\n        pageSize: 10,\n        // 每页数量\n        \"orderBy\": \"\",\n        purchaseAgentId: null\n      },\n      // 门店\n      getStoreList_data: {},\n      // 过滤后的门店\n      storeBasic_listForScbPriceManagement_data: {},\n      rules: {\n        purchaseAgentId: [{\n          required: true,\n          message: '请选择门店！',\n          trigger: 'change'\n        }],\n        purchaserDiscountValue: [{\n          required: true,\n          message: '请输入正确的折扣数值！',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    var that = this; // 获取全部门店\n\n    this.getStoreList(); // 获取过滤后的门店\n\n    this.storeBasic_listForScbPriceManagement();\n    this.purchasingAgentPriceManagement_list(); // 获取折扣列表\n  },\n  methods: {\n    /**\r\n     * 新增列表数据\r\n     */\n    addList: function addList() {\n      var _this = this;\n\n      this.$refs.ruleForm.validate(function (valid) {\n        if (valid) {\n          var checkItem = _this.storeBasic_listForScbPriceManagement_data.data.find(function (item) {\n            return item.id == _this.addFormData.purchaseAgentId;\n          }); // return;\n\n\n          Object.assign(_this.addFormData, {\n            \"administrator\": checkItem.linkman,\n            // 管理员\n            \"phone\": checkItem.phone,\n            // 采购商管理员手机号\n            \"purchaseAgentName\": checkItem.name // 采购商名称\n\n          });\n\n          _this.request(_this.api.scb.purchasingAgentPriceManagement_save, _this.addFormData).then(function (res) {\n            _this.warn('新建成功！');\n\n            _this.dialogTableVisible = false;\n\n            _this.purchasingAgentPriceManagement_list(); // 清空新建提交数据\n\n\n            _this.addFormData = {\n              \"administrator\": \"\",\n              // 管理员\n              \"merchantId\": \"\",\n              // 商品id\n              \"merchantName\": \"\",\n              // 商品名称\n              \"phone\": \"\",\n              // 采购商管理员手机号\n              \"purchaseAgentId\": \"\",\n              // 采购商id\n              \"purchaseAgentName\": \"\",\n              // 采购商名称\n              \"purchaserDiscountType\": 0,\n              // 采购商类型（0：满减，1：折扣）；\n              \"purchaserDiscountValue\": 0 // 采购折扣\n\n            };\n          });\n        }\n      });\n    },\n\n    /**\r\n     * 查询门店列表\r\n     */\n    getStoreList: function getStoreList() {\n      var that = this;\n      this.request(that.api.store.storeBasic_list).then(function (res) {\n        that.getStoreList_data = res;\n      });\n    },\n\n    /**\r\n     * 查询门店列表\r\n     */\n    storeBasic_listForScbPriceManagement: function storeBasic_listForScbPriceManagement() {\n      var that = this;\n      this.request(that.api.store.storeBasic_listForScbPriceManagement).then(function (res) {\n        that.storeBasic_listForScbPriceManagement_data = res;\n      });\n    },\n\n    /**\r\n     * 删除折扣\r\n     */\n    removeDiscount: function removeDiscount(item) {\n      var _this2 = this;\n\n      this.$confirm(\"确定删除吗？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        switch (item.type) {\n          case 0:\n            _this2.request(_this2.api.market.marketingMiddleground_deleteDiscountSetting, {\n              id: item.discountId\n            }).then(function (res) {\n              _this2.purchasingAgentPriceManagement_list();\n\n              _this2.warn(\"删除成功!\");\n            });\n\n            break;\n\n          case 1:\n            _this2.request(_this2.api.market.marketingMiddleground_deleteDiscountParameterS, {\n              id: item.discountId\n            }).then(function (res) {\n              _this2.purchasingAgentPriceManagement_list();\n\n              _this2.warn(\"删除成功!\");\n            });\n\n            break;\n\n          case 2:\n            _this2.request(_this2.api.market.marketingMiddleground_deleteSingleProductDiscount, {\n              id: item.discountId\n            }).then(function (res) {\n              _this2.purchasingAgentPriceManagement_list();\n\n              _this2.warn(\"删除成功!\");\n            });\n\n            break;\n        }\n      }).catch(function () {\n        _this2.warn(\"取消删除!\", \"info\");\n      });\n    },\n\n    /**\r\n     * 提示\r\n     * @param { String } message 提示文案\r\n     * @param { String } type 提示类型\r\n     */\n    warn: function warn(message, type) {\n      this.$message({\n        message: message,\n        type: type || \"success\"\n      });\n    },\n\n    /**\r\n     * 编辑\r\n     * @param { Object } item 当前对象\r\n     * @param { Boolean } isRead 是否可对写\r\n     * @property { Boolean }isEcho 是否是编辑\r\n     * @return { Object } Obj 返回对象\r\n     */\n    timeRedact: function timeRedact(item) {\n      var Obj = {};\n      this.href(\"scb/price/price_edit\", {\n        isEdit: true,\n        id: item.id\n      });\n    },\n\n    /**\r\n     * 获取折扣列表\r\n     */\n    purchasingAgentPriceManagement_list: function purchasingAgentPriceManagement_list() {\n      var _this3 = this;\n\n      this.request(this.api.scb.purchasingAgentPriceManagement_list, this.filtersData).then(function (res) {\n        _this3.discountData = res;\n      });\n    },\n\n    /**\r\n     * 跳转工单详情\r\n     */\n    href: function href(routeName, param) {\n      this.$router.push({\n        path: \"/\" + routeName,\n        query: param\n      });\n    },\n\n    /**\r\n     * 模糊搜索\r\n     */\n    handleSearch: function handleSearch() {\n      this.filtersData.pageIndex = 1;\n      this.purchasingAgentPriceManagement_list();\n    },\n\n    /**\r\n     * 搜索重置\r\n     */\n    handleResetFilters: function handleResetFilters() {\n      Object.assign(this.filtersData, {\n        pageIndex: 1,\n        // 当前页码\n        pageSize: 10,\n        // 每页数量\n        \"orderBy\": \"\",\n        purchaseAgentId: null\n      });\n    },\n\n    /**\r\n     * 点击页数\r\n     * @param { Number } pageIndex 当前页\r\n     */\n    handleCurrentChange: function handleCurrentChange(pageIndex) {\n      this.filtersData.pageIndex = pageIndex;\n      this.purchasingAgentPriceManagement_list();\n    },\n\n    /**\r\n     *  选择每页多少条数\r\n     *  @param { Number } pageSize 每页条数\r\n     */\n    handleSizeChange: function handleSizeChange(pageSize) {\n      this.filtersData.pageSize = pageSize;\n      this.purchasingAgentPriceManagement_list();\n    }\n  },\n  components: {\n    codeSet: codeSet,\n    treeDept: treeDept,\n    PageTable: PageTable\n  }\n};",{"version":3,"sources":["price_list.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <el-dialog width=\"555px\" title=\"添加门店\" :visible.sync=\"dialogTableVisible\">\r\n      <el-form ref=\"ruleForm\" :model=\"addFormData\" :rules=\"rules\" label-width=\"120px\" size=\"small\">\r\n        <el-form-item label=\"门店名称：\" prop=\"purchaseAgentId\">\r\n          <el-select ref=\"storeElement\" :value-key=\"item\" v-model=\"addFormData.purchaseAgentId\" clearable filterable>\r\n              <el-option v-for=\"(item, index) in storeBasic_listForScbPriceManagement_data.data\" :label=\"item.name\" :key=\"index\" :its=\"item\" :value=\"item.id\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"采购折扣：\" prop=\"purchaserDiscountValue\">\r\n          <el-input v-model=\"addFormData.purchaserDiscountValue\" placeholder=\"请填写采购折扣，如：2.4\" class=\"input-w-2\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item class=\"mt-30\">\r\n          <el-button  size=\"small\" @click=\"dialogTableVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"addList\" size=\"small\">确认</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-dialog>\r\n    <div class=\"item-margin\">\r\n      <el-form class=\"item-form\" :model=\"filtersData\" label-width=\"90px\" size=\"small\" ref=\"formData\" inline>\r\n        <el-form-item label=\"门店名称：\">\r\n          <el-select v-model=\"filtersData.purchaseAgentId\" clearable filterable>\r\n              <el-option v-for=\"(item, index) in getStoreList_data.data\" :label=\"item.name\" :key=\"index\" :value=\"item.id\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button @click=\"handleSearch\" type=\"primary\" plain>搜索</el-button>\r\n          <el-button @click=\"handleResetFilters\" plain>重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    <div class=\"box\">\r\n      <el-button size=\"small\" type=\"primary\" @click=\"dialogTableVisible = true\">添加门店</el-button>\r\n      <page-table :form-data=\"filtersData\" :get-data=\"purchasingAgentPriceManagement_list\" :table-data=\"discountData\">\r\n        <el-table\r\n          class=\"mt-20\"\r\n          :data=\"discountData.data\"\r\n          stripe\r\n          empty-text=\"暂无数据\"\r\n          header-align=\"center\"\r\n          header-row-class-name=\"item-table-header\"\r\n          :highlight-current-row=\"true\">\r\n          <el-table-column prop align=\"center\" :show-overflow-tooltip=\"true\" label=\"门店\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.purchaseAgentName }}</template>\r\n          </el-table-column>\r\n          <el-table-column prop align=\"center\" :show-overflow-tooltip=\"true\" label=\"联系人\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.phone }}&nbsp;【{{ scope.row.administrator }}】</template>\r\n          </el-table-column>\r\n          <el-table-column prop align=\"center\" :show-overflow-tooltip=\"true\" label=\"可用余额/冻结余额\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.usableBalance + '/' + scope.row.disableBalance }}</template>\r\n          </el-table-column>\r\n          <el-table-column prop align=\"center\" :show-overflow-tooltip=\"true\" label=\"采购折扣\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.purchaserDiscountValue }}</template>\r\n          </el-table-column>2\r\n          <el-table-column prop align=\"center\" :show-overflow-tooltip=\"true\" label=\"指定折扣商品\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.productSumQty }}款</template>\r\n          </el-table-column>\r\n          <!-- 操作 -->\r\n          <el-table-column\r\n            fixed=\"right\"\r\n            label-class-name=\"text-center\"\r\n            class-name=\"text-center\"\r\n            align=\"center\"\r\n            label=\"操作\"\r\n            width=\"180\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"text\" size=\"small\" @click=\"timeRedact(scope.row)\">修改</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </page-table>\r\n    </div>\r\n  </div>\r\n</template>\r\n<!-- 工单池 -->\r\n<script>\r\nimport axios from \"axios\";\r\nimport { getToken } from \"@/utils/auth\";\r\nimport codeSet from \"@/components/codeSet\";\r\nimport treeDept from \"@/components/treeDept\";\r\nimport { filter } from \"minimatch\";\r\nimport { get } from \"http\";\r\nimport PageTable from \"@/views/collocation/components/PageTable\";\r\n\r\nlet token = getToken();\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      dialogTableVisible:false,\r\n      // 新建商品折扣提交参数\r\n      addFormData:{\r\n        \"administrator\": \"\", // 管理员\r\n        \"merchantId\": \"\", // 商品id\r\n        \"merchantName\": \"\", // 商品名称\r\n        \"phone\": \"\", // 采购商管理员手机号\r\n        \"purchaseAgentId\": \"\", // 采购商id\r\n        \"purchaseAgentName\": \"\", // 采购商名称\r\n        \"purchaserDiscountType\": 1, // 采购商类型（0：满减，1：折扣）；\r\n        \"purchaserDiscountValue\": null, // 采购折扣\r\n      },\r\n      // 折扣列表\r\n      discountData: [],\r\n      data_obj: {},\r\n      // 折扣类型\r\n      discountType: [\"预约折扣\", \"阶梯折扣\", \"单品折扣\"],\r\n      // 门店列表\r\n      storeList: {},\r\n      // 检索\r\n      filtersData: {\r\n        pageIndex: 1, // 当前页码\r\n        pageSize: 10, // 每页数量\r\n        \"orderBy\": \"\",\r\n        purchaseAgentId:null\r\n      },\r\n      // 门店\r\n      getStoreList_data:{},\r\n      // 过滤后的门店\r\n      storeBasic_listForScbPriceManagement_data:{},\r\n      rules: {\r\n        purchaseAgentId: [{ required: true, message: '请选择门店！', trigger: 'change' }], \r\n        purchaserDiscountValue: [{ required: true, message: '请输入正确的折扣数值！', trigger: 'change' }]\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    const that = this;\r\n    // 获取全部门店\r\n    this.getStoreList();\r\n    // 获取过滤后的门店\r\n    this.storeBasic_listForScbPriceManagement();\r\n    this.purchasingAgentPriceManagement_list(); // 获取折扣列表\r\n  },\r\n  methods: {\r\n    /**\r\n     * 新增列表数据\r\n     */\r\n    addList() {\r\n      \r\n      this.$refs.ruleForm.validate((valid) => {\r\n        if (valid) {\r\n          const checkItem = this.storeBasic_listForScbPriceManagement_data.data.find(item => {\r\n            return item.id == this.addFormData.purchaseAgentId;\r\n          }); \r\n\r\n          // return;\r\n          Object.assign(this.addFormData, {\r\n            \"administrator\": checkItem.linkman, // 管理员\r\n            \"phone\": checkItem.phone, // 采购商管理员手机号\r\n            \"purchaseAgentName\": checkItem.name, // 采购商名称\r\n          });\r\n          this.request(\r\n            this.api.scb.purchasingAgentPriceManagement_save,\r\n            this.addFormData\r\n          ).then(res => {\r\n            this.warn('新建成功！');\r\n            this.dialogTableVisible = false;\r\n            this.purchasingAgentPriceManagement_list();\r\n            // 清空新建提交数据\r\n            this.addFormData = {\r\n              \"administrator\": \"\", // 管理员\r\n              \"merchantId\": \"\", // 商品id\r\n              \"merchantName\": \"\", // 商品名称\r\n              \"phone\": \"\", // 采购商管理员手机号\r\n              \"purchaseAgentId\": \"\", // 采购商id\r\n              \"purchaseAgentName\": \"\", // 采购商名称\r\n              \"purchaserDiscountType\": 0, // 采购商类型（0：满减，1：折扣）；\r\n              \"purchaserDiscountValue\": 0, // 采购折扣\r\n            };\r\n          });\r\n        }\r\n      });\r\n     \r\n    },\r\n    /**\r\n     * 查询门店列表\r\n     */\r\n    getStoreList() {\r\n      const that = this;\r\n\r\n      this.request(\r\n      that.api.store.storeBasic_list\r\n      ).then(res => {\r\n        that.getStoreList_data = res;\r\n      });\r\n    },\r\n    /**\r\n     * 查询门店列表\r\n     */\r\n    storeBasic_listForScbPriceManagement() {\r\n      const that = this;\r\n\r\n      this.request(\r\n        that.api.store.storeBasic_listForScbPriceManagement\r\n      ).then(res => {\r\n        that.storeBasic_listForScbPriceManagement_data = res;\r\n      });\r\n    },\r\n    /**\r\n     * 删除折扣\r\n     */\r\n    removeDiscount(item) {\r\n      this.$confirm(\"确定删除吗？\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\"\r\n      })\r\n        .then(() => {\r\n          switch (item.type) {\r\n            case 0:\r\n              this.request(\r\n                this.api.market.marketingMiddleground_deleteDiscountSetting,\r\n                {\r\n                  id: item.discountId\r\n                }\r\n              ).then(res => {\r\n                this.purchasingAgentPriceManagement_list();\r\n                this.warn(\"删除成功!\");\r\n              });\r\n              break;\r\n            case 1:\r\n              this.request(\r\n                this.api.market.marketingMiddleground_deleteDiscountParameterS,\r\n                {\r\n                  id: item.discountId\r\n                }\r\n              ).then(res => {\r\n                this.purchasingAgentPriceManagement_list();\r\n                this.warn(\"删除成功!\");\r\n              });\r\n              break;\r\n            case 2:\r\n              this.request(\r\n                this.api.market\r\n                  .marketingMiddleground_deleteSingleProductDiscount,\r\n                {\r\n                  id: item.discountId\r\n                }\r\n              ).then(res => {\r\n                this.purchasingAgentPriceManagement_list();\r\n                this.warn(\"删除成功!\");\r\n              });\r\n              break;\r\n          }\r\n        })\r\n        .catch(() => {\r\n          this.warn(\"取消删除!\", \"info\");\r\n        });\r\n    },\r\n    /**\r\n     * 提示\r\n     * @param { String } message 提示文案\r\n     * @param { String } type 提示类型\r\n     */\r\n    warn(message, type) {\r\n      this.$message({\r\n        message: message,\r\n        type: type || \"success\"\r\n      });\r\n    },\r\n    /**\r\n     * 编辑\r\n     * @param { Object } item 当前对象\r\n     * @param { Boolean } isRead 是否可对写\r\n     * @property { Boolean }isEcho 是否是编辑\r\n     * @return { Object } Obj 返回对象\r\n     */\r\n    timeRedact(item) {\r\n      var Obj = {};\r\n      this.href(\"scb/price/price_edit\", {\r\n        isEdit: true,\r\n        id: item.id,\r\n      });\r\n    },\r\n    /**\r\n     * 获取折扣列表\r\n     */\r\n    purchasingAgentPriceManagement_list() {\r\n      this.request(\r\n        this.api.scb.purchasingAgentPriceManagement_list,\r\n        this.filtersData\r\n      ).then(res => {\r\n        this.discountData = res;\r\n      });\r\n    },\r\n    /**\r\n     * 跳转工单详情\r\n     */\r\n    href(routeName, param) {\r\n      this.$router.push({\r\n        path: \"/\" + routeName,\r\n        query: param\r\n      });\r\n    },\r\n    /**\r\n     * 模糊搜索\r\n     */\r\n    handleSearch() {\r\n      this.filtersData.pageIndex = 1;\r\n      this.purchasingAgentPriceManagement_list();\r\n    },\r\n    /**\r\n     * 搜索重置\r\n     */\r\n    handleResetFilters() {\r\n      Object.assign(this.filtersData, {\r\n        pageIndex: 1, // 当前页码\r\n        pageSize: 10, // 每页数量\r\n        \"orderBy\": \"\",\r\n        purchaseAgentId:null\r\n      });\r\n    },\r\n    /**\r\n     * 点击页数\r\n     * @param { Number } pageIndex 当前页\r\n     */\r\n    handleCurrentChange(pageIndex) {\r\n      this.filtersData.pageIndex = pageIndex;\r\n      this.purchasingAgentPriceManagement_list();\r\n    },\r\n    /**\r\n     *  选择每页多少条数\r\n     *  @param { Number } pageSize 每页条数\r\n     */\r\n    handleSizeChange(pageSize) {\r\n      this.filtersData.pageSize = pageSize;\r\n      this.purchasingAgentPriceManagement_list();\r\n    }\r\n  },\r\n  components: {\r\n    codeSet,\r\n    treeDept,\r\n    PageTable\r\n  }\r\n};\r\n</script>\r\n<style  lang=\"less\" scoped>\r\n.previewVisible-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  .item {\r\n    width: 50%;\r\n    margin-right: 0;\r\n    text-align: right;\r\n  }\r\n}\r\n.blueness {\r\n  color: #1e90ff;\r\n}\r\nh5 {\r\n  color: #222;\r\n  margin-left: -15px;\r\n}\r\n.test {\r\n  color: #9d9d9d;\r\n}\r\n.box {\r\n  padding: 20px 20px 20px 20px;\r\n  margin: 8px 8px 20px 8px;\r\n  background: #fff;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/scb/price"}]}