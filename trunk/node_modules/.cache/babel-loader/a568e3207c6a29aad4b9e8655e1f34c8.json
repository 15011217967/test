{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\product\\video\\channel_details.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\product\\video\\channel_details.vue","mtime":1572415124002},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _toConsumableArray from \"C:\\\\Users\\\\EDZ\\\\Desktop\\\\\\u7814\\u53D1\\u9879\\u76EE\\\\vue-project\\\\trunk\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.regexp.to-string\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport ElUploadImg from \"@/components/uploadImg/el_upload_img\"; //匹配标签\n\nimport TagMatching from \"../components/tagMatching.vue\";\n/**\r\n * 规格详情页面 新增 修改 查看 同一页面\r\n */\n\nexport default {\n  data: function data() {\n    return {\n      filtersData: {\n        logo: \"\",\n        name: \"\",\n        description: \"\",\n        videoChannelTags: []\n      },\n      productImages: [],\n      cateArr: [],\n      rules: {\n        name: [{\n          required: true,\n          message: \"请输入频道名称\",\n          trigger: \"blur\"\n        }, {\n          max: 12,\n          message: \"不超过12个字符\",\n          trigger: \"blur\"\n        }]\n      },\n      editDisabled: false,\n      showDisabled: false,\n      _type: \"\",\n      _id: \"\",\n      videoChannelTags: [] //标签子组件返回的数据\n\n    };\n  },\n  created: function created() {\n    //获取上页面传参\n    this.getQueryparams(); //尺码属性\n  },\n  methods: {\n    //获取上页面参数\n    getQueryparams: function getQueryparams() {\n      //console.log(this.$route.query.id);\n      this._type = this.$route.query.type;\n      this._id = this.$route.query.id;\n      var itemStatus = this._type;\n\n      switch (itemStatus.toString()) {\n        case \"add\":\n          //新增\n          this.editDisabled = false;\n          this.showDisabled = false;\n          break;\n\n        case \"edit\":\n          //修改\n          this.editDisabled = true;\n          this.showDisabled = false;\n          this.getData();\n          break;\n\n        case \"show\":\n          //查看\n          this.editDisabled = true;\n          this.showDisabled = true;\n          this.getData();\n          break;\n      }\n    },\n    //获取数据\n    getData: function getData() {\n      var _this = this;\n\n      this.request(this.api.product.videoChannel_get, {\n        id: this._id\n      }).then(function (res) {\n        var _data = res;\n        console.log(_data);\n        _this.filtersData = _data; //处理Tags 抽出tagId传入子组件\n\n        var tags = _data.videoChannelTags;\n        var allIds = [];\n\n        for (var i = 0; i < tags.length; i++) {\n          allIds.push({\n            tagId: tags[i].tagId\n          });\n        }\n\n        _this.$refs.tagRef.propInit(_this.$common.deepCopy(allIds));\n\n        if (!!_data.logo) {\n          _this.productImages = [{\n            url: _data.logo\n          }];\n        }\n      });\n    },\n    //新增\n    submitForm: function submitForm(formName) {\n      var _this2 = this;\n\n      console.log(this.filtersData);\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          if (_this2._type == \"edit\") {\n            _this2.editHandleTags();\n          } else if (_this2._type == \"add\") {\n            var tags = _this2.$common.deepCopy(_this2.videoChannelTags);\n\n            _this2.addHandleTags(tags);\n          }\n\n          _this2.request(_this2.api.product.videoChannel_save, _this2.filtersData).then(function (data) {\n            _this2.$message.success(\"保存成功\");\n\n            setTimeout(function () {\n              _this2.routerback();\n            }, 500);\n          });\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    //修改时处理\n    editHandleTags: function editHandleTags() {\n      var videoChannelTags = this.$common.deepCopy(this.filtersData.videoChannelTags) || [];\n      var tags = this.$common.deepCopy(this.videoChannelTags);\n      var deleteTags = [];\n\n      for (var i = 0; i < videoChannelTags.length; i++) {\n        var flag = false;\n\n        for (var k = 0; k < tags.length; k++) {\n          if (videoChannelTags[i].tagId == tags[k].tagId) {\n            flag = true;\n            tags[k] = videoChannelTags[i];\n            break;\n          }\n        }\n\n        if (!flag) {\n          videoChannelTags[i].status = 9;\n          deleteTags.push(videoChannelTags[i]);\n        }\n      }\n\n      var DoneVideoChannelTags = [].concat(deleteTags, _toConsumableArray(tags));\n      this.addHandleTags(DoneVideoChannelTags);\n    },\n    //新增时处理tag标签\n    addHandleTags: function addHandleTags() {\n      var tags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var _name = this.filtersData.name;\n\n      for (var i = 0; i < tags.length; i++) {\n        tags[i].channelName = _name;\n      }\n\n      this.filtersData.videoChannelTags = tags;\n    },\n    //后退\n    routerback: function routerback() {\n      this.$router.go(-1);\n    }\n  },\n  components: {\n    ElUploadImg: ElUploadImg,\n    TagMatching: TagMatching\n  }\n};",{"version":3,"sources":["channel_details.vue"],"names":[],"mappings":"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","sourcesContent":["<!--\r\n * @Description:频道详情\r\n * @Author: elephant\r\n * @Date: 2019-08-13 18:05:11\r\n * @LastEditTime: 2019-08-16 14:55:39\r\n * @LastEditors:1、2期商品新增功能\r\n -->\r\n<template>\r\n  <div class=\"bg-fff item-margin\">\r\n    <el-form\r\n      class=\"item-form\"\r\n      :rules=\"rules\"\r\n      :model=\"filtersData\"\r\n      label-width=\"100px\"\r\n      size=\"small\"\r\n      ref=\"filtersForm\"\r\n      inline\r\n    >\r\n      <el-row>\r\n        <h5 class=\"item-title\">基本信息</h5>\r\n        <el-col :span=\"24\">\r\n          <el-form-item prop=\"name\" label=\"频道名称：\">\r\n            <el-input\r\n              class=\"input-w-2\"\r\n              placeholder=\"请输入内容\"\r\n              :disabled=\"editDisabled\"\r\n              v-model=\"filtersData.name\"\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"24\">\r\n          <el-form-item prop=\"logo\" label=\"频道图标：\">\r\n            <el-upload-img\r\n            :disabled=\"showDisabled\"\r\n              v-model=\"filtersData.logo\"\r\n              :EchoDisplayImages=\"productImages\"\r\n              CatalogName=\"product\"\r\n            ></el-upload-img>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"24\">\r\n          <el-form-item prop=\"description\" label=\"备注：\">\r\n            <el-input\r\n              type=\"textarea\"\r\n              class=\"input-w-2\"\r\n              :rows=\"2\"\r\n              :disabled=\"showDisabled\"\r\n              placeholder=\"请输入内容\"\r\n              v-model=\"filtersData.description\"\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <h5 class=\"item-title\">关联标签</h5>\r\n        <el-col :span=\"24\">\r\n          <tag-matching v-model=\"videoChannelTags\" ref=\"tagRef\"></tag-matching>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n    <div class=\"item-footer\">\r\n      <el-button\r\n        v-if=\"this._type == 'add'\"\r\n        size=\"small\"\r\n        @click=\"submitForm('filtersForm')\"\r\n        type=\"primary\"\r\n      >确定</el-button>\r\n      <el-button\r\n        v-else-if=\"this._type == 'edit'\"\r\n        size=\"small\"\r\n        @click=\"submitForm('filtersForm')\"\r\n        type=\"primary\"\r\n      >修改</el-button>\r\n      <el-button size=\"small\" @click=\"routerback('filtersForm')\">取消</el-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport ElUploadImg from \"@/components/uploadImg/el_upload_img\";\r\n//匹配标签\r\nimport TagMatching from \"../components/tagMatching.vue\";\r\n/**\r\n * 规格详情页面 新增 修改 查看 同一页面\r\n */\r\nexport default {\r\n  data() {\r\n    return {\r\n      filtersData: {\r\n        logo: \"\",\r\n        name: \"\",\r\n        description: \"\",\r\n        videoChannelTags: []\r\n      },\r\n      productImages: [],\r\n      cateArr: [],\r\n      rules: {\r\n        name: [\r\n          { required: true, message: \"请输入频道名称\", trigger: \"blur\" },\r\n          { max: 12, message: \"不超过12个字符\", trigger: \"blur\" }\r\n        ]\r\n      },\r\n      editDisabled: false,\r\n      showDisabled: false,\r\n      _type: \"\",\r\n      _id: \"\",\r\n      videoChannelTags: [] //标签子组件返回的数据\r\n    };\r\n  },\r\n  created() {\r\n    //获取上页面传参\r\n    this.getQueryparams();\r\n    //尺码属性\r\n  },\r\n  methods: {\r\n    //获取上页面参数\r\n    getQueryparams() {\r\n      //console.log(this.$route.query.id);\r\n      this._type = this.$route.query.type;\r\n      this._id = this.$route.query.id;\r\n      let itemStatus = this._type;\r\n      switch (itemStatus.toString()) {\r\n        case \"add\": //新增\r\n          this.editDisabled = false;\r\n          this.showDisabled = false;\r\n          break;\r\n        case \"edit\": //修改\r\n          this.editDisabled = true;\r\n          this.showDisabled = false;\r\n          this.getData();\r\n          break;\r\n        case \"show\": //查看\r\n          this.editDisabled = true;\r\n          this.showDisabled = true;\r\n          this.getData();\r\n          break;\r\n      }\r\n    },\r\n    //获取数据\r\n    getData() {\r\n      this.request(this.api.product.videoChannel_get, {\r\n        id: this._id\r\n      }).then(res => {\r\n        let _data = res;\r\n        console.log(_data);\r\n        \r\n        this.filtersData = _data;\r\n        //处理Tags 抽出tagId传入子组件\r\n        let tags = _data.videoChannelTags;\r\n        let allIds = [];\r\n        for (let i = 0; i < tags.length; i++) {\r\n          allIds.push({ tagId: tags[i].tagId });\r\n        }\r\n        this.$refs.tagRef.propInit(this.$common.deepCopy(allIds));\r\n        if (!!_data.logo) {\r\n          this.productImages = [{ url: _data.logo }];\r\n        }\r\n      });\r\n    },\r\n    //新增\r\n    submitForm(formName) {\r\n      console.log(this.filtersData);\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          if (this._type == \"edit\") {\r\n            this.editHandleTags();\r\n          } else if (this._type == \"add\") {\r\n            let tags = this.$common.deepCopy(this.videoChannelTags);\r\n            this.addHandleTags(tags);\r\n          }\r\n          this.request(\r\n            this.api.product.videoChannel_save,\r\n            this.filtersData\r\n          ).then(data => {\r\n            this.$message.success(\"保存成功\");\r\n            setTimeout(() => {\r\n              this.routerback();\r\n            }, 500);\r\n          });\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //修改时处理\r\n    editHandleTags() {\r\n      let videoChannelTags =\r\n        this.$common.deepCopy(this.filtersData.videoChannelTags) || [];\r\n      let tags = this.$common.deepCopy(this.videoChannelTags);\r\n      let deleteTags = [];\r\n      for (let i = 0; i < videoChannelTags.length; i++) {\r\n        let flag = false;\r\n        for (let k = 0; k < tags.length; k++) {\r\n          if (videoChannelTags[i].tagId == tags[k].tagId) {\r\n            flag = true;\r\n            tags[k] = videoChannelTags[i];\r\n            break;\r\n          }\r\n        }\r\n        if (!flag) {\r\n          videoChannelTags[i].status = 9;\r\n          deleteTags.push(videoChannelTags[i]);\r\n        }\r\n      }\r\n      let DoneVideoChannelTags = [...deleteTags, ...tags];\r\n      this.addHandleTags(DoneVideoChannelTags);\r\n    },\r\n    //新增时处理tag标签\r\n    addHandleTags(tags = []) {\r\n      let _name = this.filtersData.name;\r\n      for (let i = 0; i < tags.length; i++) {\r\n        tags[i].channelName = _name;\r\n      }\r\n      this.filtersData.videoChannelTags = tags;\r\n    },\r\n    //后退\r\n    routerback() {\r\n      this.$router.go(-1);\r\n    }\r\n  },\r\n  components: {\r\n    ElUploadImg,\r\n    TagMatching\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.item-title {\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/product/video"}]}