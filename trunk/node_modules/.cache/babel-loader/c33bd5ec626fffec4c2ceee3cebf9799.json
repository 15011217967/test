{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\workorder\\category\\workOrder_detail_dispose.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\workorder\\category\\workOrder_detail_dispose.vue","mtime":1574160264992},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import _objectSpread from \"C:\\\\Users\\\\EDZ\\\\Desktop\\\\\\u7814\\u53D1\\u9879\\u76EE\\\\vue-project\\\\trunk\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport { getToken } from \"@/utils/auth\";\nimport codeSet from \"@/components/codeSet\";\nimport treeDept from \"@/components/treeDept\";\nimport { filter } from \"minimatch\";\nimport { get } from \"http\";\nimport { mapGetters } from 'vuex';\nimport * as userTypes from \"@/types/userConfig\";\nvar token = getToken();\nexport default {\n  data: function data() {\n    return {\n      // 是否只读写\n      isRead: false,\n      // 量体信息\n      getDataByReservationObj: {},\n      isCorrelationDataShow: false,\n      historyWorkOrderGetByNumObj: {},\n      workOrderLog_list: {},\n      tableItemGetListMapObj: {},\n      consumerCustomizedOrder_obj: {},\n      // 处理结果字段list\n      listByWorkOrderCode: [],\n      // 处理结果字段对应名称\n      tableData_backups: {},\n      // 一对多字段集合\n      subObj: {},\n      // 物流列表\n      express_list: [],\n      // 供应商编码\n      tableListData: [],\n      // 添加进程是否显示\n      isAddCourse: this.$route.query.isAddCourse,\n      value: '请选择',\n      value2: '请选择',\n      isConsumer: false,\n      jobOrderStatus: {\n        \"0\": \"未处理\",\n        \"1\": \"处理中\",\n        \"2\": \"已处理\"\n      },\n      priority: {\n        \"01\": \"高\",\n        \"02\": \"中\",\n        \"03\": \"低\"\n      },\n      // 供应商请求数据\n      filtersData: {\n        \"pageIndex\": 1,\n        \"pageSize\": 10,\n        \"cooperation\": null,\n        \"searchWords\": \"\"\n      },\n      storageValArr: [],\n      formInline: {},\n      active: 1,\n      reverse: true\n    };\n  },\n  created: function created() {\n    this.isRead = this.$route.query.isRead;\n    console.log(this.$route);\n    this.getHistoryWorkOrderGetByNum(this.$route.query.number);\n    this.getWorkOrderLog_list(this.$route.query.number);\n    this.tableItemListByWorkOrderCode(this.$route.query.sourceChileType, this.$route.query.sourceId);\n    this.expressCompany_list(); // 获取所有快递公司代码、\n\n    this.getTableList(); // 获取供应商列表\n  },\n  methods: {\n    /**\n     * 获取所有快递公司代码\n     */\n    expressCompany_list: function expressCompany_list() {\n      var _this = this;\n\n      var that = this;\n      this.request(this.api.order.expressCompany_list, {\n        \"pageIndex\": \"\",\n        \"pageSize\": \"\",\n        \"fuzzyQuery\": \"\"\n      }).then(function (res) {\n        _this.express_list = res.data;\n      });\n    },\n\n    /**\n     * 获取供应商列表\n     */\n    getTableList: function getTableList() {\n      var _this2 = this;\n\n      this.request(this.api.product.supplier_list, this.filtersData).then(function (res) {\n        _this2.tableListData = res.data;\n      });\n    },\n\n    /**\n     * 获取定制订单信息\n     */\n    consumerCustomizedOrder_get: function consumerCustomizedOrder_get(orderId) {\n      var _this3 = this;\n\n      this.request(this.api.order.consumerCustomizedOrder_get, {\n        // orderId: \"83e785b5-89fd-49eb-a6a5-5e3e76c9bf3f\"\n        orderId: orderId\n      }).then(function (res) {\n        res.consumerCustomizedGoodsVOList.forEach(function (item, index) {\n          item.isChecked = false;\n          item.craft = []; // 工艺\n\n          item.material = []; // 原料\n\n          item.productGoodsMaterials.forEach(function (items, indexs) {\n            if (items.type == 1) {\n              item.craft.push(items);\n            } else {\n              item.material.push(items);\n            }\n          });\n        });\n        _this3.consumerCustomizedOrder_obj = res;\n      });\n    },\n\n    /**\n     * 获取量体信息\n     * @param { String } reservationOrderId 定制订单id\n     */\n    reservationOrderMeasurement_getDataByReservationOrderId: function reservationOrderMeasurement_getDataByReservationOrderId(reservationOrderId) {\n      var _this4 = this;\n\n      this.request(this.api.order.reservationOrderMeasurement_getDataByReservationOrderId, {\n        reservationOrderId: reservationOrderId\n      }).then(function (res) {\n        _this4.getDataByReservationObj = res;\n      });\n    },\n\n    /**\n     * 判断处理字段是否为空，为空不可提交\n     */\n    waitWorkOrderSubHandle: function waitWorkOrderSubHandle() {\n      var _this5 = this;\n\n      var saveListByWorkOrderCodeObj = {},\n          hObj = this.historyWorkOrderGetByNumObj; // 判断字段不可为空提交\n\n      for (var i = 0; i < this.listByWorkOrderCode.length; i++) {\n        var item = this.listByWorkOrderCode[i]; // 一对一，（一对一和一对多依赖的数据结构不同）\n\n        if (item.linkType == 1) {\n          for (var j = 0; j < item.sublist.length; j++) {\n            var _items = item.sublist[j]; // 必须是可读写的\n\n            if (_items.isRead == 1) {\n              // tableData中对应的值不可为空\n              if (!item.tableData[_items.itemCode]) {\n                this.warn(\"\".concat(_items.itemName, \"\\u4E0D\\u80FD\\u4E3A\\u7A7A\\uFF01\"), 'success');\n                _items.isNull = true;\n                return;\n              } else {\n                _items.isNull = false;\n              }\n            }\n\n            ;\n          } // 一对多\n\n        } else {\n          // tableDataList如果为空直接跳过判断\n          if (item.tableDataList.length > 0) {\n            // 遍历一对多的各项，找对对应的值与上面sublist做比较\n            for (var j = 0; j < item.tableDataList.length; j++) {\n              var items = item.tableDataList[j];\n\n              for (var name in items) {\n                if (!items[name]) {\n                  var findElement = item.sublist.find(function (findItem, findIndex) {\n                    return findItem.visible != false && findItem.itemCode == name && findItem.isRead;\n                  });\n\n                  if (findElement) {\n                    this.warn(\"\".concat(findElement.itemName, \"\\u4E0D\\u80FD\\u4E3A\\u7A7A\\uFF01\"), 'success');\n                    return;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        ;\n      }\n\n      Object.assign(saveListByWorkOrderCodeObj, {\n        itemResultList: this.listByWorkOrderCode,\n        number: hObj.number,\n        id: this.$route.query.id,\n        taskId: hObj.taskId,\n        remarks: hObj.remarks,\n        sourceId: hObj.sourceId,\n        sourceChileType: hObj.sourceChileType,\n        procInstId: this.$route.query.procInstId,\n        assignee: this.userInfo.name,\n        assigneeId: this.userInfo.userId\n      }); // return;\n\n      this.request(this.api.job_order.waitWorkOrderSubHandle, saveListByWorkOrderCodeObj).then(function (res) {\n        _this5.warn('提交成功！', 'success');\n\n        _this5.href('workorder/category/workOrder_pending_list');\n      });\n    },\n\n    /**\n     * 保存工单字段\n     */\n    waitWorkOrderSaveHandle: function waitWorkOrderSaveHandle() {\n      var saveListByWorkOrderCodeObj = {},\n          hObj = this.historyWorkOrderGetByNumObj,\n          that = this;\n      Object.assign(saveListByWorkOrderCodeObj, {\n        itemResultList: this.listByWorkOrderCode,\n        number: hObj.number,\n        id: this.$route.query.id,\n        taskId: hObj.taskId,\n        remarks: hObj.remarks,\n        sourceId: hObj.sourceId\n      });\n      this.request(this.api.job_order.waitWorkOrderSaveHandle, saveListByWorkOrderCodeObj).then(function (res) {\n        that.warn('保存成功！', 'success');\n        that.href('workorder/category/workOrder_pending_list');\n      });\n    },\n\n    /**\n     * 跳转工单详情\n     */\n    href: function href(routeName, param) {\n      this.$router.push({\n        path: '/' + routeName,\n        query: param\n      });\n    },\n\n    /**\n     * 根据源单获取所有子表数据项\n     */\n    tableItemListByWorkOrderCode: function tableItemListByWorkOrderCode(sourceChileType, sourceId) {\n      var that = this;\n      this.request(that.api.job_order.tableItemListByWorkOrderCode, {\n        code: sourceChileType,\n        sourceId: sourceId\n      }).then(function (res) {\n        // 整理一对多字段集合\n        res.forEach(function (item, index) {\n          item.sublist.forEach(function (items, indexs) {\n            items.isNull = false;\n          });\n        });\n        that.listByWorkOrderCode = res;\n        console.log(that.subObj);\n      });\n    },\n\n    /**\n     * 获取工单池详情基本信息\n     */\n    getHistoryWorkOrderGetByNum: function getHistoryWorkOrderGetByNum(number) {\n      var _this6 = this;\n\n      var that = this;\n      this.request(that.api.job_order.getHistoryWorkOrderGetByNum, {\n        number: number\n      }).then(function (res) {\n        var createTime = new Date(res.createTime).getTime();\n\n        var _createTime = new Date().getTime();\n\n        that.historyWorkOrderGetByNumObj = res;\n        that.active = res.jobOrderStatus + 1;\n        that.historyWorkOrderGetByNumObj._createTime = _this6.formatDuring(_createTime - createTime);\n\n        if (that.historyWorkOrderGetByNumObj.sourceChileType == 'measuringWorkOrder') {\n          _this6.reservationOrderMeasurement_getDataByReservationOrderId(_this6.$route.query.sourceId); // 获取量体信息\n\n        }\n\n        if (that.historyWorkOrderGetByNumObj.sourceChileType == 'consumerCustomizedOrder') {\n          _this6.consumerCustomizedOrder_get(_this6.$route.query.sourceId); // 获取定制信息\n\n        }\n      });\n    },\n\n    /**\n     *\n     */\n    formatDuring: function formatDuring(mss) {\n      var days = parseInt(mss / (1000 * 60 * 60 * 24));\n      var hours = parseInt(mss % (1000 * 60 * 60 * 24) / (1000 * 60 * 60));\n      var minutes = parseInt(mss % (1000 * 60 * 60) / (1000 * 60));\n      var seconds = mss % (1000 * 60) / 1000;\n      return \"\".concat(days, \"\\u5929\").concat(hours, \"\\u65F6\").concat(minutes, \"\\u5206\");\n    },\n\n    /**\n    * 提示\n    */\n    warn: function warn(message, type) {\n      this.$message({\n        message: message,\n        type: type || 'warning'\n      });\n    },\n\n    /**\n     * 获取工单跟进记录列表\n     */\n    getWorkOrderLog_list: function getWorkOrderLog_list(number) {\n      var that = this;\n      this.request(that.api.job_order.getWorkOrderLog_list, {\n        number: number\n      }).then(function (res) {\n        that.workOrderLog_list = res.data.reverse();\n      });\n    },\n\n    /**\n     * 添加一条跟进记录\n     */\n    addHistoryWorkOrderFollowUp: function addHistoryWorkOrderFollowUp() {\n      var _this7 = this;\n\n      var that = this;\n      console.log(this.historyWorkOrderGetByNumObj);\n      this.request(that.api.job_order.addHistoryWorkOrderFollowUp, Object.assign(this.historyWorkOrderGetByNumObj, {\n        updateName: this.userInfo.loginName\n      })).then(function (res) {\n        _this7.warn('添加成功！', 'success');\n\n        _this7.getWorkOrderLog_list(_this7.$route.query.number);\n      });\n    },\n    open: function open() {\n      var _this8 = this;\n\n      this.$prompt(\"添加一条跟进记录\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\"\n      }).then(function (_ref) {\n        var value = _ref.value;\n        if (!value) return;\n        _this8.historyWorkOrderGetByNumObj.remarks = value;\n\n        _this8.addHistoryWorkOrderFollowUp();\n      });\n    }\n  },\n  computed: _objectSpread({}, mapGetters({\n    userInfo: userTypes.GETTER_USERINFO\n  })),\n  components: {\n    codeSet: codeSet,\n    treeDept: treeDept\n  }\n};",{"version":3,"sources":["workOrder_detail_dispose.vue"],"names":[],"mappings":"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","sourcesContent":["<!-- 工单池 -->\r\n<template>\r\n  <div>\r\n    <div class=\"item-margin\">\r\n      <div class=\"item-form\">\r\n        <!-- 工单基本信息 -->\r\n        <div class=\"work-order-info\">\r\n          <span>\r\n            工单基本信息：\r\n            <el-button type=\"primary\" size=\"mini\" disabled>{{ jobOrderStatus[historyWorkOrderGetByNumObj.jobOrderStatus] }}</el-button>\r\n          </span>\r\n          <span>累计耗时：{{ historyWorkOrderGetByNumObj._createTime }}</span>\r\n        </div>\r\n        <ul class=\"info-list\">\r\n          <li>工单名称：{{ historyWorkOrderGetByNumObj.name }}</li>\r\n          <li>业务类型：{{ \"CEN012\"| codeToName(historyWorkOrderGetByNumObj.businessType) }}</li>\r\n          <li>服务类型：{{ \"CEN013\"| codeToName(historyWorkOrderGetByNumObj.serviceType) }}</li>\r\n          <li>优先级：{{ priority[historyWorkOrderGetByNumObj.priority] }}</li>\r\n          <li>创建时间：{{ historyWorkOrderGetByNumObj.createTime | timestampToTime  }}</li>\r\n          <li v-if=\"historyWorkOrderGetByNumObj.assignee\">接单人：{{ historyWorkOrderGetByNumObj.assignee }}</li>\r\n          <br/>\r\n        </ul>\r\n          <p class=\"correlationData-p\" v-if=\"historyWorkOrderGetByNumObj.sourceChileType == 'measuringWorkOrder'\">\r\n            关联数据：\r\n            <el-button size=\"small\" type=\"primary\" @click=\"isCorrelationDataShow = !isCorrelationDataShow\">\r\n              查看量体工单\r\n              <i class=\"el-icon-arrow-down el-icon--right\" :class=\"{'el-icon-arrow-up':false}\"></i>\r\n            </el-button>\r\n          </p>\r\n          <p class=\"correlationData-p\" v-if=\"historyWorkOrderGetByNumObj.sourceChileType == 'consumerCustomizedOrder'\">\r\n            关联订单：\r\n            <el-button size=\"small\" type=\"primary\" @click=\"isConsumer = !isConsumer\">\r\n              查看定制订单\r\n              <i class=\"el-icon-arrow-down el-icon--right\" :class=\"{'el-icon-arrow-up':false}\"></i>\r\n            </el-button>\r\n          </p>\r\n          <!-- 定制 -->\r\n          <!-- <section> -->\r\n          <section v-if=\"isConsumer\">\r\n            <ul  class=\"spu\">\r\n              <li>\r\n                <div class=\"spu-border\">\r\n                  <span>定制清单</span>\r\n                  <span>图片</span>\r\n                  <span>数量</span>\r\n                  <span>销售单价</span>\r\n                  <span>备注</span>\r\n                  <span>累计金额</span>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n            <ul class=\"spu\">\r\n              <!-- 一级spu -->\r\n              <li v-for=\"(item, index) in consumerCustomizedOrder_obj.consumerCustomizedGoodsVOList\" :key=\"index\">\r\n                <div>\r\n                  <!-- spu名称 -->\r\n                  <span class=\"text-left text-indent15\" @click=\"item.isChecked = !item.isChecked\">\r\n                    <i :class=\"['el-icon-arrow-down',{'el-icon-arrow-up':item.isChecked}]\"></i>&nbsp;{{ item.customizedProductName }}\r\n                  </span>\r\n                  <!-- spu图片 -->\r\n                  <span>\r\n                    <img :src=\"item.image\" alt>\r\n                  </span>\r\n                  <!-- 数量 -->\r\n                  <span>{{ item.quantity || '--' }}</span>\r\n                  <!-- 销售单价 -->\r\n                  <span>{{ item.price }}</span>\r\n                  <!-- 备注 -->\r\n                  <span>{{ item.remarks || '--' }}</span>\r\n                  <!-- 累计金额 -->\r\n                  <span>--</span>\r\n                </div>\r\n                <!-- 二级sku -->\r\n                <ul class=\"spu\" v-if=\"item.isChecked\">\r\n                  <li>\r\n                    <div>\r\n                      <span  class=\"text-left text-indent45\">原料</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                    </div>\r\n                    <!-- 三级原料 -->\r\n                    <ul class=\"spu\">\r\n                      <li  v-for=\"(items, indexs) in item.material\" :key=\"indexs\">\r\n                        <div>\r\n                          <span  class=\"text-left text-indent75\">{{ items.name }}</span>\r\n                          <span><img :src=\"items.image\" alt></span>\r\n                          <span>{{ items.usageAmount || '--' }}</span>\r\n                          <span>{{ items.unitPrice || '--' }}</span>\r\n                          <span>{{ items.remarks || '--' }}</span>\r\n                          <span>{{ items.usageAmount*items.unitPrice || '--' }}</span>\r\n                        </div>\r\n                      </li>\r\n                    </ul>\r\n                  </li>\r\n                  <li>\r\n                    <div>\r\n                      <span style=\"background:#fff;\"  class=\"text-left text-indent45\">工艺 </span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                    </div>\r\n                    <!-- 三级原料 -->\r\n                    <ul class=\"spu\">\r\n                      <li  v-for=\"(items, indexs) in item.craft\" :key=\"indexs\">\r\n                        <div>\r\n                          <span class=\"text-left text-indent75\">{{ items.name }}</span>\r\n                          <span><img :src=\"items.image\" alt></span>\r\n                          <span>{{ items.usageAmount || '--' }}</span>\r\n                          <span>{{ items.unitPrice || '--' }}</span>\r\n                          <span>{{ items.remarks || '--' }}</span>\r\n                          <span>{{ items.usageAmount*items.unitPrice || '--' }}</span>\r\n                        </div>\r\n                      </li>\r\n                    </ul>\r\n                  </li>\r\n                </ul>\r\n                <!-- 二级sku -->\r\n              </li>\r\n              <!-- 一级spu -->\r\n          </ul>\r\n          </section>\r\n        <!-- 定制 -->\r\n        <div class=\"correlationData mt-20\" v-if=\"isCorrelationDataShow\">\r\n          <section>\r\n            <h6 class=\"mt-10\">量体信息</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.measureData\" :key=\"item\">{{ item.name }}：{{ item.value }} CM</li>\r\n            </ul>\r\n          </section>\r\n          <section>\r\n            <h6 class=\"mt-10\">体型特征</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.bodyFeature\" :key=\"item\">{{ item.name }}：{{ item.value }}</li>\r\n            </ul>\r\n          </section>\r\n          <section>\r\n            <h6 class=\"mt-10\">体型实拍</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.bodyPicture\" :key=\"item\">\r\n                <img :src=\"item.value\" alt=\"\">\r\n                <span>{{ item.name }}</span>\r\n              </li>\r\n            </ul>\r\n          </section>\r\n        </div>\r\n        <p class=\"correlationData-p\" v-if=\"isCorrelationDataShow\">\r\n        </p>\r\n        <div class=\"work-order-info mt-25\">\r\n          <span>工单处理结果：</span>\r\n        </div>\r\n        <el-form class=\"item-form\" size=\"small\" :inline=\"true\">\r\n          <template>\r\n            <div v-for=\"(item, index) in listByWorkOrderCode\" :key=\"index\">\r\n              <span class=\"s\">{{ item.tableCn }}</span>\r\n              <br/>\r\n              <!-- 一对一 -->\r\n              <section :class=\"['the-results',{'the-results-three-rows':historyWorkOrderGetByNumObj.layout != '01'}]\">\r\n                <span class=\"the-results-span\" v-if=\"item.linkType == 1\" v-for=\"(items, indexs) in item.sublist\" :key=\"indexs\">\r\n                  <!-- 时间字段 -->\r\n                  <template v-if=\"items.jdbcType == 'timestamp' || items.jdbcType == 'date'\">\r\n                    <i v-if=\"items.isNull\" class=\"isNull\">*</i>\r\n                    <el-form-item :label=\"items.itemName\">\r\n                      <el-date-picker  style=\"width:190px;\"  type=\"datetime\" value-format=\"yyyy-MM-dd HH:mm:ss\" :disabled=\"isRead || !items.isRead\" v-model=\"item.tableData[items.itemCode]\" placeholder=\"请选择\"></el-date-picker>\r\n                    </el-form-item>\r\n                  </template>\r\n                  <!-- 图片 -->\r\n                  <template v-else-if=\"items.jdbcType == 'image'\">\r\n                    <i v-if=\"items.isNull\" class=\"isNull\">*</i>\r\n                    <el-form-item :label=\"items.itemName\">\r\n                      <img :src=\"item.tableData[items.itemCode]\" alt=\"\" class=\"jdbcType-image\">\r\n                    </el-form-item>\r\n                  </template>\r\n                  <!-- 普通字段 -->\r\n                  <template v-else>\r\n                    <i v-if=\"items.isNull\" class=\"isNull\">*</i>\r\n                    <el-form-item\r\n                      v-if=\"items.visible\"\r\n                      :label=\"items.itemName\">\r\n                      <el-input style=\"width:190px;\" v-if=\"items.itemName != '供应商'\" :disabled=\"isRead || !items.isRead\" v-model=\"item.tableData[items.itemCode]\" placeholder=\"--\"></el-input>\r\n                      <!-- 供应商字段 -->\r\n                      <el-select :disabled=\"isRead || !items.isRead\" v-model=\"item.tableData[items.itemCode]\" clearable=\"true\" filterable  placeholder=\"请选择\" v-else>\r\n                        <el-option\r\n                          v-for=\"item in tableListData\"\r\n                          :key=\"item.id\"\r\n                          :label=\"item.name\"\r\n                          :value=\"item.id\">\r\n                        </el-option>\r\n                      </el-select>\r\n                    </el-form-item>\r\n                  </template>\r\n                  <!-- 普通字段 -->\r\n                </span>\r\n              </section>\r\n              <!-- 一对多 -->\r\n              <el-table\r\n                :data=\"item.tableDataList\"\r\n                v-if=\"item.linkType == 2\"\r\n                border\r\n                stripe\r\n                style=\"width:1500px;\"\r\n                empty-text=\"暂无数据\"\r\n                header-align=\"center\"\r\n                header-row-class-name=\"item-table-header\"\r\n                :highlight-current-row=\"true\">\r\n                <el-table-column v-if=\"items.visible\" max-width=\"350\" :label=\"items.itemName\" :key=\"names\" v-for=\"(items, names) in item.sublist\">\r\n                  <template slot-scope=\"scope\">\r\n                    <!-- 时间字段 -->\r\n                    <template v-if=\"items.jdbcType == 'timestamp' || items.jdbcType == 'date'\">\r\n                      <el-date-picker type=\"datetime\"  :disabled=\"isRead || !items.isRead\" v-model=\"scope.row[items.itemCode]\" placeholder=\"开始日期\"></el-date-picker>\r\n                    </template>\r\n                    <!-- 图片 -->\r\n                    <template v-else-if=\"items.jdbcType == 'image'\">\r\n                      <img :src=\"scope.row[items.itemCode]\" alt=\"\" class=\"subImg\">\r\n                    </template>\r\n                    <!-- select下拉列表 -->\r\n                    <template v-else-if=\"items.jdbcType == 'select'\">\r\n                      <el-select :disabled=\"isRead || !items.isRead\" v-model=\"scope.row[items.itemCode]\" clearable=\"true\" filterable  placeholder=\"请选择\" v-if=\"items.itemName == '物流公司'\">\r\n                        <el-option\r\n                          v-for=\"item in express_list\"\r\n                          :key=\"item.id\"\r\n                          :label=\"item.company\"\r\n                          :value=\"item.id\">\r\n                        </el-option>\r\n                      </el-select>\r\n                      <el-select :disabled=\"isRead || !items.isRead\" v-model=\"scope.row[items.itemCode]\" clearable=\"true\" filterable  placeholder=\"请选择\" v-if=\"items.itemName == '供应商'\">\r\n                        <el-option\r\n                          v-for=\"item in tableListData\"\r\n                          :key=\"item.id\"\r\n                          :label=\"item.name\"\r\n                          :value=\"item.id\">\r\n                        </el-option>\r\n                      </el-select>\r\n                    </template>\r\n                    <!-- 普通字段 -->\r\n                    <template v-else>\r\n                      <el-input :disabled=\"isRead || !items.isRead\" v-model=\"scope.row[items.itemCode]\" placeholder=\"--\"></el-input>\r\n                    </template>\r\n                  </template>\r\n                </el-table-column>\r\n              </el-table>\r\n            </div>\r\n          </template>\r\n        </el-form>\r\n        <div v-if=\"!isRead\">\r\n          <el-button size=\"small\" type=\"primary\" v-no-more-click class=\"ml-15 mt-20\" @click=\"waitWorkOrderSubHandle\">提交</el-button>\r\n          <el-button size=\"small\" type=\"primary\" v-no-more-click class=\"ml-15 mt-20\" @click=\"waitWorkOrderSaveHandle\">保存</el-button>\r\n          <el-button type=\"\" class=\"ml-15 mt-20\" @click=\"href('workorder/category/workOrder_pending_list')\">取消</el-button>\r\n        </div>\r\n      </div>\r\n      <div class=\"item-margin\"></div>\r\n    </div>\r\n    <div class=\"item-margin\">\r\n      <div class=\"item-form\">\r\n        <el-steps :active=\"active\" finish-status=\"success\">\r\n          <el-step title=\"新工单\"></el-step>\r\n          <el-step title=\"处理中\"></el-step>\r\n          <el-step title=\"已处理\"></el-step>\r\n        </el-steps>\r\n        <!-- 工单跟进记录 -->\r\n        <div class=\"work-order-info mt-30\">\r\n          <span>工单跟进记录：</span>\r\n          <el-button size=\"small\" plain mini @click=\"open\" v-if=\"isAddCourse\">添加跟进记录</el-button>\r\n        </div>\r\n        <!-- 时间线 -->\r\n        <div class=\"block mt-30\">\r\n          <el-timeline>\r\n            <el-timeline-item\r\n            :hide-timestamp=\"true\"\r\n            v-for=\"(activity, index) in workOrderLog_list\"\r\n            :key=\"index\"\r\n            :icon=\"activity.icon\"\r\n            :type=\"activity.type\"\r\n            :color=\"activity.color\"\r\n            :size=\"activity.size\"\r\n            :timestamp=\"activity.updateTime\"\r\n            >{{ activity.updateTime || '--' | timestampToTime }}&nbsp;&nbsp;{{activity.log}}</el-timeline-item>\r\n          </el-timeline>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<!-- 工单池 -->\r\n<script>\r\n  import axios from \"axios\";\r\n  import { getToken } from \"@/utils/auth\";\r\n  import codeSet from \"@/components/codeSet\";\r\n  import treeDept from \"@/components/treeDept\";\r\n  import { filter } from \"minimatch\";\r\n  import { get } from \"http\";\r\n  import { mapGetters } from 'vuex';\r\n  import * as userTypes from \"@/types/userConfig\";\r\n  let token = getToken();\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        // 是否只读写\r\n        isRead:false,\r\n        // 量体信息\r\n        getDataByReservationObj:{},\r\n        isCorrelationDataShow:false,\r\n        historyWorkOrderGetByNumObj:{},\r\n        workOrderLog_list:{},\r\n        tableItemGetListMapObj:{},\r\n        consumerCustomizedOrder_obj:{},\r\n        // 处理结果字段list\r\n        listByWorkOrderCode:[],\r\n        // 处理结果字段对应名称\r\n        tableData_backups:{},\r\n        // 一对多字段集合\r\n        subObj:{},\r\n        // 物流列表\r\n        express_list:[],\r\n        // 供应商编码\r\n        tableListData:[],\r\n        // 添加进程是否显示\r\n        isAddCourse:this.$route.query.isAddCourse,\r\n        value:'请选择',\r\n        value2:'请选择',\r\n        isConsumer:false,\r\n        jobOrderStatus:{\r\n          \"0\":\"未处理\",\r\n          \"1\":\"处理中\",\r\n          \"2\":\"已处理\"\r\n        },\r\n        priority:{\r\n          \"01\":\"高\",\r\n          \"02\":\"中\",\r\n          \"03\":\"低\",\r\n        },\r\n        // 供应商请求数据\r\n        filtersData: {\r\n          \"pageIndex\":1,\r\n          \"pageSize\":10,\r\n          \"cooperation\":null,\r\n          \"searchWords\":\"\"\r\n        },\r\n        storageValArr: [],\r\n        formInline: {},\r\n        active: 1,\r\n        reverse: true\r\n      };\r\n    },\r\n    created() {\r\n      this.isRead = this.$route.query.isRead;\r\n      console.log(this.$route)\r\n      this.getHistoryWorkOrderGetByNum(this.$route.query.number);\r\n      this.getWorkOrderLog_list(this.$route.query.number);\r\n      this.tableItemListByWorkOrderCode(this.$route.query.sourceChileType,this.$route.query.sourceId);\r\n      this.expressCompany_list();// 获取所有快递公司代码、\r\n      this.getTableList();// 获取供应商列表\r\n    },\r\n    methods: {\r\n      /**\r\n       * 获取所有快递公司代码\r\n       */\r\n      expressCompany_list() {\r\n        const that = this;\r\n\r\n        this.request(\r\n          this.api.order.expressCompany_list,\r\n          {\r\n            \"pageIndex\":\"\",\r\n            \"pageSize\":\"\",\r\n            \"fuzzyQuery\":\"\"\r\n          }\r\n        ).then(res => {\r\n          this.express_list = res.data;\r\n        });\r\n      },\r\n      /**\r\n       * 获取供应商列表\r\n       */\r\n      getTableList(){\r\n          this.request(\r\n            this.api.product.supplier_list,\r\n            this.filtersData\r\n          ).then(res => {\r\n          this.tableListData = res.data;\r\n        });\r\n      },\r\n      /**\r\n       * 获取定制订单信息\r\n       */\r\n      consumerCustomizedOrder_get(orderId) {\r\n        this.request(\r\n          this.api.order.consumerCustomizedOrder_get,\r\n          {\r\n            // orderId: \"83e785b5-89fd-49eb-a6a5-5e3e76c9bf3f\"\r\n            orderId\r\n          }\r\n        ).then(res => {\r\n          res.consumerCustomizedGoodsVOList.forEach((item, index) => {\r\n            item.isChecked = false;\r\n            item.craft = [];// 工艺\r\n            item.material = [];// 原料\r\n            item.productGoodsMaterials.forEach((items, indexs) => {\r\n              if(items.type == 1) {\r\n                item.craft.push(items);\r\n              }else{\r\n                item.material.push(items);\r\n              }\r\n            });\r\n          });\r\n          this.consumerCustomizedOrder_obj = res;\r\n        });\r\n      },\r\n      /**\r\n       * 获取量体信息\r\n       * @param { String } reservationOrderId 定制订单id\r\n       */\r\n      reservationOrderMeasurement_getDataByReservationOrderId(reservationOrderId) {\r\n        this.request(\r\n          this.api.order.reservationOrderMeasurement_getDataByReservationOrderId,\r\n          {\r\n            reservationOrderId\r\n          }\r\n        ).then(res => {\r\n          this.getDataByReservationObj = res;\r\n        });\r\n      },\r\n      /**\r\n       * 判断处理字段是否为空，为空不可提交\r\n       */\r\n      waitWorkOrderSubHandle() {\r\n        let saveListByWorkOrderCodeObj = {},\r\n            hObj = this.historyWorkOrderGetByNumObj;\r\n        // 判断字段不可为空提交\r\n        for(var i=0; i<this.listByWorkOrderCode.length; i++) {\r\n          let item = this.listByWorkOrderCode[i];\r\n          // 一对一，（一对一和一对多依赖的数据结构不同）\r\n          if(item.linkType == 1){\r\n            for(var j=0; j<item.sublist.length; j++) {\r\n              let items = item.sublist[j];\r\n              // 必须是可读写的\r\n              if(items.isRead == 1) {\r\n                // tableData中对应的值不可为空\r\n                if(!item.tableData[items.itemCode]){\r\n                  this.warn(`${items.itemName}不能为空！`,'success');\r\n                  items.isNull = true;\r\n                  return;\r\n                }else{\r\n                  items.isNull = false;\r\n                }\r\n              };\r\n            }\r\n          // 一对多\r\n          }else{\r\n            // tableDataList如果为空直接跳过判断\r\n            if(item.tableDataList.length > 0){\r\n              // 遍历一对多的各项，找对对应的值与上面sublist做比较\r\n              for(var j=0; j<item.tableDataList.length; j++) {\r\n                var items = item.tableDataList[j];\r\n                for(var name in items) {\r\n                  if(!items[name]) {\r\n                    let findElement = item.sublist.find((findItem, findIndex) => {\r\n                      return findItem.visible != false && findItem.itemCode == name && findItem.isRead;\r\n                    });\r\n                    if(findElement) {\r\n                      this.warn(`${findElement.itemName}不能为空！`,'success');\r\n                      return;\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          };\r\n        }\r\n        Object.assign(saveListByWorkOrderCodeObj, {\r\n          itemResultList:this.listByWorkOrderCode,\r\n          number:hObj.number,\r\n          id:this.$route.query.id,\r\n          taskId:hObj.taskId,\r\n          remarks:hObj.remarks,\r\n          sourceId:hObj.sourceId,\r\n          sourceChileType:hObj.sourceChileType,\r\n          procInstId:this.$route.query.procInstId,\r\n          assignee:this.userInfo.name,\r\n          assigneeId:this.userInfo.userId\r\n        });\r\n        // return;\r\n        this.request(\r\n          this.api.job_order.waitWorkOrderSubHandle,\r\n          saveListByWorkOrderCodeObj\r\n        ).then(res => {\r\n          this.warn('提交成功！','success');\r\n          this.href('workorder/category/workOrder_pending_list');\r\n        });\r\n      },\r\n      /**\r\n       * 保存工单字段\r\n       */\r\n      waitWorkOrderSaveHandle() {\r\n        let saveListByWorkOrderCodeObj = {},\r\n            hObj = this.historyWorkOrderGetByNumObj,\r\n            that = this;\r\n\r\n        Object.assign(saveListByWorkOrderCodeObj, {\r\n          itemResultList:this.listByWorkOrderCode,\r\n          number:hObj.number,\r\n          id:this.$route.query.id,\r\n          taskId:hObj.taskId,\r\n          remarks:hObj.remarks,\r\n          sourceId:hObj.sourceId\r\n        });\r\n        this.request(\r\n          this.api.job_order.waitWorkOrderSaveHandle,\r\n          saveListByWorkOrderCodeObj\r\n        ).then(res => {\r\n          that.warn('保存成功！','success');\r\n          that.href('workorder/category/workOrder_pending_list');\r\n        });\r\n      },\r\n      /**\r\n       * 跳转工单详情\r\n       */\r\n      href(routeName, param) {\r\n         this.$router.push({\r\n            path: '/' + routeName,\r\n            query: param\r\n         })\r\n      },\r\n      /**\r\n       * 根据源单获取所有子表数据项\r\n       */\r\n      tableItemListByWorkOrderCode(sourceChileType, sourceId) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.tableItemListByWorkOrderCode,\r\n          {\r\n            code:sourceChileType,\r\n            sourceId\r\n          }\r\n        ).then(res => {\r\n          // 整理一对多字段集合\r\n          res.forEach((item, index) => {\r\n              item.sublist.forEach((items, indexs) => {\r\n                items.isNull = false;\r\n              });\r\n          });\r\n          that.listByWorkOrderCode = res;\r\n          console.log(that.subObj)\r\n        });\r\n      },\r\n      /**\r\n       * 获取工单池详情基本信息\r\n       */\r\n      getHistoryWorkOrderGetByNum(number) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.getHistoryWorkOrderGetByNum,\r\n          {\r\n            number\r\n          }\r\n        ).then(res => {\r\n          const createTime = new Date(res.createTime).getTime();\r\n          const _createTime = new Date().getTime();\r\n\r\n          that.historyWorkOrderGetByNumObj = res;\r\n          that.active = res.jobOrderStatus + 1;\r\n          that.historyWorkOrderGetByNumObj._createTime = this.formatDuring(_createTime-createTime);\r\n\r\n          if(that.historyWorkOrderGetByNumObj.sourceChileType == 'measuringWorkOrder') {\r\n            this.reservationOrderMeasurement_getDataByReservationOrderId(this.$route.query.sourceId);// 获取量体信息\r\n          }\r\n          if(that.historyWorkOrderGetByNumObj.sourceChileType == 'consumerCustomizedOrder'){\r\n            this.consumerCustomizedOrder_get(this.$route.query.sourceId);// 获取定制信息\r\n          }\r\n\r\n        });\r\n      },\r\n      /**\r\n       *\r\n       */\r\n      formatDuring(mss) {\r\n          var days = parseInt(mss / (1000 * 60 * 60 * 24));\r\n          var hours = parseInt((mss % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n          var minutes = parseInt((mss % (1000 * 60 * 60)) / (1000 * 60));\r\n          var seconds = (mss % (1000 * 60)) / 1000;\r\n          return `${days}天${hours}时${minutes}分`;\r\n      },\r\n      /**\r\n      * 提示\r\n      */\r\n      warn(message, type) {\r\n        this.$message({\r\n          message: message,\r\n          type: type || 'warning'\r\n        });\r\n      },\r\n      /**\r\n       * 获取工单跟进记录列表\r\n       */\r\n      getWorkOrderLog_list(number) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.getWorkOrderLog_list,\r\n          {\r\n            number\r\n          }\r\n        ).then(res => {\r\n          that.workOrderLog_list = res.data.reverse();\r\n        });\r\n      },\r\n      /**\r\n       * 添加一条跟进记录\r\n       */\r\n      addHistoryWorkOrderFollowUp() {\r\n        const that = this;\r\n        console.log(this.historyWorkOrderGetByNumObj)\r\n        this.request(\r\n          that.api.job_order.addHistoryWorkOrderFollowUp,\r\n          Object.assign(this.historyWorkOrderGetByNumObj, {\r\n            updateName: this.userInfo.loginName\r\n          })\r\n        ).then(res => {\r\n          this.warn('添加成功！','success');\r\n          this.getWorkOrderLog_list(this.$route.query.number);\r\n        });\r\n      },\r\n      open() {\r\n        this.$prompt(\"添加一条跟进记录\", \"提示\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\"\r\n        }).then(({ value }) => {\r\n          if(!value) return;\r\n          this.historyWorkOrderGetByNumObj.remarks = value;\r\n          this.addHistoryWorkOrderFollowUp();\r\n        })\r\n      }\r\n\r\n    },\r\n    computed: {\r\n      ...mapGetters({\r\n        userInfo: userTypes.GETTER_USERINFO\r\n      })\r\n    },\r\n    components: {\r\n      codeSet,\r\n      treeDept\r\n    }\r\n  }\r\n</script>\r\n<style  lang=\"less\" scoped>\r\n  .isNull{\r\n    color: red;\r\n    line-height: 39px;\r\n    margin-right: 6px;\r\n  }\r\n  .jdbcType-image{\r\n    width: 35px;\r\n    height: 35px;\r\n  }\r\n  .the-results{\r\n    // width: 1500px;\r\n    display: flex;\r\n    text-align: right;\r\n    flex-wrap: wrap;\r\n    .the-results-span{\r\n      width: 370px;\r\n    }\r\n  }\r\n  .the-results-three-rows{\r\n    // width: 1150px;\r\n  }\r\n  .text-indent15{\r\n    text-indent: 15px;\r\n  }\r\n  .text-indent45{\r\n    text-indent: 45px;\r\n  }\r\n    .text-indent75{\r\n    text-indent: 75px;\r\n  }\r\n  .color243{\r\n    color:rgb(243, 131, 3);\r\n  }\r\n.spu {\r\n  li {\r\n    div{\r\n      display: flex;\r\n      border-bottom: 1px solid #f0f0f0;\r\n      span {\r\n        height: 50px;\r\n        flex: 1;\r\n        line-height: 50px;\r\n        position: relative;\r\n        text-align: center;\r\n      }\r\n      .text-left{\r\n        text-align: left;\r\n      }\r\n      img {\r\n        width: 40px;\r\n        height: 40px;\r\n      }\r\n    }\r\n    .spu-border {\r\n      border-bottom: 1px solid rgb(243, 131, 3);\r\n    }\r\n  }\r\n}\r\n  .display-flex{\r\n    display: flex;\r\n  }\r\n  .subImg{\r\n    width: 35px;\r\n    height: 35px;\r\n  }\r\n  .correlationData-p{\r\n    border-bottom: 1px solid #f0f0f0;\r\n    padding-bottom: 20px;\r\n    margin-bottom: 20px;\r\n  }\r\n  h5 {\r\n    color: #222;\r\n    margin-left: -30px;\r\n  }\r\n  .s{\r\n    margin-top:10px;\r\n    display:block;\r\n    font-size:15px;\r\n    color: #66b1ff;\r\n  }\r\n  .test {\r\n    color: #9d9d9d;\r\n  }\r\n  .work-order-info {\r\n    display: flex;\r\n    justify-content: space-between;\r\n  }\r\n  .info-list {\r\n    display: flex;\r\n    width: 80%;\r\n    flex-wrap: wrap;\r\n    padding: 15px 10px 0 10px;\r\n    li {\r\n      padding-bottom: 10px;\r\n      margin-right: 30px;\r\n    }\r\n  }\r\n  .correlationData{\r\n    height: 300px;\r\n    overflow-y:scroll;\r\n    padding:0 15px 15px 15px;\r\n      h3{\r\n        font-size: 16px;\r\n        padding: 15px 0;\r\n      }\r\n      ul{\r\n        display: flex;\r\n        flex-wrap:wrap;\r\n        li{\r\n          width: 20%;\r\n          text-indent: 20px;\r\n          padding: 5px 0;\r\n        }\r\n        img{\r\n          width: 120px;\r\n          height: 150px;\r\n        }\r\n        span{\r\n          display: block;\r\n          margin-top: 10px;\r\n        }\r\n      }\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/views/workorder/category"}]}