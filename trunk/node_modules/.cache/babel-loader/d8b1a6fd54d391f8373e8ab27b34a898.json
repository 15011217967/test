{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\orders\\business\\purchase\\purchaseOrder_list.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\orders\\business\\purchase\\purchaseOrder_list.vue","mtime":1577172765872},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\EDZ\\\\Desktop\\\\\\u7814\\u53D1\\u9879\\u76EE\\\\vue-project\\\\trunk\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { formatTimestamp } from \"@/utils/date\";\nimport codeSet from \"@/components/codeSet\";\nimport treeDept from \"@/components/treeDept\";\nimport { getToken } from \"@/utils/auth\";\nimport { Loading } from 'element-ui';\nvar token = getToken();\n/**\r\n * 基本管理\r\n */\n\nexport default {\n  components: {\n    codeSet: codeSet,\n    treeDept: treeDept\n  },\n  data: function data() {\n    return {\n      loadingInstance: null,\n      //权限Code码\n      codeData: [],\n      tokenHeaders: {\n        accessToken: token\n      },\n      fileList: [],\n      filtersData: {\n        orderType: \"0301\",\n        searchKey: \"\",\n        businessStatusList: [],\n        channelCodes: [],\n        //组织机构code码\n        organizationCodes: [],\n        supplierCodes: [],\n        startTime: \"\",\n        endTime: \"\",\n        pageIndex: 1,\n        pageSize: 10\n      },\n      options1: [{\n        value: \"06\",\n        name: \"未完成\"\n      }, {\n        value: \"08\",\n        name: \"已完成\"\n      }, {\n        value: \"15\",\n        name: \"已作废\"\n      }],\n      //采购订单列表\n      purchaseOrderListData: [],\n      total: null,\n      //日期\n      datefilter: [],\n      agencies: [],\n      //所属机构集合\n      suppliers: [],\n      //供应商集合\n      //组织机构数据\n      organizationListData: []\n    };\n  },\n  created: function created() {\n    //得到表格数据\n    this.getTableList();\n    this.findAgencyList();\n    this.findSuppliers(); //得到组织机构\n\n    this.getWarehouseListData();\n    this.getCodeLimitToBtnStatus(this.$route.meta.currentid);\n  },\n  filters: {\n    //过滤当前状态\n    filterBusinessStatus: function filterBusinessStatus(val) {\n      switch (val) {\n        case \"06\":\n          return \"未完成\";\n          break;\n\n        case \"08\":\n          return \"已完成\";\n          break;\n\n        case \"15\":\n          return \"已作废\";\n          break;\n\n        default:\n          return '--';\n          break;\n      }\n    },\n    //过滤支付状态\n    filterPaymentCode: function filterPaymentCode(val) {\n      switch (val) {\n        case \"01\":\n          return \"现金\";\n          break;\n\n        case \"02\":\n          return \"银行卡\";\n          break;\n\n        case \"03\":\n          return \"微信\";\n          break;\n\n        case \"04\":\n          return \"支付宝\";\n          break;\n\n        case \"05\":\n          return \"支票\";\n          break;\n\n        case \"06\":\n          return \"电汇\";\n          break;\n\n        case \"07\":\n          return \"汇票\";\n          break;\n\n        case \"08\":\n          return \"其他\";\n          break;\n\n        default:\n          return '--';\n          break;\n      }\n    },\n    //过滤到货状态\n    filterWarehouseStatus: function filterWarehouseStatus(val) {\n      switch (val) {\n        case \"1001\":\n          return \"未到货\";\n          break;\n\n        case \"1002\":\n          return \"部分到货\";\n          break;\n\n        case \"1003\":\n          return \"全部到货\";\n          break;\n\n        case \"1004\":\n          return \"超收到货\";\n          break;\n\n        default:\n          return \"--\";\n          break;\n      }\n    },\n    //过滤订单来源\n    filterChannelCode: function filterChannelCode(val) {\n      switch (val) {\n        case \"01\":\n          return \"淘宝\";\n          break;\n\n        case \"02\":\n          return \"京东\";\n          break;\n\n        case \"03\":\n          return \"天猫\";\n          break;\n\n        case \"04\":\n          return \"手工录入\";\n          break;\n\n        default:\n          return \"--\";\n          break;\n      }\n    }\n  },\n  methods: {\n    fileAction: function fileAction() {\n      return this.api.FN_ALLPATH(this.api.order.channelPurchaseOrder_importPurchaseOrder);\n    },\n    //文件上传成功过\n    handleFileSuccess: function handleFileSuccess(res, file) {\n      var _this = this;\n\n      if (!res.data.model) {\n        this.$nextTick(function () {\n          var html = '';\n          res.data.invalid.forEach(function (errItem) {\n            html += '<p>' + errItem + '：该商品不存在</p>';\n          });\n\n          _this.$notify({\n            title: '提示',\n            duration: 0,\n            dangerouslyUseHTMLString: true,\n            message: html\n          });\n\n          _this.loadingInstance.close();\n        });\n        return;\n      }\n\n      var uploadData = JSON.stringify(res.data.model);\n      var invalid = JSON.stringify(res.data.invalid);\n      console.log(res);\n      this.$nextTick(function () {\n        _this.$router.push({\n          name: \"purchaseOrder_add\",\n          params: {\n            uploadData: uploadData,\n            invalid: invalid\n          }\n        });\n\n        localStorage.setItem(\"type\", \"add\");\n\n        _this.loadingInstance.close();\n      });\n    },\n    beforefileUploadChange: function beforefileUploadChange(file) {\n      console.log(file); //文件上传之前调用做一些拦截限制\n      // this.fileList=[]\n      // this.fileList.push({name:file.name});\n\n      this.loadingInstance = Loading.service({\n        fullscreen: true,\n        text: '正在拼命导入。。。'\n      });\n    },\n    // 得到code码，用来限制是否显示按钮\n    getCodeLimitToBtnStatus: function getCodeLimitToBtnStatus(codeId) {\n      var _this2 = this;\n\n      this.request(this.api.user.crm_userCompany_authList, {\n        menuId: codeId\n      }).then(function (res) {\n        console.log(res);\n        _this2.codeData = res;\n      });\n    },\n    //得到组织机构数据\n    getWarehouseListData: function () {\n      var _getWarehouseListData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this3 = this;\n\n        var info;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.request(this.api.user.get_userinfo, {}, true);\n\n              case 2:\n                info = _context.sent;\n                console.log(info); //得到部门Id\n                // this.signData.relationDepId = info.departId;\n\n                this.request(this.api.user.userCompany_getUserOrgByUserId, {\n                  userId: info.userId,\n                  type: 0\n                }).then(function (data) {\n                  console.log(data);\n\n                  _this3.organizationListData.push(data); //得到供货商数据\n\n\n                  _this3.getSupplierListData(data.id);\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getWarehouseListData() {\n        return _getWarehouseListData.apply(this, arguments);\n      }\n\n      return getWarehouseListData;\n    }(),\n    //得到供货商数据\n    getSupplierListData: function getSupplierListData(organizationId) {\n      var _this4 = this;\n\n      console.log(246); //cooperation 为true得到有合作的供应商 不传 得到全部的供应商\n\n      this.request(this.api.product.supplier_list, {\n        cooperation: true\n      }).then(function (data) {\n        console.log(data);\n        _this4.suppliers = data.data;\n      });\n    },\n    //获取列表\n    getTableList: function getTableList() {\n      var _this5 = this;\n\n      this.request(this.api.order.channelPurchaseOrder_list, this.filtersData).then(function (data) {\n        _this5.total = data.totalCount;\n        _this5.purchaseOrderListData = data.data;\n      });\n    },\n    //新增\n    openAddClass: function openAddClass() {\n      this.$router.push({\n        path: \"/OS/business/purchase/purchaseOrder_add\",\n        query: {\n          type: \"add\"\n        }\n      });\n      localStorage.setItem(\"type\", \"add\");\n    },\n    //查看\n    openShowDetails: function openShowDetails(orderSn) {\n      this.$router.push({\n        path: \"/OS/business/purchase/purchaseOrder_check\",\n        query: {\n          orderSn: orderSn\n        }\n      });\n    },\n    //修改\n    openEdit: function openEdit(orderSn) {\n      console.log(orderSn);\n      this.$router.push({\n        path: \"/OS/business/purchase/purchaseOrder_editor\",\n        query: {\n          orderSn: orderSn\n        }\n      });\n      localStorage.setItem(\"type\", \"add\");\n    },\n    //下拉选项\n    handleCommand: function handleCommand(row) {\n      var _this6 = this;\n\n      console.log(row);\n\n      if (row[\"remark\"] == \"addNote\") {\n        //点击了到货单\n        this.$router.push({\n          path: \"/OS/business/purchase/arrivalNotice_add\",\n          query: {\n            orderSn: row['row'].orderSn\n          }\n        });\n      } else {\n        //点击了该行的完成\n        this.request(this.api.order.channelPurchaseOrder_updatePurchaseOrderStatus, {\n          orderSn: row['row'].orderSn,\n          symbol: 'complete'\n        }).then(function (data) {\n          _this6.$message({\n            message: '订单已完成',\n            type: 'success'\n          }); //刷新表格数据\n\n\n          _this6.getTableList();\n        });\n      }\n    },\n    dropdownItemValueChange: function dropdownItemValueChange(tagStr, row) {\n      return {\n        remark: tagStr,\n        row: row\n      };\n    },\n    //查询所属机构列表\n    findAgencyList: function findAgencyList() {},\n    //查询供应商列表\n    findSuppliers: function findSuppliers() {},\n    //导入\n    importExcel: function importExcel(id) {\n      console.log(\"importExcel\"); // this.postAxios(this.$base.api.procureOrder_importExcel, {}).then(data => {\n      //   alert(data.data);\n      //   this.getTableList();\n      // });\n    },\n    //下载模板\n    downloadTemplate: function downloadTemplate() {},\n    //查看质检报告\n    findQuality: function findQuality(id) {},\n    //删除\n    deleteItem: function deleteItem(val) {\n      var _this7 = this;\n\n      if (confirm(\"确定删除？\")) {\n        console.log(val);\n        this.request(this.api.order.channelPurchaseOrder_logicDelete, {\n          orderSn: val.orderSn\n        }).then(function (data) {\n          _this7.getTableList();\n        });\n      }\n    },\n    //完成订单\n    completeOrder: function completeOrder(val) {\n      var _this8 = this;\n\n      if (confirm(\"确认采购订单完成吗？\\n\" + \"\\n\" + \"确认后采购订单结束，不可增添到货单！\")) {\n        this.postAxios(this.$base.api.procureOrder_confirm, val).then(function (data) {\n          _this8.getTableList();\n        });\n      }\n    },\n    //搜索\n    handleSearch: function handleSearch() {\n      console.log(this.filtersData);\n      this.getTableList();\n    },\n    //清空重置\n    handleResetFilters: function handleResetFilters(formName) {\n      console.log(\"handleResetFilters======\");\n      this.$refs[formName].resetFields();\n      this.filtersData.startTime = \"\";\n      this.filtersData.endTime = \"\"; // this.getTableList();\n    },\n    //当前页数修改时发生改变\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.filtersData.pageIndex = val;\n      this.getTableList();\n    },\n    // 每页显示多少条时发生改变\n    handleSizeChange: function handleSizeChange(val) {\n      this.filtersData.pageSize = val;\n      this.getTableList();\n    }\n  }\n};",{"version":3,"sources":["purchaseOrder_list.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <!--//采购单-->\r\n  <div class=\"purchases-bass\">\r\n    <!-- input-form -->\r\n    <div class=\"item-form\">\r\n      <el-form\r\n        class=\"item-form\"\r\n        :model=\"filtersData\"\r\n        label-width=\"90px\"\r\n        size=\"small\"\r\n        ref=\"filtersForm\"\r\n        inline\r\n      >\r\n        <el-row>\r\n          <el-col>\r\n            <el-form-item prop=\"searchKey\" label=\"模糊查询：\">\r\n              <el-input class=\"input-w\" placeholder=\"到货单号/采购订单号\" v-model=\"filtersData.searchKey\"></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item prop=\"businessStatusList\" label=\"状态：\">\r\n              <el-select class=\"input-w\" placeholder=\"请选择\" multiple v-model=\"filtersData.businessStatusList\">\r\n                <el-option\r\n                  v-for=\"item in options1\"\r\n                  :key=\"item.id\"\r\n                  :label=\"item.name\"\r\n                  :value=\"item.value\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item prop=\"channelCodes\" label=\"订单来源：\">\r\n              <code-set v-model=\"filtersData.channelCodes\" code=\"ORD001\" :multiple=\"true\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"所属机构：\" prop=\"organizationCodes\">\r\n             <el-select v-model=\"filtersData.organizationCodes\" placeholder=\"请选择\" :multiple=\"true\">\r\n              <el-option\r\n                v-for=\"item in organizationListData\"\r\n                :label=\"item.name\"\r\n                :key=\"item.id\"\r\n                :value=\"item.id\"\r\n              ></el-option>\r\n            </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col>\r\n            <el-form-item prop=\"supplierCodes\" label=\"供应商：\">\r\n              <el-select class=\"input-w\" placeholder=\"请选择\" multiple v-model=\"filtersData.supplierCodes\">\r\n                <el-option\r\n                  v-for=\"item in suppliers\"\r\n                  :key=\"item.id\"\r\n                  :label=\"item.name\"\r\n                  :value=\"item.code\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"选择日期：\">\r\n              <template>\r\n                <div class=\"block\">\r\n                  <el-date-picker\r\n                    class=\"date-picker-div\"\r\n                    v-model=\"filtersData.startTime\"\r\n                    type=\"date\"\r\n                    placeholder=\"开始时间\"\r\n                  ></el-date-picker>\r\n                  <el-date-picker v-model=\"filtersData.endTime\" type=\"date\" placeholder=\"结束时间\"></el-date-picker>\r\n                </div>\r\n              </template>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button @click=\"handleSearch\" type=\"primary\" plain size=\"small\">搜索</el-button>\r\n              <el-button @click=\"handleResetFilters('filtersForm')\" size=\"small\">重置</el-button>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n    </div>\r\n    <!-- table -->\r\n    <div class=\"item-table\">\r\n      <div class=\"item-cont\">\r\n        <el-button size=\"small\" type=\"primary\" @click=\"openAddClass()\" style=\"margin-right:10px;\">新增</el-button>\r\n        <el-upload\r\n          class=\"upload-demo\"\r\n          :action=\"fileAction()\"\r\n          accept=\".xlsx,.xls,.csv\"\r\n          :headers=\"tokenHeaders\"\r\n          name=\"multipartFile\"\r\n          :on-success=\"handleFileSuccess\"\r\n          :on-change=\"beforefileUploadChange\"\r\n          :show-file-list='false'\r\n          >\r\n          <el-button size=\"small\" type=\"primary\">导入</el-button>\r\n        </el-upload>\r\n        <!-- <el-button size=\"small\" @click=\"importExcel()\"  >导入</el-button> -->\r\n        <el-button size=\"small\" style=\"margin-left: 10px;\">\r\n          <a href=\"https://content-template.oss-cn-beijing.aliyuncs.com/excel/order.xlsx\" style=\"color:#222;\">下载模板</a>\r\n        </el-button>\r\n      </div>\r\n      <div class=\"item-table\">\r\n        <el-table\r\n          :data=\"purchaseOrderListData\"\r\n          stripe\r\n          empty-text=\"暂无数据\"\r\n          header-align=\"center\"\r\n          header-row-class-name=\"item-table-header\"\r\n          :highlight-current-row=\"true\"\r\n        >\r\n          <el-table-column prop=\"orderSn\" align=\"center\" label=\"采购订单号\" width=\"210\"></el-table-column>\r\n          <el-table-column align=\"center\" label=\"状态\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.businessStatus | filterBusinessStatus}}</template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"contractSn\" align=\"center\" label=\"采购合同号\" width=\"150\">\r\n            <template slot-scope=\"scope\">\r\n              <span>{{scope.row.contractSn?scope.row.contractSn:'--'}}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"supplier\" align=\"center\" label=\"供应商\" width=\"100\"></el-table-column>\r\n          <el-table-column prop=\"amount\" align=\"center\" label=\"采购金额\" width=\"100\"></el-table-column>\r\n          <!--todo 差两个参数-->\r\n          <el-table-column prop=\"validAmount\" align=\"center\" label=\"实付金额\" width=\"100\"></el-table-column>\r\n          <el-table-column align=\"center\" label=\"付款方式\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.paymentCode | filterPaymentCode}}</template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"到货状态\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.warehouseStatus | filterWarehouseStatus}}</template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"quantity\" align=\"center\" label=\"采购总数\" width=\"100\"></el-table-column>\r\n          <el-table-column prop=\"actualQuantity\" align=\"center\" label=\"实收总数\" width=\"100\"></el-table-column>\r\n          <el-table-column prop=\"deliverNum\" align=\"center\" label=\"发货次数\" width=\"100\"></el-table-column>\r\n          <el-table-column align=\"center\" label=\"创建时间\" min-width=\"180\">\r\n            <template slot-scope=\"scope\">{{ scope.row.createTime | timestampToTime}}</template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"purchaser\" align=\"center\" label=\"采购人\" width=\"130\">\r\n            <template slot-scope=\"scope\">{{ scope.row.purchaser ? scope.row.purchaser :'--'}}</template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"organization\" align=\"center\" label=\"所属机构\" width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.organization ? scope.row.organization :'--'}}</template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"订单来源\" min-width=\"100\">\r\n            <template slot-scope=\"scope\">{{ scope.row.channelCode | filterChannelCode}}</template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            fixed=\"right\"\r\n            label-class-name=\"text-center\"\r\n            class-name=\"text-center\"\r\n            align=\"center\"\r\n            label=\"操作\"\r\n            width=\"160\"\r\n          >\r\n            <template slot-scope=\"scope\">\r\n              <el-button @click=\"openShowDetails(scope.row.orderSn)\" type=\"text\" size=\"small\" v-auth=\"codeData\" data-code='PCO_VIEW'>查看</el-button>\r\n              <el-button  @click=\"openEdit(scope.row.orderSn)\" type=\"text\" size=\"small\" v-auth=\"codeData\" data-code='PCO_UPDATE' :disabled=\"scope.row.businessStatus!='06' || scope.row.deliverNum!=0\">修改</el-button>\r\n              <el-button  @click=\"deleteItem(scope.row)\" type=\"text\" size=\"small\" v-auth=\"codeData\" data-code='PCO_DELETE' :disabled=\"scope.row.businessStatus!='06' || scope.row.deliverNum!=0\">删除</el-button>\r\n              <el-dropdown @command=\"handleCommand\">\r\n                <span class=\"el-dropdown-link\">\r\n                  <i class=\"el-icon-arrow-down el-icon--right\"></i>\r\n                </span>\r\n                <el-dropdown-menu slot=\"dropdown\" v-if=\"scope.row.businessStatus=='06'\">\r\n                  <el-dropdown-item :command=\"dropdownItemValueChange('addNote',scope.row)\">添加到货单</el-dropdown-item>\r\n                  <el-dropdown-item :command=\"dropdownItemValueChange('done',scope.row)\">确认完成</el-dropdown-item>\r\n                </el-dropdown-menu>\r\n                <el-dropdown-menu slot=\"dropdown\" v-else>\r\n                  <el-dropdown-item :command=\"dropdownItemValueChange('addNote',scope.row)\" disabled>添加到货单</el-dropdown-item>\r\n                  <el-dropdown-item disabled :command=\"dropdownItemValueChange('done',scope.row)\">确认完成</el-dropdown-item>\r\n                </el-dropdown-menu>\r\n              </el-dropdown>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <div class=\"pagination mt-10 mb-20\">\r\n          <el-pagination\r\n            class=\"mr-20\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"filtersData.pageIndex\"\r\n            :page-sizes=\"[10,20,30,40,50]\"\r\n            :page-size=\"filtersData.pageSize\"\r\n            layout=\"total, sizes, prev, pager, next, jumper\"\r\n            :total=\"total\"\r\n          ></el-pagination>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { formatTimestamp } from \"@/utils/date\";\r\nimport codeSet from \"@/components/codeSet\";\r\nimport treeDept from \"@/components/treeDept\";\r\nimport { getToken } from \"@/utils/auth\";\r\nimport { Loading } from 'element-ui';\r\nlet token = getToken(); \r\n/**\r\n * 基本管理\r\n */\r\nexport default {\r\n  components: {\r\n    codeSet,\r\n    treeDept\r\n  },\r\n  data() {\r\n    return {\r\n      loadingInstance:null,\r\n      //权限Code码\r\n      codeData:[],\r\n      tokenHeaders:{accessToken: token},\r\n      fileList:[],\r\n      filtersData: {\r\n        orderType: \"0301\",\r\n        searchKey: \"\",\r\n        businessStatusList: [],\r\n        channelCodes: [],\r\n        //组织机构code码\r\n        organizationCodes: [],\r\n        supplierCodes: [],\r\n        startTime: \"\",\r\n        endTime: \"\",\r\n        pageIndex: 1,\r\n        pageSize: 10\r\n      },\r\n      options1: [\r\n        {\r\n          value: \"06\",\r\n          name: \"未完成\"\r\n        },\r\n        {\r\n          value: \"08\",\r\n          name: \"已完成\"\r\n        },\r\n        {\r\n          value: \"15\",\r\n          name: \"已作废\"\r\n        }\r\n      ],\r\n      //采购订单列表\r\n      purchaseOrderListData: [],\r\n\r\n      total: null,\r\n      //日期\r\n      datefilter: [],\r\n\r\n      agencies: [], //所属机构集合\r\n      suppliers: [], //供应商集合\r\n      //组织机构数据\r\n      organizationListData: [],\r\n    };\r\n  },\r\n  created() {\r\n    //得到表格数据\r\n    this.getTableList();\r\n    this.findAgencyList();\r\n    this.findSuppliers();\r\n    //得到组织机构\r\n    this.getWarehouseListData()\r\n\r\n    this.getCodeLimitToBtnStatus(this.$route.meta.currentid);\r\n  },\r\n  filters:{\r\n    //过滤当前状态\r\n    filterBusinessStatus(val) {\r\n     switch (val) {\r\n        case \"06\":\r\n          return \"未完成\";\r\n          break;\r\n        case \"08\":\r\n          return \"已完成\";\r\n          break;\r\n        case \"15\":\r\n          return \"已作废\";\r\n          break;\r\n        default:\r\n          return '--'\r\n        break;\r\n      }\r\n    },\r\n    //过滤支付状态\r\n    filterPaymentCode(val) {\r\n      switch (val) {\r\n        case \"01\":\r\n          return \"现金\";\r\n          break;\r\n        case \"02\":\r\n          return \"银行卡\";\r\n          break;\r\n        case \"03\":\r\n          return \"微信\";\r\n          break;\r\n        case \"04\":\r\n          return \"支付宝\";\r\n          break;\r\n        case \"05\":\r\n          return \"支票\";\r\n          break;\r\n        case \"06\":\r\n          return \"电汇\";\r\n          break;\r\n        case \"07\":\r\n          return \"汇票\";\r\n          break;\r\n        case \"08\":\r\n          return \"其他\";\r\n          break;\r\n        default:\r\n          return '--'\r\n        break;\r\n      }\r\n    },\r\n    //过滤到货状态\r\n    filterWarehouseStatus(val){\r\n      switch (val) {\r\n        case \"1001\":\r\n          return \"未到货\";\r\n        break;\r\n        case \"1002\":\r\n          return \"部分到货\";\r\n        break;\r\n        case \"1003\":\r\n          return \"全部到货\";\r\n        break;\r\n        case \"1004\":\r\n          return \"超收到货\";\r\n          break;\r\n        default:\r\n          return \"--\"\r\n        break;\r\n      }\r\n    },\r\n    //过滤订单来源\r\n    filterChannelCode(val){\r\n      switch (val) {\r\n        case \"01\":\r\n          return \"淘宝\";\r\n        break;\r\n        case \"02\":\r\n          return \"京东\";\r\n        break;\r\n        case \"03\":\r\n          return \"天猫\";\r\n        break;\r\n        case \"04\":\r\n          return \"手工录入\";\r\n          break;\r\n        default:\r\n          return \"--\"\r\n        break;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    fileAction() {\r\n      return this.api.FN_ALLPATH(this.api.order.channelPurchaseOrder_importPurchaseOrder);\r\n    },\r\n    //文件上传成功过\r\n    handleFileSuccess(res, file){\r\n      if(!res.data.model){\r\n        this.$nextTick(() => { \r\n          let html = '';\r\n          res.data.invalid.forEach(errItem => {\r\n            html += '<p>'+ errItem + '：该商品不存在</p>';\r\n          });\r\n          this.$notify({\r\n            title: '提示',\r\n            duration: 0,\r\n            dangerouslyUseHTMLString: true,\r\n            message: html\r\n          });\r\n          this.loadingInstance.close();\r\n        });\r\n        return;\r\n      }\r\n      var uploadData = JSON.stringify(res.data.model)\r\n      var invalid =JSON.stringify(res.data.invalid)\r\n      console.log(res)\r\n      this.$nextTick(() => { \r\n        this.$router.push({  \r\n          name: \"purchaseOrder_add\",\r\n          params: {\r\n            uploadData:uploadData,\r\n            invalid:invalid\r\n          }\r\n        })\r\n        localStorage.setItem(\"type\", \"add\");\r\n        this.loadingInstance.close();\r\n      });\r\n    },\r\n    beforefileUploadChange(file) {\r\n      console.log(file);\r\n      //文件上传之前调用做一些拦截限制\r\n      // this.fileList=[]\r\n      // this.fileList.push({name:file.name});\r\n      this.loadingInstance = Loading.service({ \r\n        fullscreen: true,\r\n        text:'正在拼命导入。。。' \r\n      });\r\n    },\r\n    // 得到code码，用来限制是否显示按钮\r\n    getCodeLimitToBtnStatus(codeId) {\r\n      this.request(this.api.user.crm_userCompany_authList, {\r\n        menuId: codeId\r\n      }).then(res => {\r\n        console.log(res);\r\n        this.codeData=res\r\n      });\r\n    },\r\n    //得到组织机构数据\r\n    async getWarehouseListData() {\r\n      let info = await this.request(this.api.user.get_userinfo, {}, true);\r\n      console.log(info);\r\n      //得到部门Id\r\n      // this.signData.relationDepId = info.departId;\r\n\r\n      this.request(this.api.user.userCompany_getUserOrgByUserId, {\r\n        userId: info.userId,\r\n        type: 0\r\n      }).then(data => {\r\n        console.log(data);\r\n        this.organizationListData.push(data)\r\n        //得到供货商数据\r\n        this.getSupplierListData(data.id)\r\n      });\r\n    },\r\n    //得到供货商数据\r\n    getSupplierListData(organizationId) {\r\n      console.log(246);\r\n      //cooperation 为true得到有合作的供应商 不传 得到全部的供应商\r\n      this.request(this.api.product.supplier_list, {cooperation:true}).then(data => {\r\n        console.log(data);\r\n        this.suppliers = data.data;\r\n      });\r\n    },\r\n    //获取列表\r\n    getTableList() {\r\n      this.request(\r\n        this.api.order.channelPurchaseOrder_list,\r\n        this.filtersData\r\n      ).then(data => {\r\n        this.total = data.totalCount;\r\n        this.purchaseOrderListData = data.data;\r\n      });\r\n    },\r\n    //新增\r\n    openAddClass() {\r\n      this.$router.push({\r\n        path: \"/OS/business/purchase/purchaseOrder_add\",\r\n        query: {\r\n          type: \"add\"\r\n        }\r\n      });\r\n      localStorage.setItem(\"type\", \"add\");\r\n    },\r\n    //查看\r\n    openShowDetails(orderSn) {\r\n      this.$router.push({\r\n        path: \"/OS/business/purchase/purchaseOrder_check\",\r\n        query: {\r\n          orderSn: orderSn\r\n        }\r\n      });\r\n    },\r\n    //修改\r\n    openEdit(orderSn) {\r\n      console.log(orderSn)\r\n      this.$router.push({\r\n        path: \"/OS/business/purchase/purchaseOrder_editor\",\r\n        query: {\r\n          orderSn: orderSn\r\n        }\r\n      });\r\n      localStorage.setItem(\"type\", \"add\");\r\n    },\r\n    //下拉选项\r\n    handleCommand(row) {\r\n      console.log(row)\r\n      if (row[\"remark\"] == \"addNote\") {\r\n        //点击了到货单\r\n        this.$router.push({\r\n          path: \"/OS/business/purchase/arrivalNotice_add\",\r\n          query: {\r\n            orderSn:row['row'].orderSn\r\n          }\r\n      });\r\n      } else {\r\n        //点击了该行的完成\r\n        this.request(this.api.order.channelPurchaseOrder_updatePurchaseOrderStatus,{orderSn:row['row'].orderSn, symbol:'complete'}).then(data=>{\r\n          this.$message({\r\n            message: '订单已完成',\r\n            type: 'success'\r\n          });\r\n          //刷新表格数据\r\n          this.getTableList()\r\n        })\r\n      }\r\n    },\r\n    dropdownItemValueChange(tagStr, row) {\r\n      return {\r\n        remark: tagStr,\r\n        row: row\r\n      };\r\n    },\r\n    //查询所属机构列表\r\n    findAgencyList() {\r\n\r\n    },\r\n    //查询供应商列表\r\n    findSuppliers() {},\r\n    //导入\r\n    importExcel(id) {\r\n      console.log(\"importExcel\")\r\n      // this.postAxios(this.$base.api.procureOrder_importExcel, {}).then(data => {\r\n      //   alert(data.data);\r\n      //   this.getTableList();\r\n      // });\r\n    },\r\n    //下载模板\r\n    downloadTemplate() {},\r\n    //查看质检报告\r\n    findQuality(id) {},\r\n    //删除\r\n    deleteItem(val) {\r\n      if (confirm(\"确定删除？\")) {\r\n        console.log(val);\r\n        this.request(this.api.order.channelPurchaseOrder_logicDelete, {\r\n          orderSn: val.orderSn\r\n        }).then(data => {\r\n          this.getTableList();\r\n        });\r\n      }\r\n    },\r\n    //完成订单\r\n    completeOrder(val) {\r\n      if (\r\n        confirm(\r\n          \"确认采购订单完成吗？\\n\" +\r\n            \"\\n\" +\r\n            \"确认后采购订单结束，不可增添到货单！\"\r\n        )\r\n      ) {\r\n        this.postAxios(this.$base.api.procureOrder_confirm, val).then(data => {\r\n          this.getTableList();\r\n        });\r\n      }\r\n    },\r\n    //搜索\r\n    handleSearch() {\r\n      console.log(this.filtersData);\r\n      this.getTableList();\r\n    },\r\n\r\n    //清空重置\r\n    handleResetFilters(formName) {\r\n      console.log(\"handleResetFilters======\");\r\n      this.$refs[formName].resetFields();\r\n      this.filtersData.startTime = \"\";\r\n      this.filtersData.endTime = \"\";\r\n      // this.getTableList();\r\n    },\r\n    //当前页数修改时发生改变\r\n    handleCurrentChange(val) {\r\n      this.filtersData.pageIndex = val;\r\n      this.getTableList();\r\n    },\r\n    // 每页显示多少条时发生改变\r\n    handleSizeChange(val) {\r\n      this.filtersData.pageSize = val;\r\n      this.getTableList();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style  lang=\"less\" scoped>\r\n.purchases-bass {\r\n  // background-color: #fff;\r\n  height: 100%;\r\n  margin: 8px;\r\n  .item-form {\r\n    margin-bottom: 8px;\r\n    background-color: #fff;\r\n    padding: 10px 10px 0 10px;\r\n  }\r\n  .item-cont {\r\n    margin-right: 10px;\r\n    display: flex;\r\n  }\r\n  .date-picker-div {\r\n    margin-right: 10px;\r\n  }\r\n}\r\n.table {\r\n  padding: 20px;\r\n}\r\n</style>\r\n\r\n"],"sourceRoot":"src/views/orders/business/purchase"}]}