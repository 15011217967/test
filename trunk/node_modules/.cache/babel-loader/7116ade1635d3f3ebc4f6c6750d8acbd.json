{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\orders\\business\\purchase\\arrivalNotice_add.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\orders\\business\\purchase\\arrivalNotice_add.vue","mtime":1573089143853},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\EDZ\\\\Desktop\\\\\\u7814\\u53D1\\u9879\\u76EE\\\\vue-project\\\\trunk\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport codeSet from \"@/components/codeSet\";\nimport treeDept from \"@/components/treeDept\";\nimport { constants } from \"crypto\";\nexport default {\n  components: {\n    codeSet: codeSet,\n    treeDept: treeDept\n  },\n  data: function data() {\n    return {\n      //标识到货总数\n      shopAllQuantity: 0,\n      //采购订单号标识\n      supplierStatus: true,\n      //供应商标识\n      supplierNameStatus: false,\n      //标识门店或仓库(默认仓库)\n      selectStore: true,\n      signData: {\n        //标识是仓库(030101)还是门店(030102)\n        orderType: \"\",\n        //组织机构\n        organization: \"\",\n        organizationCode: \"\",\n        //供应商\n        supplier: \"\",\n        //收货类型\n        deliveryType: \"\",\n        arrivalSn: \"\",\n        orderSn: \"\",\n        //收货仓库\n        warehouseCode: \"\",\n        warehouse: \"\",\n        //门店\n        storeName: '',\n        storeId: '',\n        //货主\n        goodsOwner: '',\n        expectTime: \"\",\n        //供货商编码\n        supplierCode: \"\",\n        contractNum: \"\",\n        //采购备注\n        remarks: \"\",\n        //采购单号\n        orderSnList: \"\",\n        //物流公司名称\n        logisticsCompany: \"\",\n        //物流编码\n        logisticsCompanyCode: \"\",\n        //商品数据表\n        channelPurchaseArrivalOrderGoodsVOList: []\n      },\n      rules: {\n        supplier: [{\n          required: true,\n          message: \"供货商不能为空\",\n          trigger: \"change\"\n        }],\n        orderSn: [{\n          required: true,\n          message: \"采购单号不能为空\",\n          trigger: \"change\"\n        }],\n        organization: [{\n          required: true,\n          message: \"组织机构不能为空\",\n          trigger: \"change\"\n        }],\n        deliveryType: [{\n          required: true,\n          message: \"收货类型不能为空\",\n          trigger: \"change\"\n        }],\n        arrivalSn: [{\n          required: true,\n          message: \"到货单号不能为空\",\n          trigger: \"change\"\n        }],\n        warehouse: [{\n          required: true,\n          message: \"仓库不能为空\",\n          trigger: \"change\"\n        }],\n        storeName: [{\n          required: true,\n          message: \"门店不能为空\",\n          trigger: \"change\"\n        }]\n      },\n      optionData: [],\n      //采购单号数据\n      OrderSnListData: [],\n      //收货仓库--合格的仓库\n      WarehouseCodeData: [],\n      //获取物流数据\n      logisticsListData: [],\n      //获取门店列表数据\n      storeListData: [],\n      //填写的优惠金额\n      price: \"\",\n      formInline: {\n        user: \"\",\n        region: \"\"\n      }\n    };\n  },\n  created: function created() {\n    //得到组织机构数据\n    this.getWarehouseListData(); //获取物流数据\n\n    this.getLogisticsList();\n\n    if (this.$route.query.orderSn) {\n      this.supplierNameStatus = true;\n      console.log(this.$route.query.orderSn);\n      this.getPurchasDetailListMsg(this.$route.query.orderSn);\n      return;\n    }\n  },\n  watch: {\n    \"signData.deliveryType\": function signDataDeliveryType(newValue) {\n      switch (newValue) {\n        case \"仓库收货\":\n          this.signData.orderType = \"030101\", this.selectStore = true;\n          this.signData.storeName = '';\n          this.signData.warehouse = '';\n          this.signData.storeId = '';\n          break;\n\n        case '门店收货':\n          this.signData.orderType = \"030102\", this.selectStore = false;\n          this.signData.warehouse = '';\n          this.signData.storeName = '';\n          this.signData.warehouseCode = '';\n          break;\n      }\n    }\n  },\n  methods: {\n    //得到组织机构数据\n    getWarehouseListData: function () {\n      var _getWarehouseListData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var info;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.request(this.api.user.get_userinfo, {}, true);\n\n              case 2:\n                info = _context.sent;\n                console.log(info); //得到部门Id\n\n                this.signData.relationDepId = info.departId;\n                this.request(this.api.user.userCompany_getUserOrgByUserId, {\n                  userId: info.userId,\n                  type: 0\n                }).then(function (data) {\n                  console.log(data); // this.organizationListData=data\n                  //得到机构\n\n                  _this.signData.organization = data.name; //得到机构code\n\n                  _this.signData.organizationCode = data.id; //得到供货商数据\n\n                  _this.getSupplierListData(_this.signData.organizationCode); //获取货主列表\n\n\n                  _this.getGoodsOwnerListData(_this.signData.organizationCode); //得到仓库数据\n\n\n                  _this.getWarehouseList(_this.signData.organizationCode); //得到门店列表数据\n\n\n                  _this.getStoreBasicListData(_this.signData.organizationCode);\n                });\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getWarehouseListData() {\n        return _getWarehouseListData.apply(this, arguments);\n      }\n\n      return getWarehouseListData;\n    }(),\n    //得到门店列表数据\n    getStoreBasicListData: function getStoreBasicListData(organizationId) {\n      var _this2 = this;\n\n      this.request(this.api.retailStore.storeBasic_listByOrganizationId, {\n        organizationId: organizationId\n      }).then(function (res) {\n        console.log(res);\n        _this2.storeListData = res;\n      });\n    },\n    //获取货主列表\n    getGoodsOwnerListData: function getGoodsOwnerListData(organizationId) {\n      var _this3 = this;\n\n      this.request(this.api.system.goodsOwner_list, {\n        orgId: organizationId\n      }).then(function (data) {\n        console.log(data.data);\n        _this3.signData.goodsOwner = data.data[0].code;\n      });\n    },\n    //得到表格数据\n    getPurchasDetailListMsg: function getPurchasDetailListMsg(orderSn) {\n      var _this4 = this;\n\n      this.request(this.api.order.channelPurchaseOrder_getByOrderSn, {\n        orderSn: orderSn,\n        pageIndex: '',\n        pageSize: ''\n      }).then(function (data) {\n        _this4.signData.supplier = data.supplier;\n        _this4.signData.orderSn = data.orderSn;\n        _this4.signData.supplierCode = data.supplierCode;\n\n        if (data.channelOrderGoodsVOList) {\n          data.channelOrderGoodsVOList.data.forEach(function (item) {\n            item.tax = data.tax;\n            item.amount = item.num * item.actualAmount;\n          });\n        }\n\n        _this4.signData.channelPurchaseArrivalOrderGoodsVOList = data.channelOrderGoodsVOList.data;\n      });\n    },\n    //获取物流数据\n    getLogisticsList: function getLogisticsList() {\n      var _this5 = this;\n\n      this.request(this.api.order.expressCompany_list, {}).then(function (data) {\n        console.log(data);\n        _this5.logisticsListData = data.data;\n      });\n    },\n    //得到仓库列表\n    getWarehouseList: function getWarehouseList(orgId) {\n      var _this6 = this;\n\n      console.log(orgId);\n      this.request(this.api.system.warehouse_list, {\n        used: true,\n        orgId: orgId\n      }).then(function (data) {\n        console.log(data);\n        _this6.WarehouseCodeData = data.data;\n      });\n    },\n    //得到物流编码\n    selectLogisticsData: function selectLogisticsData(val) {\n      var logisticsCode = this.logisticsListData.find(function (item) {\n        return item.company == val;\n      }).code;\n      this.signData.logisticsCompanyCode = logisticsCode;\n    },\n    //得到采购单号的数据\n    getOrderSnListData: function getOrderSnListData(supplierId) {\n      var _this7 = this;\n\n      this.request(this.api.order.channelPurchaseArrivalOrder_orderSnList, {\n        supplierCode: supplierId\n      }).then(function (data) {\n        console.log(data);\n        _this7.OrderSnListData = data;\n      });\n    },\n    //得到供货商数据\n    getSupplierListData: function getSupplierListData(organizationId) {\n      var _this8 = this;\n\n      console.log(246);\n      this.request(this.api.product.supplier_list, {\n        organizationId: organizationId,\n        cooperation: true\n      }).then(function (data) {\n        console.log(data);\n        _this8.optionData = data.data;\n      });\n    },\n    //采购单号,渲染列表数据\n    selectOrderSnListDataChange: function selectOrderSnListDataChange(val) {\n      var _this9 = this;\n\n      this.request(this.api.order.channelPurchaseArrivalOrder_goods, {\n        orderSn: val\n      }).then(function (data) {\n        console.log(data);\n        _this9.shopAllQuantity = 0;\n        _this9.signData.channelPurchaseArrivalOrderGoodsVOList = data;\n      });\n    },\n    //存储供应商编码\n    selectSupplierChange: function selectSupplierChange(val) {\n      this.signData.orderSn = \"\";\n      console.log(val);\n      this.supplierStatus = false;\n      var suppliceObj = this.optionData.find(function (item) {\n        return item.name == val;\n      });\n      this.signData.supplierCode = suppliceObj.code;\n      this.getOrderSnListData(suppliceObj.code);\n    },\n    //收货仓库\n    selectwarehouseCodeChange: function selectwarehouseCodeChange(val) {\n      var warehouseObj = this.WarehouseCodeData.find(function (item) {\n        return item.name == val;\n      });\n      this.signData.warehouseCode = warehouseObj.code;\n    },\n    //收货门店\n    selectStoreNameChange: function selectStoreNameChange(val) {\n      var storeId = this.storeListData.find(function (item) {\n        return item.name == val;\n      }).id;\n      this.signData.warehouse = this.signData.storeName;\n      this.signData.warehouseCode = storeId;\n    },\n    //价格变化事件\n    priceInputChangeEvent: function priceInputChangeEvent() {\n      console.log(this.price);\n    },\n    //选择支付方式\n    paySelectWay: function paySelectWay(item) {\n      console.log(item);\n    },\n    //确认按钮的点击事件\n    primaryBtnClick: function primaryBtnClick() {\n      var _this10 = this;\n\n      console.log(\"primaryBtnClick\");\n      this.signData.channelPurchaseArrivalOrderGoodsVOList.forEach(function (item) {\n        item.quantity = item.num;\n\n        if (!item.actualQuantity) {\n          item.actualQuantity = 0;\n        }\n      });\n      var filterData = this.signData.channelPurchaseArrivalOrderGoodsVOList.filter(function (item) {\n        return item.currentQuantity && item.currentQuantity != \"0\";\n      });\n\n      if (filterData.length > 0) {} else {\n        this.$message.error('到货数量不能全部为0');\n        return;\n      }\n\n      this.$refs.ruleForm.validate(function (valid) {\n        if (valid) {\n          switch (_this10.signData.deliveryType) {\n            case \"仓库收货\":\n              _this10.showBoxTipMsg(\"收货仓库：\");\n\n              break;\n\n            case \"门店收货\":\n              _this10.showBoxTipMsg(\"收货门店：\");\n\n              break;\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    //弹框提示(仓库或门店)\n    showBoxTipMsg: function showBoxTipMsg(name, fileteData) {\n      var _this11 = this;\n\n      this.$confirm(\"确认后，\" + name + this.signData.warehouse + \",将收到采购到货单？\", \"确认到货通知\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        _this11.saveWarehouseDataOrStoreData();\n      }).catch(function (action) {});\n    },\n    //仓库或门店收货接口\n    saveWarehouseDataOrStoreData: function saveWarehouseDataOrStoreData() {\n      var _this12 = this;\n\n      console.log(\"saveWarehouseDataOrStoreData\");\n      this.signData.channelPurchaseArrivalOrderGoodsVOList = this.signData.channelPurchaseArrivalOrderGoodsVOList.filter(function (item) {\n        return item.currentQuantity && item.currentQuantity != \"0\";\n      }); // this.signData.channelPurchaseArrivalOrderGoodsVOList.forEach(item => {\n      //   item.currentQuantity=item.arrivalQuantity\n      // });\n\n      console.log(\"saveWarehouseData\");\n      this.request(this.api.order.channelPurchaseArrivalOrder_insert, this.signData).then(function (data) {\n        _this12.signData.channelPurchaseArrivalOrderGoodsVOList = []; //此处应该时上传成功后，再删除\n\n        localStorage.removeItem(\"localTableData\");\n\n        _this12.$router.go(-1);\n      });\n    },\n    //取消按钮的点击事件\n    plainBtnClick: function plainBtnClick() {\n      this.$router.go(-1);\n    },\n    //当前商品数量发生改变了\n    shopNumberChange: function shopNumberChange(count, row) {\n      var _this13 = this;\n\n      console.log(\"227===========count\"); // row.actualQuantity = count;\n      // console.log(this.signData.channelPurchaseArrivalOrderGoodsVOList);\n\n      this.shopAllQuantity = 0;\n      this.signData.channelPurchaseArrivalOrderGoodsVOList.forEach(function (item) {\n        if (item.currentQuantity) {\n          _this13.shopAllQuantity += parseFloat(item.currentQuantity);\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["arrivalNotice_add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuMA,OAAA,OAAA,MAAA,sBAAA;AACA,OAAA,QAAA,MAAA,uBAAA;AACA,SAAA,SAAA,QAAA,QAAA;AACA,eAAA;AACA,EAAA,UAAA,EAAA;AACA,IAAA,OAAA,EAAA,OADA;AAEA,IAAA,QAAA,EAAA;AAFA,GADA;AAKA,EAAA,IALA,kBAKA;AACA,WAAA;AACA;AACA,MAAA,eAAA,EAAA,CAFA;AAGA;AACA,MAAA,cAAA,EAAA,IAJA;AAKA;AACA,MAAA,kBAAA,EAAA,KANA;AAOA;AACA,MAAA,WAAA,EAAA,IARA;AASA,MAAA,QAAA,EAAA;AACA;AACA,QAAA,SAAA,EAAA,EAFA;AAGA;AACA,QAAA,YAAA,EAAA,EAJA;AAKA,QAAA,gBAAA,EAAA,EALA;AAMA;AACA,QAAA,QAAA,EAAA,EAPA;AAQA;AACA,QAAA,YAAA,EAAA,EATA;AAUA,QAAA,SAAA,EAAA,EAVA;AAWA,QAAA,OAAA,EAAA,EAXA;AAYA;AACA,QAAA,aAAA,EAAA,EAbA;AAcA,QAAA,SAAA,EAAA,EAdA;AAeA;AACA,QAAA,SAAA,EAAA,EAhBA;AAiBA,QAAA,OAAA,EAAA,EAjBA;AAkBA;AACA,QAAA,UAAA,EAAA,EAnBA;AAoBA,QAAA,UAAA,EAAA,EApBA;AAqBA;AACA,QAAA,YAAA,EAAA,EAtBA;AAuBA,QAAA,WAAA,EAAA,EAvBA;AAwBA;AACA,QAAA,OAAA,EAAA,EAzBA;AA0BA;AACA,QAAA,WAAA,EAAA,EA3BA;AA4BA;AACA,QAAA,gBAAA,EAAA,EA7BA;AA8BA;AACA,QAAA,oBAAA,EAAA,EA/BA;AAgCA;AACA,QAAA,sCAAA,EAAA;AAjCA,OATA;AA4CA,MAAA,KAAA,EAAA;AACA,QAAA,QAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,SAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CADA;AAIA,QAAA,OAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,UAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CAJA;AAOA,QAAA,YAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,UAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CAPA;AAUA,QAAA,YAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,UAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CAVA;AAaA,QAAA,SAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,UAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CAbA;AAgBA,QAAA,SAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,QAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,CAhBA;AAmBA,QAAA,SAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,QAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA;AAnBA,OA5CA;AAmEA,MAAA,UAAA,EAAA,EAnEA;AAoEA;AACA,MAAA,eAAA,EAAA,EArEA;AAsEA;AACA,MAAA,iBAAA,EAAA,EAvEA;AAwEA;AACA,MAAA,iBAAA,EAAA,EAzEA;AA0EA;AACA,MAAA,aAAA,EAAA,EA3EA;AA4EA;AACA,MAAA,KAAA,EAAA,EA7EA;AA8EA,MAAA,UAAA,EAAA;AACA,QAAA,IAAA,EAAA,EADA;AAEA,QAAA,MAAA,EAAA;AAFA;AA9EA,KAAA;AAmFA,GAzFA;AA0FA,EAAA,OA1FA,qBA0FA;AACA;AACA,SAAA,oBAAA,GAFA,CAGA;;AACA,SAAA,gBAAA;;AACA,QAAA,KAAA,MAAA,CAAA,KAAA,CAAA,OAAA,EAAA;AACA,WAAA,kBAAA,GAAA,IAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,MAAA,CAAA,KAAA,CAAA,OAAA;AACA,WAAA,uBAAA,CAAA,KAAA,MAAA,CAAA,KAAA,CAAA,OAAA;AACA;AACA;AACA,GArGA;AAsGA,EAAA,KAAA,EAAA;AACA,6BAAA,8BAAA,QAAA,EAAA;AACA,cAAA,QAAA;AACA,aAAA,MAAA;AACA,eAAA,QAAA,CAAA,SAAA,GAAA,QAAA,EACA,KAAA,WAAA,GAAA,IADA;AAEA,eAAA,QAAA,CAAA,SAAA,GAAA,EAAA;AACA,eAAA,QAAA,CAAA,SAAA,GAAA,EAAA;AACA,eAAA,QAAA,CAAA,OAAA,GAAA,EAAA;AACA;;AACA,aAAA,MAAA;AACA,eAAA,QAAA,CAAA,SAAA,GAAA,QAAA,EACA,KAAA,WAAA,GAAA,KADA;AAEA,eAAA,QAAA,CAAA,SAAA,GAAA,EAAA;AACA,eAAA,QAAA,CAAA,SAAA,GAAA,EAAA;AACA,eAAA,QAAA,CAAA,aAAA,GAAA,EAAA;AACA;AAdA;AAgBA;AAlBA,GAtGA;AA0HA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,oBAFA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAGA,KAAA,OAAA,CAAA,KAAA,GAAA,CAAA,IAAA,CAAA,YAAA,EAAA,EAAA,EAAA,IAAA,CAHA;;AAAA;AAGA,gBAAA,IAHA;AAIA,gBAAA,OAAA,CAAA,GAAA,CAAA,IAAA,EAJA,CAKA;;AACA,qBAAA,QAAA,CAAA,aAAA,GAAA,IAAA,CAAA,QAAA;AAEA,qBAAA,OAAA,CAAA,KAAA,GAAA,CAAA,IAAA,CAAA,8BAAA,EAAA;AACA,kBAAA,MAAA,EAAA,IAAA,CAAA,MADA;AAEA,kBAAA,IAAA,EAAA;AAFA,iBAAA,EAGA,IAHA,CAGA,UAAA,IAAA,EAAA;AACA,kBAAA,OAAA,CAAA,GAAA,CAAA,IAAA,EADA,CAEA;AACA;;AACA,kBAAA,KAAA,CAAA,QAAA,CAAA,YAAA,GAAA,IAAA,CAAA,IAAA,CAJA,CAKA;;AACA,kBAAA,KAAA,CAAA,QAAA,CAAA,gBAAA,GAAA,IAAA,CAAA,EAAA,CANA,CAOA;;AACA,kBAAA,KAAA,CAAA,mBAAA,CAAA,KAAA,CAAA,QAAA,CAAA,gBAAA,EARA,CASA;;;AACA,kBAAA,KAAA,CAAA,qBAAA,CAAA,KAAA,CAAA,QAAA,CAAA,gBAAA,EAVA,CAWA;;;AACA,kBAAA,KAAA,CAAA,gBAAA,CAAA,KAAA,CAAA,QAAA,CAAA,gBAAA,EAZA,CAaA;;;AACA,kBAAA,KAAA,CAAA,qBAAA,CAAA,KAAA,CAAA,QAAA,CAAA,gBAAA;AACA,iBAlBA;;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA4BA;AACA,IAAA,qBA7BA,iCA6BA,cA7BA,EA6BA;AAAA;;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,CAAA,WAAA,CAAA,+BAAA,EAAA;AAAA,QAAA,cAAA,EAAA;AAAA,OAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,QAAA,MAAA,CAAA,aAAA,GAAA,GAAA;AACA,OAHA;AAIA,KAlCA;AAmCA;AACA,IAAA,qBApCA,iCAoCA,cApCA,EAoCA;AAAA;;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,CAAA,MAAA,CAAA,eAAA,EAAA;AACA,QAAA,KAAA,EAAA;AADA,OAAA,EAEA,IAFA,CAEA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,IAAA,CAAA,IAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,UAAA,GAAA,IAAA,CAAA,IAAA,CAAA,CAAA,EAAA,IAAA;AACA,OALA;AAMA,KA3CA;AA4CA;AACA,IAAA,uBA7CA,mCA6CA,OA7CA,EA6CA;AAAA;;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,CAAA,KAAA,CAAA,iCAAA,EAAA;AACA,QAAA,OAAA,EAAA,OADA;AAEA,QAAA,SAAA,EAAA,EAFA;AAGA,QAAA,QAAA,EAAA;AAHA,OAAA,EAIA,IAJA,CAIA,UAAA,IAAA,EAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,QAAA,GAAA,IAAA,CAAA,QAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,OAAA,GAAA,IAAA,CAAA,OAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,YAAA,GAAA,IAAA,CAAA,YAAA;;AACA,YAAA,IAAA,CAAA,uBAAA,EAAA;AACA,UAAA,IAAA,CAAA,uBAAA,CAAA,IAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,YAAA,IAAA,CAAA,GAAA,GAAA,IAAA,CAAA,GAAA;AACA,YAAA,IAAA,CAAA,MAAA,GAAA,IAAA,CAAA,GAAA,GAAA,IAAA,CAAA,YAAA;AACA,WAHA;AAIA;;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,sCAAA,GAAA,IAAA,CAAA,uBAAA,CAAA,IAAA;AACA,OAfA;AAgBA,KA9DA;AA+DA;AACA,IAAA,gBAhEA,8BAgEA;AAAA;;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,CAAA,KAAA,CAAA,mBAAA,EAAA,EAAA,EAAA,IAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,QAAA,MAAA,CAAA,iBAAA,GAAA,IAAA,CAAA,IAAA;AACA,OAHA;AAIA,KArEA;AAsEA;AACA,IAAA,gBAvEA,4BAuEA,KAvEA,EAuEA;AAAA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,CAAA,MAAA,CAAA,cAAA,EAAA;AACA,QAAA,IAAA,EAAA,IADA;AAEA,QAAA,KAAA,EAAA;AAFA,OAAA,EAGA,IAHA,CAGA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,QAAA,MAAA,CAAA,iBAAA,GAAA,IAAA,CAAA,IAAA;AACA,OANA;AAOA,KAhFA;AAiFA;AACA,IAAA,mBAlFA,+BAkFA,GAlFA,EAkFA;AACA,UAAA,aAAA,GAAA,KAAA,iBAAA,CAAA,IAAA,CACA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,OAAA,IAAA,GAAA;AAAA,OADA,EAEA,IAFA;AAGA,WAAA,QAAA,CAAA,oBAAA,GAAA,aAAA;AACA,KAvFA;AAwFA;AACA,IAAA,kBAzFA,8BAyFA,UAzFA,EAyFA;AAAA;;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,CAAA,KAAA,CAAA,uCAAA,EAAA;AACA,QAAA,YAAA,EAAA;AADA,OAAA,EAEA,IAFA,CAEA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,QAAA,MAAA,CAAA,eAAA,GAAA,IAAA;AACA,OALA;AAMA,KAhGA;AAiGA;AACA,IAAA,mBAlGA,+BAkGA,cAlGA,EAkGA;AAAA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,CAAA,OAAA,CAAA,aAAA,EAAA;AACA,QAAA,cAAA,EAAA,cADA;AAEA,QAAA,WAAA,EAAA;AAFA,OAAA,EAGA,IAHA,CAGA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,QAAA,MAAA,CAAA,UAAA,GAAA,IAAA,CAAA,IAAA;AACA,OANA;AAOA,KA3GA;AA4GA;AACA,IAAA,2BA7GA,uCA6GA,GA7GA,EA6GA;AAAA;;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,CAAA,KAAA,CAAA,iCAAA,EAAA;AACA,QAAA,OAAA,EAAA;AADA,OAAA,EAEA,IAFA,CAEA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,QAAA,MAAA,CAAA,eAAA,GAAA,CAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,sCAAA,GAAA,IAAA;AACA,OANA;AAOA,KArHA;AAsHA;AACA,IAAA,oBAvHA,gCAuHA,GAvHA,EAuHA;AACA,WAAA,QAAA,CAAA,OAAA,GAAA,EAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,WAAA,cAAA,GAAA,KAAA;AACA,UAAA,WAAA,GAAA,KAAA,UAAA,CAAA,IAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,IAAA,IAAA,GAAA;AAAA,OAAA,CAAA;AACA,WAAA,QAAA,CAAA,YAAA,GAAA,WAAA,CAAA,IAAA;AACA,WAAA,kBAAA,CAAA,WAAA,CAAA,IAAA;AACA,KA9HA;AA+HA;AACA,IAAA,yBAhIA,qCAgIA,GAhIA,EAgIA;AACA,UAAA,YAAA,GAAA,KAAA,iBAAA,CAAA,IAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,IAAA,IAAA,GAAA;AAAA,OAAA,CAAA;AACA,WAAA,QAAA,CAAA,aAAA,GAAA,YAAA,CAAA,IAAA;AACA,KAnIA;AAoIA;AACA,IAAA,qBArIA,iCAqIA,GArIA,EAqIA;AACA,UAAA,OAAA,GAAA,KAAA,aAAA,CAAA,IAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,IAAA,IAAA,GAAA;AAAA,OAAA,EAAA,EAAA;AACA,WAAA,QAAA,CAAA,SAAA,GAAA,KAAA,QAAA,CAAA,SAAA;AACA,WAAA,QAAA,CAAA,aAAA,GAAA,OAAA;AACA,KAzIA;AA0IA;AACA,IAAA,qBA3IA,mCA2IA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,KAAA;AACA,KA7IA;AA8IA;AACA,IAAA,YA/IA,wBA+IA,IA/IA,EA+IA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,KAjJA;AAkJA;AACA,IAAA,eAnJA,6BAmJA;AAAA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,iBAAA;AACA,WAAA,QAAA,CAAA,sCAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,IAAA,CAAA,QAAA,GAAA,IAAA,CAAA,GAAA;;AACA,YAAA,CAAA,IAAA,CAAA,cAAA,EAAA;AACA,UAAA,IAAA,CAAA,cAAA,GAAA,CAAA;AACA;AACA,OALA;AAOA,UAAA,UAAA,GAAA,KAAA,QAAA,CAAA,sCAAA,CAAA,MAAA,CAAA,UAAA,IAAA,EAAA;AACA,eAAA,IAAA,CAAA,eAAA,IAAA,IAAA,CAAA,eAAA,IAAA,GAAA;AACA,OAFA,CAAA;;AAGA,UAAA,UAAA,CAAA,MAAA,GAAA,CAAA,EAAA,CACA,CADA,MACA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,YAAA;AACA;AACA;;AACA,WAAA,KAAA,CAAA,QAAA,CAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,kBAAA,OAAA,CAAA,QAAA,CAAA,YAAA;AACA,iBAAA,MAAA;AACA,cAAA,OAAA,CAAA,aAAA,CAAA,OAAA;;AACA;;AACA,iBAAA,MAAA;AACA,cAAA,OAAA,CAAA,aAAA,CAAA,OAAA;;AACA;AANA;AAQA,SATA,MASA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,gBAAA;AACA,iBAAA,KAAA;AACA;AACA,OAdA;AAeA,KAnLA;AAoLA;AACA,IAAA,aArLA,yBAqLA,IArLA,EAqLA,UArLA,EAqLA;AAAA;;AACA,WAAA,QAAA,CACA,SAAA,IAAA,GAAA,KAAA,QAAA,CAAA,SAAA,GAAA,YADA,EAEA,QAFA,EAGA;AACA,QAAA,iBAAA,EAAA,IADA;AAEA,QAAA,gBAAA,EAAA,IAFA;AAGA,QAAA,IAAA,EAAA;AAHA,OAHA,EAQA,IARA,CAQA,YAAA;AACA,QAAA,OAAA,CAAA,4BAAA;AACA,OAVA,EAUA,KAVA,CAUA,UAAA,MAAA,EAAA,CAEA,CAZA;AAaA,KAnMA;AAoMA;AACA,IAAA,4BArMA,0CAqMA;AAAA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,8BAAA;AACA,WAAA,QAAA,CAAA,sCAAA,GAAA,KAAA,QAAA,CAAA,sCAAA,CAAA,MAAA,CAAA,UAAA,IAAA,EAAA;AACA,eAAA,IAAA,CAAA,eAAA,IAAA,IAAA,CAAA,eAAA,IAAA,GAAA;AACA,OAFA,CAAA,CAFA,CAKA;AACA;AACA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,mBAAA;AACA,WAAA,OAAA,CACA,KAAA,GAAA,CAAA,KAAA,CAAA,kCADA,EAEA,KAAA,QAFA,EAGA,IAHA,CAGA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,QAAA,CAAA,sCAAA,GAAA,EAAA,CADA,CAEA;;AACA,QAAA,YAAA,CAAA,UAAA,CAAA,gBAAA;;AACA,QAAA,OAAA,CAAA,OAAA,CAAA,EAAA,CAAA,CAAA,CAAA;AACA,OARA;AASA,KAvNA;AAwNA;AACA,IAAA,aAzNA,2BAyNA;AACA,WAAA,OAAA,CAAA,EAAA,CAAA,CAAA,CAAA;AACA,KA3NA;AA4NA;AACA,IAAA,gBA7NA,4BA6NA,KA7NA,EA6NA,GA7NA,EA6NA;AAAA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,qBAAA,EADA,CAEA;AACA;;AACA,WAAA,eAAA,GAAA,CAAA;AACA,WAAA,QAAA,CAAA,sCAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,YAAA,IAAA,CAAA,eAAA,EAAA;AACA,UAAA,OAAA,CAAA,eAAA,IAAA,UAAA,CAAA,IAAA,CAAA,eAAA,CAAA;AACA;AACA,OAJA;AAKA;AAvOA;AA1HA,CAAA","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"middle\">\r\n      <span>基本信息</span>\r\n      <div class=\"input-div\">\r\n        <el-form\r\n          ref=\"ruleForm\"\r\n          :inline=\"true\"\r\n          :model=\"signData\"\r\n          label-width=\"120px\"\r\n          :rules=\"rules\"\r\n          class=\"demo-ruleForm\"\r\n        >\r\n          <div class=\"data-div\">\r\n            <div>\r\n              <el-form-item label=\"组织机构：\" prop=\"organization\">\r\n                <el-input v-model=\"signData.organization\" disabled></el-input>\r\n              </el-form-item>\r\n              <br />\r\n              <el-form-item label=\"采购单号：\" prop=\"orderSn\">\r\n                <el-select\r\n                  :disabled=\"supplierStatus\"\r\n                  @change=\"selectOrderSnListDataChange\"\r\n                  v-model=\"signData.orderSn\"\r\n                  placeholder=\"请选择单号\"\r\n                >\r\n                  <el-option\r\n                    v-for=\"(item,index) in OrderSnListData\"\r\n                    :label=\"item\"\r\n                    :key=\"index\"\r\n                    :value=\"item\"\r\n                  ></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <br />\r\n              <el-form-item label=\"收货类型：\" prop=\"deliveryType\">\r\n                <el-select v-model=\"signData.deliveryType\" placeholder=\"请选择供应商\">\r\n                  <el-option value=\"仓库收货\"></el-option>\r\n                  <el-option value=\"门店收货\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <br />\r\n              <el-form-item label=\"物流公司：\">\r\n                <el-select\r\n                  v-model=\"signData.logisticsCompany\"\r\n                  @change=\"selectLogisticsData\"\r\n                  placeholder=\"请选择物流公司\"\r\n                >\r\n                  <el-option\r\n                    v-for=\"item in logisticsListData\"\r\n                    :label=\"item.company\"\r\n                    :key=\"item.id\"\r\n                    :value=\"item.company\"\r\n                  ></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <br />\r\n              <el-form-item label=\"物流单号：\">\r\n                <el-input placeholder=\"请输入内容\" v-model=\"signData.logisticsOrderSn\"></el-input>\r\n              </el-form-item>\r\n            </div>\r\n            <div>\r\n              <el-form-item label=\"供应商：\" prop=\"supplier\">\r\n                <el-select\r\n                  :disabled=\"supplierNameStatus\"\r\n                  @change=\"selectSupplierChange\"\r\n                  v-model=\"signData.supplier\"\r\n                  placeholder=\"请选择供应商\"\r\n                >\r\n                  <el-option\r\n                    v-for=\"item in optionData\"\r\n                    :label=\"item.name\"\r\n                    :key=\"item.id\"\r\n                    :value=\"item.name\"\r\n                  ></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <br />\r\n              <el-form-item label=\"到货单号：\" prop=\"arrivalSn\">\r\n                <el-input placeholder=\"请输入内容\" v-model=\"signData.arrivalSn\"></el-input>\r\n              </el-form-item>\r\n              <br />\r\n              <el-form-item label=\"收货仓库：\" prop=\"warehouse\" v-if=\"selectStore\">\r\n                <el-select\r\n                  @change=\"selectwarehouseCodeChange\"\r\n                  v-model=\"signData.warehouse\"\r\n                  placeholder=\"请选择仓库\"\r\n                >\r\n                  <el-option\r\n                    v-for=\"item in WarehouseCodeData\"\r\n                    :label=\"item.name\"\r\n                    :key=\"item.id\"\r\n                    :value=\"item.name\"\r\n                  ></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item label=\"收货门店：\" prop=\"storeName\" v-else>\r\n                <el-select\r\n                  @change=\"selectStoreNameChange\"\r\n                  v-model=\"signData.storeName\"\r\n                  placeholder=\"请选择门店\"\r\n                >\r\n                  <el-option\r\n                    v-for=\"item in storeListData\"\r\n                    :label=\"item.name\"\r\n                    :key=\"item.id\"\r\n                    :value=\"item.name\"\r\n                  ></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <br />\r\n              <el-form-item label=\"预计到货日期：\" prop>\r\n                <el-date-picker v-model=\"signData.expectTime\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\r\n              </el-form-item>\r\n            </div>\r\n          </div>\r\n        </el-form>\r\n      </div>\r\n\r\n      <div class=\"table-view\">\r\n        <div class=\"title-div\">\r\n          <span>选择到货商品</span>\r\n          <!-- <span @click=\"selectShopClickEvent\">选择商品</span> -->\r\n        </div>\r\n        <div class=\"table-div\">\r\n          <el-table\r\n            :data=\"signData.channelPurchaseArrivalOrderGoodsVOList\"\r\n            style=\"width: 100%\"\r\n            header-row-class-name=\"item-table-header\"\r\n            max-height=\"400\"\r\n          >\r\n            <el-table-column prop=\"productCode\" label=\"商品款号\" align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"code\" label=\"商品货号\" align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"image\" label=\"商品图片\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <img :src=\"scope.row.image\" style=\"width:32px;height:32px;\" />\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"name\" label=\"商品名称\" align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"brandName\" label=\"品牌\" align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"category\" label=\"商品品类\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{scope.row.category?scope.row.category:'--'}}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"specifications\" label=\"规格属性\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <div class=\"span-btn\">\r\n                  <span>颜色：{{scope.row.color}}</span>\r\n                  <span>尺码：{{scope.row.size}}</span>\r\n                </div>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"num\" label=\"采购总量\" align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"actualQuantity\" label=\"实收数量\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{scope.row.actualQuantity?scope.row.actualQuantity:'0'}}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"currentQuantity\" label=\"本次到货数量\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input\r\n                  @change=\"shopNumberChange($event,scope.row)\"\r\n                  min=\"0\"\r\n                  max=\"9\"\r\n                  type=\"number\"\r\n                  v-model=\"scope.row.currentQuantity\"\r\n                  placeholder=\"填写数量\"\r\n                  v-enter-number\r\n                ></el-input>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </div>\r\n        <span class=\"quantity-span\">累计到货总数：{{shopAllQuantity}}</span>\r\n      </div>\r\n      <div class=\"price-msg\">\r\n        <span class=\"other-msg\">其他信息</span>\r\n        <div class=\"remarks-textarea\">\r\n          <span>采购备注：</span>\r\n          <el-input\r\n            class=\"textarea\"\r\n            type=\"textarea\"\r\n            :rows=\"2\"\r\n            placeholder=\"请输入内容\"\r\n            v-model=\"signData.remarks\"\r\n            resize=\"none\"\r\n          ></el-input>\r\n        </div>\r\n        <div class=\"btn-div\">\r\n          <el-button type=\"primary\" @click=\"primaryBtnClick\" size=\"small\">确认</el-button>\r\n          <el-button plain @click=\"plainBtnClick\" size=\"small\">取消</el-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport codeSet from \"@/components/codeSet\";\r\nimport treeDept from \"@/components/treeDept\";\r\nimport { constants } from \"crypto\";\r\nexport default {\r\n  components: {\r\n    codeSet,\r\n    treeDept\r\n  },\r\n  data() {\r\n    return {\r\n      //标识到货总数\r\n      shopAllQuantity:0,\r\n      //采购订单号标识\r\n      supplierStatus: true,\r\n      //供应商标识\r\n      supplierNameStatus: false,\r\n      //标识门店或仓库(默认仓库)\r\n      selectStore:true,\r\n      signData: {\r\n        //标识是仓库(030101)还是门店(030102)\r\n        orderType:\"\",\r\n        //组织机构\r\n        organization: \"\",\r\n        organizationCode: \"\",\r\n        //供应商\r\n        supplier: \"\",\r\n        //收货类型\r\n        deliveryType: \"\",\r\n        arrivalSn: \"\",\r\n        orderSn: \"\",\r\n        //收货仓库\r\n        warehouseCode: \"\",\r\n        warehouse: \"\",\r\n        //门店\r\n        storeName:'',\r\n        storeId:'',\r\n        //货主\r\n        goodsOwner:'',\r\n        expectTime: \"\",\r\n        //供货商编码\r\n        supplierCode: \"\",\r\n        contractNum: \"\",\r\n        //采购备注\r\n        remarks: \"\",\r\n        //采购单号\r\n        orderSnList: \"\",\r\n        //物流公司名称\r\n        logisticsCompany: \"\",\r\n        //物流编码\r\n        logisticsCompanyCode: \"\",\r\n        //商品数据表\r\n        channelPurchaseArrivalOrderGoodsVOList: []\r\n      },\r\n      rules: {\r\n        supplier: [\r\n          { required: true, message: \"供货商不能为空\", trigger: \"change\" }\r\n        ],\r\n        orderSn: [\r\n          { required: true, message: \"采购单号不能为空\", trigger: \"change\" }\r\n        ],\r\n        organization: [\r\n          { required: true, message: \"组织机构不能为空\", trigger: \"change\" }\r\n        ],\r\n        deliveryType: [\r\n          { required: true, message: \"收货类型不能为空\", trigger: \"change\" }\r\n        ],\r\n        arrivalSn: [\r\n          { required: true, message: \"到货单号不能为空\", trigger: \"change\" }\r\n        ],\r\n        warehouse: [\r\n          { required: true, message: \"仓库不能为空\", trigger: \"change\" }\r\n        ],\r\n        storeName: [\r\n          { required: true, message: \"门店不能为空\", trigger: \"change\" }\r\n        ]\r\n      },\r\n      optionData: [],\r\n      //采购单号数据\r\n      OrderSnListData: [],\r\n      //收货仓库--合格的仓库\r\n      WarehouseCodeData: [],\r\n      //获取物流数据\r\n      logisticsListData: [],\r\n      //获取门店列表数据\r\n      storeListData:[],\r\n      //填写的优惠金额\r\n      price: \"\",\r\n      formInline: {\r\n        user: \"\",\r\n        region: \"\"\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n    //得到组织机构数据\r\n    this.getWarehouseListData();\r\n    //获取物流数据\r\n    this.getLogisticsList();\r\n    if (this.$route.query.orderSn) {\r\n      this.supplierNameStatus = true;\r\n      console.log(this.$route.query.orderSn);\r\n      this.getPurchasDetailListMsg(this.$route.query.orderSn);\r\n      return;\r\n    }\r\n  },\r\n  watch: {\r\n    \"signData.deliveryType\":function(newValue){\r\n      switch (newValue) {\r\n        case \"仓库收货\":\r\n          this.signData.orderType=\"030101\",\r\n          this.selectStore=true\r\n          this.signData.storeName=''\r\n          this.signData.warehouse=''\r\n          this.signData.storeId=''\r\n          break;\r\n        case '门店收货':\r\n          this.signData.orderType=\"030102\",\r\n          this.selectStore=false\r\n          this.signData.warehouse=''\r\n          this.signData.storeName=''\r\n          this.signData.warehouseCode=''\r\n          break;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    //得到组织机构数据\r\n    async getWarehouseListData() {\r\n      let info = await this.request(this.api.user.get_userinfo, {}, true);\r\n      console.log(info);\r\n      //得到部门Id\r\n      this.signData.relationDepId = info.departId;\r\n\r\n      this.request(this.api.user.userCompany_getUserOrgByUserId, {\r\n        userId: info.userId,\r\n        type: 0\r\n      }).then(data => {\r\n        console.log(data);\r\n        // this.organizationListData=data\r\n        //得到机构\r\n        this.signData.organization = data.name;\r\n        //得到机构code\r\n        this.signData.organizationCode = data.id;\r\n        //得到供货商数据\r\n        this.getSupplierListData(this.signData.organizationCode);\r\n        //获取货主列表\r\n        this.getGoodsOwnerListData(this.signData.organizationCode);\r\n        //得到仓库数据\r\n        this.getWarehouseList(this.signData.organizationCode);\r\n        //得到门店列表数据\r\n        this.getStoreBasicListData(this.signData.organizationCode)\r\n      });\r\n    },\r\n    //得到门店列表数据\r\n    getStoreBasicListData(organizationId){\r\n      this.request(this.api.retailStore.storeBasic_listByOrganizationId,{organizationId:organizationId}).then(res=>{\r\n        console.log(res)\r\n        this.storeListData=res\r\n      })\r\n    },\r\n    //获取货主列表\r\n    getGoodsOwnerListData(organizationId) {\r\n      this.request(this.api.system.goodsOwner_list, {\r\n        orgId: organizationId\r\n      }).then(data => {\r\n        console.log(data.data);\r\n        this.signData.goodsOwner = data.data[0].code;\r\n      });\r\n    },\r\n    //得到表格数据\r\n    getPurchasDetailListMsg(orderSn) {\r\n      this.request(this.api.order.channelPurchaseOrder_getByOrderSn, {\r\n        orderSn: orderSn,\r\n        pageIndex:'',\r\n        pageSize:''\r\n      }).then(data => {\r\n        this.signData.supplier = data.supplier;\r\n        this.signData.orderSn = data.orderSn;\r\n        this.signData.supplierCode = data.supplierCode;\r\n        if (data.channelOrderGoodsVOList) {\r\n          data.channelOrderGoodsVOList.data.forEach(item => {\r\n            item.tax = data.tax;\r\n            item.amount = item.num * item.actualAmount;\r\n          });\r\n        }\r\n        this.signData.channelPurchaseArrivalOrderGoodsVOList = data.channelOrderGoodsVOList.data;\r\n      });\r\n    },\r\n    //获取物流数据\r\n    getLogisticsList() {\r\n      this.request(this.api.order.expressCompany_list, {}).then(data => {\r\n        console.log(data);\r\n        this.logisticsListData = data.data;\r\n      });\r\n    },\r\n    //得到仓库列表\r\n    getWarehouseList(orgId) {\r\n      console.log(orgId);\r\n      this.request(this.api.system.warehouse_list, {\r\n        used: true,\r\n        orgId: orgId\r\n      }).then(data => {\r\n        console.log(data);\r\n        this.WarehouseCodeData = data.data;\r\n      });\r\n    },\r\n    //得到物流编码\r\n    selectLogisticsData(val) {\r\n      var logisticsCode = this.logisticsListData.find(\r\n        item => item.company == val\r\n      ).code;\r\n      this.signData.logisticsCompanyCode = logisticsCode;\r\n    },\r\n    //得到采购单号的数据\r\n    getOrderSnListData(supplierId) {\r\n      this.request(this.api.order.channelPurchaseArrivalOrder_orderSnList, {\r\n        supplierCode: supplierId\r\n      }).then(data => {\r\n        console.log(data);\r\n        this.OrderSnListData = data;\r\n      });\r\n    },\r\n    //得到供货商数据\r\n    getSupplierListData(organizationId) {\r\n      console.log(246);\r\n      this.request(this.api.product.supplier_list, {\r\n        organizationId: organizationId,\r\n        cooperation: true\r\n      }).then(data => {\r\n        console.log(data);\r\n        this.optionData = data.data;\r\n      });\r\n    },\r\n    //采购单号,渲染列表数据\r\n    selectOrderSnListDataChange(val) {\r\n      this.request(this.api.order.channelPurchaseArrivalOrder_goods, {\r\n        orderSn: val\r\n      }).then(data => {\r\n        console.log(data);\r\n        this.shopAllQuantity=0\r\n        this.signData.channelPurchaseArrivalOrderGoodsVOList = data;\r\n      });\r\n    },\r\n    //存储供应商编码\r\n    selectSupplierChange(val) {\r\n      this.signData.orderSn = \"\";\r\n      console.log(val);\r\n      this.supplierStatus = false;\r\n      let suppliceObj = this.optionData.find(item => item.name == val);\r\n      this.signData.supplierCode = suppliceObj.code;\r\n      this.getOrderSnListData(suppliceObj.code);\r\n    },\r\n    //收货仓库\r\n    selectwarehouseCodeChange(val) {\r\n      let warehouseObj = this.WarehouseCodeData.find(item => item.name == val);\r\n      this.signData.warehouseCode = warehouseObj.code;\r\n    },\r\n    //收货门店\r\n    selectStoreNameChange(val){\r\n      let storeId = this.storeListData.find(item => item.name == val).id;\r\n      this.signData.warehouse=this.signData.storeName\r\n      this.signData.warehouseCode = storeId;\r\n    },\r\n    //价格变化事件\r\n    priceInputChangeEvent() {\r\n      console.log(this.price);\r\n    },\r\n    //选择支付方式\r\n    paySelectWay(item) {\r\n      console.log(item);\r\n    },\r\n    //确认按钮的点击事件\r\n    primaryBtnClick() {\r\n      console.log(\"primaryBtnClick\");\r\n      this.signData.channelPurchaseArrivalOrderGoodsVOList.forEach(item => {\r\n        item.quantity = item.num;\r\n        if (!item.actualQuantity) {\r\n          item.actualQuantity = 0;\r\n        }\r\n      });\r\n\r\n      var filterData = this.signData.channelPurchaseArrivalOrderGoodsVOList.filter(item=>{\r\n        return item.currentQuantity && item.currentQuantity!=\"0\"\r\n      })\r\n      if(filterData.length>0){\r\n      }else{\r\n        this.$message.error('到货数量不能全部为0');\r\n        return\r\n      }\r\n      this.$refs.ruleForm.validate(valid => {\r\n        if (valid) {\r\n          switch (this.signData.deliveryType) {\r\n            case \"仓库收货\":\r\n              this.showBoxTipMsg(\"收货仓库：\")\r\n              break;\r\n            case \"门店收货\":\r\n              this.showBoxTipMsg(\"收货门店：\")\r\n              break;\r\n          }\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //弹框提示(仓库或门店)\r\n    showBoxTipMsg(name,fileteData){\r\n      this.$confirm(\r\n        \"确认后，\"+name+this.signData.warehouse+\",将收到采购到货单？\",\r\n        \"确认到货通知\",\r\n        {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\"\r\n        }\r\n      ).then(() => {\r\n        this.saveWarehouseDataOrStoreData()\r\n      }).catch(action=>{\r\n\r\n      })\r\n    },\r\n    //仓库或门店收货接口\r\n    saveWarehouseDataOrStoreData() {\r\n      console.log(\"saveWarehouseDataOrStoreData\")\r\n      this.signData.channelPurchaseArrivalOrderGoodsVOList=this.signData.channelPurchaseArrivalOrderGoodsVOList.filter(item=>{\r\n        return item.currentQuantity && item.currentQuantity!=\"0\"\r\n      })\r\n      // this.signData.channelPurchaseArrivalOrderGoodsVOList.forEach(item => {\r\n      //   item.currentQuantity=item.arrivalQuantity\r\n      // });\r\n      console.log(\"saveWarehouseData\")\r\n      this.request(\r\n        this.api.order.channelPurchaseArrivalOrder_insert,\r\n        this.signData\r\n      ).then(data => {\r\n        this.signData.channelPurchaseArrivalOrderGoodsVOList = [];\r\n        //此处应该时上传成功后，再删除\r\n        localStorage.removeItem(\"localTableData\");\r\n        this.$router.go(-1);\r\n      });\r\n    },\r\n    //取消按钮的点击事件\r\n    plainBtnClick() {\r\n      this.$router.go(-1);\r\n    },\r\n    //当前商品数量发生改变了\r\n    shopNumberChange(count, row) {\r\n      console.log(\"227===========count\");\r\n      // row.actualQuantity = count;\r\n      // console.log(this.signData.channelPurchaseArrivalOrderGoodsVOList);\r\n      this.shopAllQuantity=0\r\n      this.signData.channelPurchaseArrivalOrderGoodsVOList.forEach(item => {\r\n        if(item.currentQuantity){\r\n          this.shopAllQuantity+=parseFloat(item.currentQuantity)\r\n        }\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/* .treeDept{\r\n backgroun\r\n} */\r\n.input-div {\r\n  .data-div {\r\n    width: 100%;\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 120px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n  .last-data-div {\r\n    width: 100%;\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 110px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n  .orderNumber-div {\r\n    display: flex;\r\n    div:first-child {\r\n      margin-right: 104px;\r\n      // flex: 1;\r\n    }\r\n  }\r\n}\r\n.span-btn {\r\n  width: 100px;\r\n  text-align: center;\r\n}\r\n.recoment-input .contentInput {\r\n  display: inline-block;\r\n  width: 300px;\r\n}\r\n.remarks-textarea {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.remarks-textarea .textarea {\r\n  display: inline-block;\r\n  width: 300px;\r\n}\r\n.label-style {\r\n  display: inline-block;\r\n  width: 68px;\r\n}\r\n.title {\r\n  background-color: #fff;\r\n  padding: 15px 0 15px 30px;\r\n}\r\n.title > span {\r\n  display: inline-block;\r\n  background-color: #fff;\r\n  margin-left: 3px;\r\n}\r\n.middle {\r\n  background-color: #fff;\r\n  margin: 8px;\r\n  margin-bottom: 0;\r\n  height: 100%;\r\n}\r\n.middle > span {\r\n  display: inline-block;\r\n  margin: 20px 0 30px 30px;\r\n}\r\n.el-form-item__content {\r\n  line-height: 40px;\r\n  /* position: relative; */\r\n  font-size: 14px;\r\n  display: inline-block;\r\n  /* margin-right: 150px; */\r\n  // width: 300px;\r\n  white-space: nowrap;\r\n}\r\n.el-select {\r\n  display: inline-block;\r\n  /* position: relative; */\r\n  width: 130px;\r\n  margin-right: 10px;\r\n}\r\n.table-view {\r\n  /* margin-left: 30px; */\r\n  /* margin-bottom: 20px; */\r\n  padding: 0 30px;\r\n  background-color: #fff;\r\n}\r\n.title-div {\r\n  margin: 20px 0 30px;\r\n}\r\n.title-div span {\r\n  background-color: #409eff;\r\n  padding: 8px 20px;\r\n  color: #fff;\r\n  border-radius: 5px;\r\n}\r\n.title-div span:first-child {\r\n  background-color: #fff;\r\n  color: #222;\r\n  padding: 0 8px;\r\n  margin-right: 40px;\r\n}\r\n.money-div {\r\n  background-color: #fff;\r\n  width: 100%;\r\n  text-align: right;\r\n  padding-right: 30px;\r\n  margin-top: 30px;\r\n}\r\n.input-price {\r\n  display: inline-block;\r\n  padding: 10px;\r\n  width: 100px;\r\n  border-radius: 5px;\r\n}\r\n.money-content {\r\n  margin: 10px 0;\r\n}\r\n.price-msg {\r\n  padding: 30px;\r\n  background-color: #fff;\r\n}\r\n.price-msg > span {\r\n  display: inline-block;\r\n  margin-bottom: 20px;\r\n}\r\n.block {\r\n  display: flex;\r\n}\r\n.block > span {\r\n  display: inline-block;\r\n  margin-right: 10px;\r\n}\r\n\r\n.btn-div {\r\n  margin-left: 70px;\r\n  margin-top: 30px;\r\n}\r\n.division-type {\r\n  widows: 100%;\r\n  // background-color: aquamarine;\r\n  display: flex;\r\n  justify-items: center;\r\n}\r\n.quantity-span{\r\n  margin-top: 20px;\r\n  display: inline-block;\r\n  font-weight: 700;\r\n  text-align: right;\r\n  width: 100%;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/orders/business/purchase"}]}