{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\utils\\request.js","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\utils\\request.js","mtime":1572415126666},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858}],"contextDependencies":[],"result":["import _objectSpread from \"C:\\\\Users\\\\EDZ\\\\Desktop\\\\\\u7814\\u53D1\\u9879\\u76EE\\\\vue-project\\\\trunk\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport axios from 'axios';\nimport Router from '@/router/index';\nimport { Message, MessageBox, Loading, Notification } from 'element-ui';\nimport store from \"../store\";\nimport * as userTypes from '@/types/userConfig';\nimport { getToken, TokenKey } from '@/utils/auth'; // 创建axios实例\n\nvar service = axios.create({\n  baseURL: process.env.VUE_APP_API_ROOT,\n  timeout: 15000 // 请求超时时间\n\n}); // request拦截器  请求前  添加请求头在此添加\n\nservice.interceptors.request.use(function (config) {\n  var auth = config.auth;\n\n  if (auth || auth == undefined) {\n    config.headers[TokenKey] = getToken(); // 让每个请求携带自定义token 请根据实际情况自行修改\n\n    config.headers['Scope-Of-Use'] = 'platform/1.0 (Windows NT 10.0; Win64; x64)';\n  }\n\n  if (!config.noLoading) {\n    config.loadingIns = Loading.service({\n      lock: true,\n      text: '数据加载中...',\n      target: '.index-main',\n      spinner: 'lss-icon-doing'\n    });\n  }\n\n  if (config.form) {\n    config.headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n\n    if (config.data) {\n      config.transformRequest = function (data) {\n        var ret = '';\n\n        for (var it in data) {\n          ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&';\n        }\n\n        ret = ret.substr(0, ret.length - 1);\n        return ret;\n      };\n    }\n  }\n\n  return config;\n}, function (error) {\n  Promise.reject(error);\n}); //声明变量 处理多次拦截到登录过期\n\nvar toKenStatus = true; // respone拦截器 请求后 拦截返回的数据 统一处理\n\nservice.interceptors.response.use(function (response) {\n  var config = response.config;\n\n  if (config.loadingIns) {\n    config.loadingIns.close();\n  }\n\n  var res = response.data;\n\n  if (config.tip && res.code == 200) {\n    Notification({\n      title: res.message,\n      type: 'success',\n      duration: 1500\n    });\n  }\n\n  if (res.code !== 200) {\n    if (res.code == 401 || res.code == 403 || res.code == 10002 || res.code == 402) {\n      if (toKenStatus) {\n        toKenStatus = false;\n        MessageBox.confirm('你已被登出，可以取消继续留在该页面，或者重新登录', '确定登出', {\n          confirmButtonText: '重新登录',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          Router.replace({\n            path: '/login',\n            name: 'login'\n          });\n          store.dispatch(userTypes.FN_LOGOUT);\n          return false;\n        });\n      }\n    } else {\n      Notification({\n        title: '失败',\n        message: res.message,\n        type: 'error',\n        duration: 3 * 1000\n      });\n    }\n\n    return Promise.reject(res.message);\n  } else {\n    // console.log( response.data);\n    return response.data;\n  }\n}, function (error) {\n  var config = error.config;\n\n  if (config && config.loadingIns) {\n    config.loadingIns.close();\n  }\n\n  Notification({\n    title: '失败',\n    message: error.message,\n    type: 'error',\n    duration: 3 * 1000\n  });\n  return Promise.reject(error);\n});\n\nfunction auto(obj) {\n  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var noLoading = arguments.length > 2 ? arguments[2] : undefined;\n  var rst = {\n    url: \"\",\n    method: \"POST\",\n    form: false,\n    auth: true,\n    tip: false\n  };\n  Object.assign(rst, obj, {\n    noLoading: noLoading\n  });\n  rst.method = rst.method.toUpperCase();\n  return new Promise(function (resolve, reject) {\n    switch (rst.method) {\n      case \"POST\":\n        service.post(rst.url, params, _objectSpread({}, rst)).then(function (resp) {\n          return resolve(resp.data);\n        }, function (err) {\n          return reject(err);\n        }).catch(function (err) {\n          return reject(err);\n        });\n        break;\n\n      case \"PUT\":\n        service.put(rst.url, params, _objectSpread({}, rst)).then(function (resp) {\n          return resolve(resp.data);\n        }, function (err) {\n          return reject(err);\n        }).catch(function (err) {\n          return reject(err);\n        });\n        break;\n\n      case \"DELETE\":\n        service.delete(rst.url, _objectSpread({\n          params: params\n        }, rst)).then(function (resp) {\n          return resolve(resp.data);\n        }, function (err) {\n          return reject(err);\n        }).catch(function (err) {\n          return reject(err);\n        });\n        break;\n\n      case \"GET\":\n      default:\n        service.get(rst.url, _objectSpread({\n          params: params\n        }, rst)).then(function (resp) {\n          return resolve(resp.data);\n        }).catch(function (err) {\n          return reject(err);\n        });\n        break;\n    }\n  });\n}\n\nexport default {\n  install: function install(Vue) {\n    Vue.prototype.request = function (_path, params) {\n      var noLoading = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      return auto(_path, params, noLoading);\n    };\n  }\n};",{"version":3,"sources":["C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\utils\\request.js"],"names":["axios","Router","Message","MessageBox","Loading","Notification","store","userTypes","getToken","TokenKey","service","create","baseURL","process","env","VUE_APP_API_ROOT","timeout","interceptors","request","use","config","auth","undefined","headers","noLoading","loadingIns","lock","text","target","spinner","form","data","transformRequest","ret","it","encodeURIComponent","substr","length","error","Promise","reject","toKenStatus","response","close","res","tip","code","title","message","type","duration","confirm","confirmButtonText","cancelButtonText","then","replace","path","name","dispatch","FN_LOGOUT","auto","obj","params","rst","url","method","Object","assign","toUpperCase","resolve","post","resp","err","catch","put","delete","get","install","Vue","prototype","_path"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport Router from '@/router/index'\r\nimport { Message, MessageBox, Loading, Notification } from 'element-ui'\r\nimport store from '../store'\r\nimport * as userTypes from '@/types/userConfig'\r\nimport { getToken, TokenKey } from '@/utils/auth'\r\n// 创建axios实例\r\nconst service = axios.create({\r\n  baseURL: process.env.VUE_APP_API_ROOT,\r\n  timeout: 15000, // 请求超时时间\r\n})\r\n\r\n// request拦截器  请求前  添加请求头在此添加\r\nservice.interceptors.request.use(config => {\r\n  let auth = config.auth;\r\n  if (auth || auth == undefined) {\r\n    config.headers[TokenKey] = getToken(); // 让每个请求携带自定义token 请根据实际情况自行修改\r\n    config.headers['Scope-Of-Use'] = 'platform/1.0 (Windows NT 10.0; Win64; x64)'; \r\n  }\r\n  if(!config.noLoading){\r\n    config.loadingIns = Loading.service({\r\n      lock: true,\r\n      text: '数据加载中...',\r\n      target: '.index-main',\r\n      spinner: 'lss-icon-doing'\r\n    });\r\n  }\r\n  if (config.form) {\r\n    config.headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\r\n    if (config.data) {\r\n      config.transformRequest = data => {\r\n        let ret = ''\r\n        for (let it in data) {\r\n          ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&';\r\n        }\r\n        ret = ret.substr(0, ret.length - 1);\r\n        return ret;\r\n      }\r\n    }\r\n  }\r\n  return config\r\n}, error => {\r\n  Promise.reject(error)\r\n})\r\n//声明变量 处理多次拦截到登录过期\r\nlet toKenStatus=true;\r\n// respone拦截器 请求后 拦截返回的数据 统一处理\r\nservice.interceptors.response.use(\r\n  response => {\r\n    var config = response.config;\r\n    if (config.loadingIns) { config.loadingIns.close(); }\r\n    const res = response.data\r\n    if (config.tip && res.code == 200) {\r\n      Notification({\r\n        title: res.message,\r\n        type: 'success',\r\n        duration: 1500,\r\n      });\r\n    }\r\n    if (res.code !== 200) {\r\n      if (res.code == 401 || res.code == 403 || res.code == 10002 || res.code == 402) {\r\n        if(toKenStatus){\r\n          toKenStatus = false;\r\n          MessageBox.confirm('你已被登出，可以取消继续留在该页面，或者重新登录', '确定登出', {\r\n            confirmButtonText: '重新登录',\r\n            cancelButtonText: '取消',\r\n            type: 'warning'\r\n          }).then(() => {\r\n            Router.replace({\r\n              path:'/login',\r\n              name:'login'\r\n            })\r\n            store.dispatch(userTypes.FN_LOGOUT);\r\n            return false\r\n          })\r\n        }\r\n      } else {\r\n        Notification({\r\n          title: '失败',\r\n          message: res.message,\r\n          type: 'error',\r\n          duration: 3 * 1000\r\n        });\r\n      }\r\n      return Promise.reject(res.message);\r\n    } else {\r\n     // console.log( response.data);\r\n      return response.data\r\n    }\r\n  },\r\n  (error) => {\r\n    var config = error.config;\r\n    if (config && config.loadingIns) { config.loadingIns.close(); }\r\n    Notification({\r\n      title: '失败',\r\n      message: error.message,\r\n      type: 'error',\r\n      duration: 3 * 1000\r\n    });\r\n    return Promise.reject(error)\r\n  }\r\n)\r\nfunction auto(obj, params = {}, noLoading) {\r\n  let rst = { url: \"\", method: \"POST\", form: false, auth: true, tip: false }\r\n  Object.assign(rst, obj, { noLoading });\r\n  rst.method = rst.method.toUpperCase();\r\n  return new Promise((resolve, reject) => {\r\n    switch (rst.method) {\r\n      case \"POST\": service.post(rst.url, params, { ...rst }).then(resp => resolve(resp.data), err => reject(err)).catch(err => reject(err)); break;\r\n      case \"PUT\": service.put(rst.url, params, { ...rst }).then(resp => resolve(resp.data), err => reject(err)).catch(err => reject(err)); break;\r\n      case \"DELETE\": service.delete(rst.url, { params, ...rst }).then(resp => resolve(resp.data), err => reject(err)).catch(err => reject(err)); break;\r\n      case \"GET\":\r\n      default: service.get(rst.url, { params: params, ...rst }).then(resp => resolve(resp.data)).catch(err => reject(err)); break;\r\n    }\r\n  });\r\n}\r\n\r\nexport default {\r\n  install: function (Vue) {\r\n    Vue.prototype.request = (_path, params, noLoading = false) => auto(_path, params, noLoading)\r\n  }\r\n}"]}]}