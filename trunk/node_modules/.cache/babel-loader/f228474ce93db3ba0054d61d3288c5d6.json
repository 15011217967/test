{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\scb\\price\\price_edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\scb\\price\\price_edit.vue","mtime":1576239318030},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport { getToken } from \"@/utils/auth\";\nimport codeSet from \"@/components/codeSet\";\nimport treeDept from \"@/components/treeDept\";\nimport { filter } from \"minimatch\";\nimport { get } from \"http\";\nimport PageTable from \"@/views/collocation/components/PageTable\";\nvar token = getToken();\nexport default {\n  data: function data() {\n    return {\n      // 检索\n      filtersData: {\n        pageIndex: 1,\n        // 当前页码\n        pageSize: 10,\n        // 每页数量\n        \"orderBy\": \"\"\n      },\n      currentMerchantDiscountType: {\n        0: '不存在',\n        1: '当前折扣值',\n        2: '其他折扣值'\n      },\n      discountType: true,\n      dialogTableVisible: false,\n      classData: [],\n      classList: [],\n      cateArr: [],\n      cateArrs: [],\n      // 季节列表\n      codeItem_list_get: [],\n      // 全部品牌\n      brandOptions: [],\n      props: {\n        value: \"id\",\n        label: \"name\",\n        children: \"children\"\n      },\n      goodsList: {\n        data: []\n      },\n      // 商户详情\n      purchasingAgentPriceManagement_getById_data: {},\n      // 商品折扣列表\n      purchasingAgentDiscount_save_data: [],\n      // 选中某个折扣\n      checkDiscount_item: {},\n      // 检索全部商品\n      goodsFiltersData: {\n        // 当前页码\n        pageIndex: 1,\n        // 每页数量\n        pageSize: 10,\n        // 门店id\n        storeId: null,\n        // 折扣类型\n        type: null,\n        // 折扣值\n        discount: null,\n        // 品类id\n        cateIdentifier: null,\n        // 品牌id\n        brandId: null,\n        // 售价最小值\n        retailPriceGE: null,\n        // 售价最大值\n        retailPriceLE: null,\n        // 库存最小值\n        quantityLowerLimit: null,\n        // 库存最大值\n        quantityUpperLimit: null,\n        // 季节\n        seasonalStyleCode: null,\n        // 关键词\n        searchWords: null\n      },\n      id: this.$route.query.id,\n      labelPosition: 'right',\n      selectArr: [1, 2, 3],\n      goodsData: [{\n        name: 111\n      }, {\n        name: 111\n      }, {\n        name: 111\n      }],\n      formLabelAlign: {\n        name: '53424400GM',\n        region: '',\n        type: ''\n      }\n    };\n  },\n  created: function created() {\n    var that = this;\n    this.codeItem_list(); // 获取季节列表\n\n    this.purchasingAgentPriceManagement_getById(); // 获取商户详情\n\n    this.purchasingAgentDiscount_list(); // 获取折扣列表\n  },\n  methods: {\n    /**\r\n     * 返回折扣\r\n     */\n    backList: function backList() {\n      this.discountType = true;\n      this.purchasingAgentDiscount_list(); // 获取折扣列表\n    },\n\n    /**\r\n     * btn 添加商品\r\n     */\n    addProduct: function addProduct() {\n      this.dialogTableVisible = true;\n      Object.assign(this.filtersData, {\n        \"purchaseAgentId\": this.checkDiscount_item.purchaseAgentId,\n        \"productDiscountType\": \"1\",\n        \"productDiscountValue\": this.checkDiscount_item.productDiscountValue + ''\n      });\n      if (this.goodsList.data.length > 0) return;\n      this.purchasingAgentProduct_scbProductToProductDiscount(); // 添加SCB商品到商品折扣下\n    },\n\n    /**\r\n     * 移动到当前折扣\r\n     */\n    purchasingAgentDiscount_transferSPU: function purchasingAgentDiscount_transferSPU(item) {\n      var _this = this;\n\n      var that = this;\n      var text = \"\\u5C06\\u4ECE\\u201D\".concat(item.currentMerchantDiscountValue, \"\\u6298\\u201D\\u8F6C\\u79FB\\u5230\\u201C\").concat(this.checkDiscount_item.productDiscountValue, \"\\u6298\\u201D\\uFF0C\\u662F\\u5426\\u7EE7\\u7EED\\uFF1F\");\n      this.$confirm(text, '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this.request(_this.api.scb.purchasingAgentDiscount_transferSPU, {\n          \"priceManagementId\": _this.id,\n          \"productCode\": item.code,\n          \"productDiscountId\": _this.checkDiscount_item.id,\n          \"oldProductDiscountId\": item.currentMerchantDiscountId\n        }, true).then(function (res) {\n          _this.warn('移动成功！');\n\n          _this.purchasingAgentProduct_scbProductToProductDiscount(); // 刷新全部商品\n\n        });\n      }).catch(function () {\n        _this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n\n    /**\r\n     *btn 剔除\r\n     */\n    purchasingAgentDiscount_deleteSPUFromDiscount: function purchasingAgentDiscount_deleteSPUFromDiscount(item) {\n      var _this2 = this;\n\n      var that = this;\n      this.request(this.api.scb.purchasingAgentDiscount_deleteSPUFromDiscount, {\n        \"priceManagementId\": this.id,\n        \"productCode\": item.code,\n        \"productDiscountId\": this.checkDiscount_item.id\n      }, true).then(function (res) {\n        _this2.warn('剔除成功！');\n\n        _this2.purchasingAgentProduct_scbProductToProductDiscount(); // 刷新全部商品\n\n\n        _this2.purchasingAgentProduct_productDiscountProductList(); // 已添加折扣商品\n\n      });\n    },\n\n    /**\r\n     * 添加SCB商品到商品折扣下（全部商品）\r\n     */\n    purchasingAgentProduct_scbProductToProductDiscount: function purchasingAgentProduct_scbProductToProductDiscount() {\n      var that = this;\n      this.request(this.api.scb.purchasingAgentProduct_scbProductToProductDiscount, this.filtersData, true).then(function (res) {\n        that.goodsList = res;\n      });\n    },\n\n    /**\r\n     * 已添加折扣商品\r\n     */\n    purchasingAgentProduct_productDiscountProductList: function purchasingAgentProduct_productDiscountProductList(item) {\n      var _this3 = this;\n\n      var that = this;\n      this.request(this.api.scb.purchasingAgentProduct_productDiscountProductList, {\n        \"productDiscountId\": this.checkDiscount_item.id\n      }, true).then(function (res) {\n        _this3.goodsData = res;\n        res.data.forEach(function (item) {\n          item._cateNames = item.cateNames.join('、');\n        });\n      });\n    },\n\n    /**\r\n     * 添加SPU商品到此折扣下\r\n     */\n    purchasingAgentDiscount_addSPUToDiscount: function purchasingAgentDiscount_addSPUToDiscount(item) {\n      var _this4 = this;\n\n      var that = this;\n      this.request(this.api.scb.purchasingAgentDiscount_addSPUToDiscount, {\n        \"priceManagementId\": this.id,\n        \"productCode\": item.code,\n        \"productDiscountId\": this.checkDiscount_item.id\n      }, true).then(function (res) {\n        _this4.warn('添加成功！');\n\n        _this4.purchasingAgentProduct_scbProductToProductDiscount(); // 刷新全部商品\n\n\n        _this4.purchasingAgentProduct_productDiscountProductList(); // 已添加折扣商品\n\n      });\n    },\n\n    /**\r\n     * 获取商户详情\r\n     */\n    purchasingAgentPriceManagement_getById: function purchasingAgentPriceManagement_getById(item) {\n      var that = this;\n      this.request(this.api.scb.purchasingAgentPriceManagement_getById, {\n        id: this.$route.query.id\n      }, true).then(function (res) {\n        that.purchasingAgentPriceManagement_getById_data = res;\n      });\n    },\n\n    /**\r\n     * 修改折扣\r\n     * @param { String } value 修改的折扣值\r\n     */\n    purchasingAgentPriceManagement_updateValid: function purchasingAgentPriceManagement_updateValid(value) {\n      var _this5 = this;\n\n      var that = this;\n      this.request(this.api.scb.purchasingAgentPriceManagement_updateValid, {\n        id: this.id,\n        \"purchaserDiscountType\": this.purchasingAgentPriceManagement_getById_data.purchaserDiscountType,\n        \"purchaserDiscountValue\": value\n      }, true).then(function (res) {\n        that.purchasingAgentPriceManagement_getById_data = res; // 修改完折扣重新刷新列表\n\n        _this5.purchasingAgentPriceManagement_getById();\n      });\n    },\n\n    /**\r\n     * （新建折扣）-- 插入或更新指定商品折扣的折扣值\r\n     */\n    purchasingAgentDiscount_save: function purchasingAgentDiscount_save() {\n      var _this6 = this;\n\n      var that = this;\n      var data = this.purchasingAgentPriceManagement_getById_data;\n      this.$prompt('', '新建折扣', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        inputPattern: /(^[1-9](\\.\\d)?$)|(^[0]\\.\\d$)/,\n        inputErrorMessage: \"请输入正确折扣数值！\",\n        inputPlaceholder: '请输入采购折扣，如5.5折。'\n      }).then(function (_ref) {\n        var value = _ref.value;\n\n        _this6.request(_this6.api.scb.purchasingAgentDiscount_save, {\n          \"priceManagementId\": data.id,\n          \"productDiscountType\": 1,\n          \"productDiscountValue\": value,\n          \"purchaseAgentId\": data.purchaseAgentId,\n          \"purchaseAgentName\": data.purchaseAgentName\n        }, true).then(function (res) {\n          _this6.warn('新建折扣成功！');\n\n          _this6.purchasingAgentDiscount_list();\n        });\n      }).catch(function () {\n        _this6.$message({\n          type: 'info',\n          message: '取消输入'\n        });\n      });\n    },\n\n    /**\r\n     *  获取折扣列表\r\n     */\n    purchasingAgentDiscount_list: function purchasingAgentDiscount_list() {\n      var that = this;\n      Object.assign(this.filtersData, {\n        \"priceManagementId\": this.id\n      });\n      this.request(this.api.scb.purchasingAgentDiscount_list, this.filtersData, true).then(function (res) {\n        that.purchasingAgentDiscount_save_data = res;\n      });\n    },\n\n    /**\r\n     * 修改某条折扣\r\n     */\n    checkDiscount: function checkDiscount(row) {\n      this.href('/price/discount_details', {\n        id: this.$route.query.id,\n        discountId: row.id\n      });\n    },\n\n    /**\r\n     * （获取季节）\r\n     */\n    codeItem_list: function codeItem_list(item) {\n      var that = this;\n      this.request(this.api.market.codeItem_list, {\n        codeSetId: '06b11574-ef82-4ae4-a8a9-a25f903083df'\n      }, true).then(function (res) {\n        that.codeItem_list_get = res;\n      });\n    },\n\n    /**\r\n     * \r\n     */\n    cascaderGet: function cascaderGet(e) {\n      var cateId = JSON.parse(JSON.stringify(e)).pop();\n      var obj = this.classList.find(function (item) {\n        return item.id == cateId;\n      });\n      this.goodsFiltersData.cateIdentifier = obj.identifier;\n    },\n\n    /**\r\n     * 提示\r\n     * @param { String } message 提示文案\r\n     * @param { String } type 提示类型\r\n     */\n    warn: function warn(message, type) {\n      this.$message({\n        message: message,\n        type: type || \"success\"\n      });\n    },\n    open: function open(inputValue) {\n      var _this7 = this;\n\n      this.$prompt('', '修改采购折扣', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        inputPattern: /(^[1-9](\\.\\d)?$)|(^[0]\\.\\d$)/,\n        inputValue: inputValue,\n        inputErrorMessage: \"请输入正确折扣数值！\",\n        inputPlaceholder: '请输入采购折扣，如5.5折。'\n      }).then(function (_ref2) {\n        var value = _ref2.value;\n\n        _this7.purchasingAgentPriceManagement_updateValid(value);\n      }).catch(function () {\n        _this7.$message({\n          type: 'info',\n          message: '取消输入'\n        });\n      });\n    },\n\n    /**\r\n     * 编辑\r\n     * @param { Object } item 当前对象\r\n     * @param { Boolean } isRead 是否可对写\r\n     * @property { Boolean }isEcho 是否是编辑\r\n     * @return { Object } Obj 返回对象\r\n     */\n    timeRedact: function timeRedact(item) {\n      var Obj = {};\n      this.href(\"discount_order_edit\", {\n        isEdit: true,\n        discountId: item.discountId,\n        type: item.type\n      });\n    },\n\n    /**\r\n     * 获取折扣列表\r\n     */\n    marketingMiddleground_discountList: function marketingMiddleground_discountList() {\n      var _this8 = this;\n\n      this.request(this.api.market.marketingMiddleground_discountList, this.filtersData).then(function (res) {\n        _this8.discountData = res;\n      });\n    },\n\n    /**\r\n     * 路由跳转\r\n     * @param { String } routeName 路由路径\r\n     * @param { Object } param 路由参数\r\n     */\n    href: function href(routeName, param) {\n      var module = '/' + this.$route.path.split('/')[1];\n      this.$router.push({\n        path: module + routeName,\n        query: param\n      });\n    },\n\n    /**\r\n     * 模糊搜索\r\n     */\n    handleSearch: function handleSearch() {\n      this.filtersData.pageIndex = 1;\n      this.filtersData.storeName = this.filtersData.storeName.replace(/(^\\s)|(\\s$)/g, \"\");\n      this.marketingMiddleground_discountList();\n    },\n\n    /**\r\n     * 搜索重置\r\n     */\n    handleResetFilters: function handleResetFilters() {\n      Object.assign(this.filtersData, {\n        pageIndex: 1,\n        // 当前页码\n        pageSize: 10,\n        // 每页数量\n        type: \"\",\n        // 门店类型\n        storeName: \"\" // 门店名称\n\n      });\n    },\n\n    /**\r\n     * 点击页数\r\n     * @param { Number } pageIndex 当前页\r\n     */\n    handleCurrentChange: function handleCurrentChange(pageIndex) {\n      this.filtersData.pageIndex = pageIndex;\n      this.marketingMiddleground_discountList();\n    },\n\n    /**\r\n     *  选择每页多少条数\r\n     *  @param { Number } pageSize 每页条数\r\n     */\n    handleSizeChange: function handleSizeChange(pageSize) {\n      this.filtersData.pageSize = pageSize;\n      this.marketingMiddleground_discountList();\n    }\n  },\n  components: {\n    codeSet: codeSet,\n    treeDept: treeDept,\n    PageTable: PageTable\n  }\n};",{"version":3,"sources":["price_edit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"box\">\r\n    <el-dialog title=\"选择商品\" :visible.sync=\"dialogTableVisible\">\r\n      <div>\r\n        <el-form\r\n          class=\"item-form\"\r\n          size=\"small\"\r\n          :inline=\"true\"\r\n\r\n          :model=\"goodsFiltersData\">\r\n          <!-- 模糊查询 -->\r\n          <el-form-item prop=\"cateIdentifier\" clearable label=\"品类：\">\r\n            <el-cascader\r\n              class=\"input-w\"\r\n              :options=\"classData\"\r\n              v-model=\"cateArr\"\r\n              :value=\"cateArr\"\r\n              @change=\"cascaderGet\"\r\n              :show-all-levels=\"false\"\r\n              :props=\"props\"\r\n              change-on-select\r\n            ></el-cascader>\r\n          </el-form-item>\r\n          <el-form-item label=\"品牌：\">\r\n            <el-select class=\"input-w\" filterable clearable placeholder=\"请选择\" v-model=\"goodsFiltersData.brandId\">\r\n              <el-option\r\n                v-for=\"item in brandOptions\"\r\n                :key=\"item.id\"\r\n                :label=\"item.name\"\r\n                :value=\"item.id\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"售价：\">\r\n            <el-input placeholder=\"请输入售价最小值\" clearable  v-model.number=\"goodsFiltersData.retailPriceGE\" class=\"el-input-width155\"></el-input>\r\n            <el-input placeholder=\"请输入售价最大值\" clearable  v-model.number=\"goodsFiltersData.retailPriceLE\" class=\"el-input-width155 ml-10\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"季节：\">\r\n            <el-select v-model=\"goodsFiltersData.seasonalStyleCode\" clearable placeholder=\"请选择\">\r\n              <el-option v-for=\"(item, index) in codeItem_list_get.data\" :key=\"index\" :label=\"item.name\" :value=\"item.code\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"店内库存：\">\r\n            <el-input placeholder=\"请输入库存最小值\" clearable  v-model=\"goodsFiltersData.quantityLowerLimit\" class=\"el-input-width155\"></el-input>\r\n            <el-input placeholder=\"请输入库存最大值\" clearable  v-model=\"goodsFiltersData.quantityUpperLimit\" class=\"el-input-width155 ml-10\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"关键词：\">\r\n            <el-input placeholder=\"请输入关键词，如：货号、款号、商品名称\" clearable  v-model=\"goodsFiltersData.searchWords\" class=\"el-input-width355\"></el-input>\r\n          </el-form-item>\r\n          <!-- 搜索，重置 -->\r\n          <el-form-item>\r\n            <el-button size=\"small\" @click=\"handleSearch\" type=\"primary\" plain>搜索</el-button>\r\n            <el-button size=\"small\" @click=\"handleResetFilters\">重置</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>  \r\n      <div>\r\n        <!-- 全部商品 -->\r\n        <div class=\"item-table\">\r\n          <page-table :form-data=\"filtersData\" :get-data=\"purchasingAgentProduct_scbProductToProductDiscount\" :table-data=\"goodsList\">\r\n            <el-table\r\n              class=\"mt-20\"\r\n              :data=\"goodsList.data\"  \r\n              stripe\r\n              empty-text=\"暂无数据\"\r\n              header-align=\"center\"\r\n              header-row-class-name=\"item-table-header\"\r\n              :highlight-current-row=\"true\">\r\n              <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"商品款号\" min-width=\"100\">\r\n                <template  slot-scope=\"scope\">{{ scope.row.code|| '--' }}</template>\r\n              </el-table-column>\r\n              <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"品牌\" min-width=\"100\">\r\n                <template  slot-scope=\"scope\">{{ scope.row.brandName || '--' }}</template>\r\n              </el-table-column>\r\n              <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"品类\" min-width=\"100\">\r\n                <template  slot-scope=\"scope\">{{ scope.row.fullCateName || '--' }}</template>\r\n              </el-table-column>\r\n              <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"商品名称\" min-width=\"100\">\r\n                <template  slot-scope=\"scope\">{{ scope.row.name || '--' }}</template>\r\n              </el-table-column>\r\n              <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"吊牌价\" min-width=\"100\">\r\n                <template  slot-scope=\"scope\">{{ scope.row.retailPrice  }}</template>\r\n              </el-table-column>\r\n              <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"商品图片\" min-width=\"100\">\r\n                <template  slot-scope=\"scope\"><img class=\"discountImg\" :src=\"scope.row.image\" alt=\"\"></template>\r\n              </el-table-column>\r\n              <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"当前折扣\" min-width=\"100\">\r\n                <template  slot-scope=\"scope\">{{ scope.row.currentMerchantDiscountValue || '--' }}</template>\r\n              </el-table-column>\r\n              <!-- 操作 -->\r\n              <el-table-column\r\n                  fixed=\"right\"\r\n                  label-class-name=\"text-center\"\r\n                  class-name=\"text-center\"\r\n                  align=\"center\"\r\n                  label=\"操作\"\r\n                  width=\"180\">\r\n                  <template slot-scope=\"scope\">\r\n                    <el-button type=\"text\" v-if=\"scope.row.currentMerchantDiscount === null || scope.row.currentMerchantDiscount === 0\" size=\"small\" @click=\"purchasingAgentDiscount_addSPUToDiscount(scope.row)\">添加</el-button>\r\n                    <el-button type=\"text\" v-if=\"scope.row.currentMerchantDiscount === 2\" size=\"small\" @click=\"purchasingAgentDiscount_transferSPU(scope.row)\">移动到当前折扣</el-button>\r\n                    <el-button type=\"text\" v-if=\"scope.row.currentMerchantDiscount === 1\" size=\"small\" @click=\"purchasingAgentDiscount_deleteSPUFromDiscount(scope.row)\">从列表内剔除</el-button>\r\n                  </template>\r\n              </el-table-column>\r\n            </el-table>\r\n         </page-table>\r\n        </div>\r\n      </div>\r\n    </el-dialog>\r\n    <!-- 商户信息 -->\r\n    <h4>商户信息</h4>\r\n    <el-form class=\"mt-20\" :label-position=\"labelPosition\" label-width=\"90px\" :model=\"formLabelAlign\">\r\n      <el-form-item label=\"商品名：\">{{ purchasingAgentPriceManagement_getById_data.merchantName }}</el-form-item>\r\n      <el-form-item label=\"联系人：\">{{ purchasingAgentPriceManagement_getById_data.administrator }}</el-form-item>\r\n      <el-form-item label=\"联系电话：\">{{ purchasingAgentPriceManagement_getById_data.phone }}</el-form-item>\r\n    </el-form>\r\n    <!-- 采购折扣 -->\r\n    <h4>采购折扣</h4>\r\n    <el-input class=\"mt-20\" disabled value=\"设置后，除指定商品外，该商户结算价格=吊牌价×采购折扣，无输入则按照吊牌价结算。\"></el-input>\r\n    <div class=\"mt-20\">采购折扣：{{ purchasingAgentPriceManagement_getById_data.purchaserDiscountValue }}<el-button size=\"mini\" type=\"success\" plain class=\"ml-20\" @click=\"open(purchasingAgentPriceManagement_getById_data.purchaserDiscountValue)\">修改</el-button></div>\r\n    <!-- 货号信息 -->\r\n    <h4 class=\"mt-20\">指定商品折扣</h4>\r\n    <div class=\"item-table\" v-if=\"discountType\">\r\n      <el-button type=\"primary\" @click=\"purchasingAgentDiscount_save\" class=\"mt-30\">新建</el-button>\r\n      <page-table :form-data=\"filtersData\" :get-data=\"purchasingAgentDiscount_list\" :table-data=\"purchasingAgentDiscount_save_data\">\r\n        <el-table\r\n          class=\"mt-20 table\"\r\n          :data=\"purchasingAgentDiscount_save_data.data\"\r\n          stripe\r\n          empty-text=\"暂无数据\"\r\n          header-align=\"center\"\r\n          header-row-class-name=\"item-table-header\"\r\n          :highlight-current-row=\"true\">\r\n          <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"折扣\" min-width=\"100\">\r\n            <template  slot-scope=\"scope\">{{ scope.row.productDiscountValue }}</template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"商品数量\" min-width=\"100\">\r\n            <template  slot-scope=\"scope\">{{ scope.row.spuProductQty }}</template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            fixed=\"right\"\r\n            label-class-name=\"text-center\"\r\n            class-name=\"text-center\"\r\n            align=\"center\"\r\n            label=\"操作\"\r\n            width=\"180\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"text\" size=\"small\" @click=\"checkDiscount(scope.row)\">修改</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </page-table>\r\n    </div>\r\n    <div class=\"item-table\" v-else>\r\n      <el-button type=\"primary\" @click=\"addProduct\" class=\"mt-30\">添加</el-button>\r\n      <el-button type=\"primary\" @click=\"backList\" class=\"mt-30\">返回折扣列表</el-button>\r\n      <el-table\r\n        class=\"mt-20 table\"\r\n        :data=\"goodsData.data\"\r\n        stripe\r\n        empty-text=\"暂无数据\"\r\n        header-align=\"center\"\r\n        header-row-class-name=\"item-table-header\"\r\n        :highlight-current-row=\"true\">\r\n        <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"商品款号\" min-width=\"100\">\r\n          <template  slot-scope=\"scope\">{{ scope.row.productCode || '--' }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"所属分类\" min-width=\"100\">\r\n          <template  slot-scope=\"scope\">{{ scope.row._cateNames || '--' }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"品类\" min-width=\"100\">\r\n          <template  slot-scope=\"scope\">{{ scope.row.brandName || '--' }}</template>\r\n        </el-table-column>\r\n       <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"商品名称\" min-width=\"100\">\r\n          <template  slot-scope=\"scope\">{{ scope.row.productName || '--' }}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"\" align=\"center\" :show-overflow-tooltip=\"true\" label=\"商品图片\" min-width=\"100\">\r\n          <template  slot-scope=\"scope\"><img class=\"discountImg\" :src=\"scope.row.image\" alt=\"\"></template>\r\n        </el-table-column>\r\n        <el-table-column\r\n          fixed=\"right\"\r\n          label-class-name=\"text-center\"\r\n          class-name=\"text-center\"\r\n          align=\"center\"\r\n          label=\"操作\"\r\n          width=\"180\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"text\" size=\"small\" @click=\"purchasingAgentDiscount_deleteSPUFromDiscount(scope.row)\">剔除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport { getToken } from \"@/utils/auth\";\r\nimport codeSet from \"@/components/codeSet\";\r\nimport treeDept from \"@/components/treeDept\";\r\nimport { filter } from \"minimatch\";\r\nimport { get } from \"http\";\r\nimport PageTable from \"@/views/collocation/components/PageTable\";\r\n\r\nlet token = getToken();\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 检索\r\n      filtersData: {\r\n        pageIndex: 1, // 当前页码\r\n        pageSize: 10, // 每页数量\r\n        \"orderBy\": \"\",\r\n      },\r\n      currentMerchantDiscountType:{\r\n        0:'不存在',\r\n        1:'当前折扣值',\r\n        2:'其他折扣值'\r\n      },\r\n      discountType:true,\r\n      dialogTableVisible:false,\r\n      classData: [],\r\n      classList: [],\r\n      cateArr: [],\r\n      cateArrs: [],\r\n      // 季节列表\r\n      codeItem_list_get:[],\r\n      // 全部品牌\r\n      brandOptions:[],\r\n      props: {\r\n        value: \"id\",\r\n        label: \"name\",\r\n        children: \"children\"\r\n      },\r\n      goodsList:{\r\n        data:[]\r\n      },\r\n      // 商户详情\r\n      purchasingAgentPriceManagement_getById_data:{},\r\n      // 商品折扣列表\r\n      purchasingAgentDiscount_save_data:[],\r\n      // 选中某个折扣\r\n      checkDiscount_item:{},\r\n      // 检索全部商品\r\n      goodsFiltersData:{\r\n        // 当前页码\r\n        pageIndex: 1,\r\n        // 每页数量\r\n        pageSize: 10,\r\n        // 门店id\r\n        storeId:null,\r\n        // 折扣类型\r\n        type:null,\r\n        // 折扣值\r\n        discount:null,\r\n        // 品类id\r\n        cateIdentifier:null,\r\n        // 品牌id\r\n        brandId:null,\r\n        // 售价最小值\r\n        retailPriceGE:null, \r\n        // 售价最大值\r\n        retailPriceLE:null, \r\n        // 库存最小值\r\n        quantityLowerLimit:null, \r\n        // 库存最大值\r\n        quantityUpperLimit:null, \r\n        // 季节\r\n        seasonalStyleCode:null,\r\n        // 关键词\r\n        searchWords:null \r\n      },\r\n      id:this.$route.query.id,\r\n      labelPosition: 'right',\r\n      selectArr:[1, 2, 3],\r\n      goodsData:[{\r\n        name:111\r\n      },{\r\n        name:111\r\n      },{\r\n        name:111\r\n      }],\r\n      formLabelAlign: {\r\n        name: '53424400GM',\r\n        region: '',\r\n        type: ''\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    const that = this;\r\n    this.codeItem_list(); // 获取季节列表\r\n    this.purchasingAgentPriceManagement_getById(); // 获取商户详情\r\n    this.purchasingAgentDiscount_list(); // 获取折扣列表\r\n  },\r\n  methods: {\r\n    /**\r\n     * 返回折扣\r\n     */\r\n    backList() {\r\n      this.discountType = true;\r\n      this.purchasingAgentDiscount_list(); // 获取折扣列表\r\n    },\r\n    /**\r\n     * btn 添加商品\r\n     */\r\n    addProduct() {\r\n      this.dialogTableVisible = true;\r\n      Object.assign(this.filtersData, {\r\n        \"purchaseAgentId\":this.checkDiscount_item.purchaseAgentId,\r\n        \"productDiscountType\":\"1\",\r\n        \"productDiscountValue\":this.checkDiscount_item.productDiscountValue + ''\r\n      });\r\n      if(this.goodsList.data.length > 0) return;\r\n      this.purchasingAgentProduct_scbProductToProductDiscount(); // 添加SCB商品到商品折扣下\r\n    },\r\n    /**\r\n     * 移动到当前折扣\r\n     */\r\n    purchasingAgentDiscount_transferSPU(item) {\r\n      const that = this;\r\n      const text = `将从”${ item.currentMerchantDiscountValue }折”转移到“${ this.checkDiscount_item.productDiscountValue }折”，是否继续？`;\r\n\r\n      this.$confirm(text, '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        this.request(\r\n          this.api.scb.purchasingAgentDiscount_transferSPU,\r\n          {\r\n            \"priceManagementId\": this.id,\r\n            \"productCode\": item.code,\r\n            \"productDiscountId\": this.checkDiscount_item.id,\r\n            \"oldProductDiscountId\":item.currentMerchantDiscountId\r\n          },\r\n          true\r\n        ).then(res => {\r\n          this.warn('移动成功！');\r\n          this.purchasingAgentProduct_scbProductToProductDiscount();// 刷新全部商品\r\n        });\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        });          \r\n      });\r\n    },\r\n    /**\r\n     *btn 剔除\r\n     */\r\n    purchasingAgentDiscount_deleteSPUFromDiscount(item) {\r\n      const that = this;\r\n\r\n      this.request(\r\n        this.api.scb.purchasingAgentDiscount_deleteSPUFromDiscount,\r\n        {\r\n          \"priceManagementId\": this.id,\r\n          \"productCode\": item.code,\r\n          \"productDiscountId\": this.checkDiscount_item.id\r\n        },\r\n        true\r\n      ).then(res => {\r\n        this.warn('剔除成功！');\r\n        this.purchasingAgentProduct_scbProductToProductDiscount();// 刷新全部商品\r\n        this.purchasingAgentProduct_productDiscountProductList();// 已添加折扣商品\r\n      });\r\n    },\r\n    /**\r\n     * 添加SCB商品到商品折扣下（全部商品）\r\n     */\r\n    purchasingAgentProduct_scbProductToProductDiscount() {\r\n      const that = this;\r\n\r\n      this.request(\r\n        this.api.scb.purchasingAgentProduct_scbProductToProductDiscount,\r\n        this.filtersData,\r\n        true\r\n      ).then(res => {\r\n        that.goodsList = res;\r\n      });\r\n    },\r\n    /**\r\n     * 已添加折扣商品\r\n     */\r\n    purchasingAgentProduct_productDiscountProductList(item) {\r\n      const that = this;\r\n\r\n      this.request(\r\n        this.api.scb.purchasingAgentProduct_productDiscountProductList,\r\n        {\r\n          \"productDiscountId\": this.checkDiscount_item.id\r\n        },\r\n        true\r\n      ).then(res => {\r\n        this.goodsData = res;\r\n        res.data.forEach(item => {\r\n          item._cateNames = item.cateNames.join('、');\r\n        });\r\n      });\r\n    },\r\n    /**\r\n     * 添加SPU商品到此折扣下\r\n     */\r\n    purchasingAgentDiscount_addSPUToDiscount(item) {\r\n      const that = this;\r\n\r\n      this.request(\r\n        this.api.scb.purchasingAgentDiscount_addSPUToDiscount,\r\n        {\r\n          \"priceManagementId\": this.id,\r\n          \"productCode\": item.code,\r\n          \"productDiscountId\": this.checkDiscount_item.id\r\n        },\r\n        true\r\n      ).then(res => {\r\n        this.warn('添加成功！');\r\n        this.purchasingAgentProduct_scbProductToProductDiscount();// 刷新全部商品\r\n        this.purchasingAgentProduct_productDiscountProductList();// 已添加折扣商品\r\n      });\r\n    },\r\n    /**\r\n     * 获取商户详情\r\n     */\r\n    purchasingAgentPriceManagement_getById(item) {\r\n      const that = this;\r\n\r\n      this.request(\r\n        this.api.scb.purchasingAgentPriceManagement_getById,\r\n        {\r\n          id:this.$route.query.id\r\n        },\r\n        true\r\n      ).then(res => {\r\n        that.purchasingAgentPriceManagement_getById_data = res;\r\n      });\r\n    },\r\n    /**\r\n     * 修改折扣\r\n     * @param { String } value 修改的折扣值\r\n     */\r\n    purchasingAgentPriceManagement_updateValid(value) {\r\n      const that = this;\r\n\r\n      this.request(\r\n        this.api.scb.purchasingAgentPriceManagement_updateValid,\r\n        {\r\n          id:this.id,\r\n          \"purchaserDiscountType\": this.purchasingAgentPriceManagement_getById_data.purchaserDiscountType,\r\n          \"purchaserDiscountValue\": value\r\n        },\r\n        true\r\n      ).then(res => {\r\n        that.purchasingAgentPriceManagement_getById_data = res;\r\n        // 修改完折扣重新刷新列表\r\n        this.purchasingAgentPriceManagement_getById();\r\n      });\r\n    },\r\n    /**\r\n     * （新建折扣）-- 插入或更新指定商品折扣的折扣值\r\n     */\r\n    purchasingAgentDiscount_save() {\r\n      const that = this;\r\n      const data = this.purchasingAgentPriceManagement_getById_data;\r\n      this.$prompt('', '新建折扣', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        inputPattern: /(^[1-9](\\.\\d)?$)|(^[0]\\.\\d$)/,\r\n        inputErrorMessage: \"请输入正确折扣数值！\",\r\n        inputPlaceholder:'请输入采购折扣，如5.5折。'\r\n      }).then(({ value }) => {\r\n       this.request(\r\n        this.api.scb.purchasingAgentDiscount_save,\r\n          {\r\n            \"priceManagementId\": data.id,\r\n            \"productDiscountType\": 1,\r\n            \"productDiscountValue\": value,\r\n            \"purchaseAgentId\": data.purchaseAgentId,\r\n            \"purchaseAgentName\": data.purchaseAgentName\r\n        },\r\n        true\r\n      ).then(res => {\r\n        this.warn('新建折扣成功！');\r\n        this.purchasingAgentDiscount_list();\r\n      });\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '取消输入'\r\n        });       \r\n      });\r\n    },\r\n    /**\r\n     *  获取折扣列表\r\n     */\r\n    purchasingAgentDiscount_list() {\r\n      const that = this;\r\n      Object.assign(this.filtersData, {\r\n          \"priceManagementId\": this.id\r\n      });\r\n      this.request(\r\n        this.api.scb.purchasingAgentDiscount_list,\r\n        this.filtersData,\r\n        true\r\n      ).then(res => {\r\n        that.purchasingAgentDiscount_save_data = res;\r\n      });\r\n    },\r\n    /**\r\n     * 修改某条折扣\r\n     */\r\n    checkDiscount(row) {\r\n      this.href('/price/discount_details',{\r\n        id:this.$route.query.id,\r\n        discountId:row.id\r\n      });\r\n    },\r\n    /**\r\n     * （获取季节）\r\n     */\r\n    codeItem_list(item) {\r\n      const that = this;\r\n\r\n      this.request(\r\n        this.api.market.codeItem_list,\r\n        {\r\n          codeSetId:'06b11574-ef82-4ae4-a8a9-a25f903083df'\r\n        },\r\n        true\r\n      ).then(res => {\r\n        that.codeItem_list_get = res;\r\n      });\r\n    },\r\n    /**\r\n     * \r\n     */\r\n    cascaderGet(e) {\r\n      let cateId = JSON.parse(JSON.stringify(e)).pop();\r\n      let obj = this.classList.find(item => item.id == cateId);\r\n      this.goodsFiltersData.cateIdentifier = obj.identifier;\r\n    },\r\n    /**\r\n     * 提示\r\n     * @param { String } message 提示文案\r\n     * @param { String } type 提示类型\r\n     */\r\n    warn(message, type) {\r\n      this.$message({\r\n        message: message,\r\n        type: type || \"success\"\r\n      });\r\n    },\r\n    open(inputValue) {\r\n      this.$prompt('', '修改采购折扣', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        inputPattern: /(^[1-9](\\.\\d)?$)|(^[0]\\.\\d$)/,\r\n        inputValue:inputValue,\r\n        inputErrorMessage: \"请输入正确折扣数值！\",\r\n        inputPlaceholder:'请输入采购折扣，如5.5折。'\r\n      }).then(({ value }) => {\r\n       this.purchasingAgentPriceManagement_updateValid(value);\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '取消输入'\r\n        });       \r\n      });\r\n    },\r\n    /**\r\n     * 编辑\r\n     * @param { Object } item 当前对象\r\n     * @param { Boolean } isRead 是否可对写\r\n     * @property { Boolean }isEcho 是否是编辑\r\n     * @return { Object } Obj 返回对象\r\n     */\r\n    timeRedact(item) {\r\n      var Obj = {};\r\n      this.href(\"discount_order_edit\", {\r\n        isEdit: true,\r\n        discountId: item.discountId,\r\n        type: item.type\r\n      });\r\n    },\r\n    /**\r\n     * 获取折扣列表\r\n     */\r\n    marketingMiddleground_discountList() {\r\n      this.request(\r\n        this.api.market.marketingMiddleground_discountList,\r\n        this.filtersData\r\n      ).then(res => {\r\n        this.discountData = res;\r\n      });\r\n    },\r\n    /**\r\n     * 路由跳转\r\n     * @param { String } routeName 路由路径\r\n     * @param { Object } param 路由参数\r\n     */\r\n    href(routeName, param) {\r\n      let module = '/' + this.$route.path.split('/')[1];\r\n      this.$router.push({\r\n        path: module + routeName,\r\n        query: param\r\n      });\r\n    },\r\n    /**\r\n     * 模糊搜索\r\n     */\r\n    handleSearch() {\r\n      this.filtersData.pageIndex = 1;\r\n      this.filtersData.storeName = this.filtersData.storeName.replace(\r\n        /(^\\s)|(\\s$)/g,\r\n        \"\"\r\n      );\r\n      this.marketingMiddleground_discountList();\r\n    },\r\n    /**\r\n     * 搜索重置\r\n     */\r\n    handleResetFilters() {\r\n      Object.assign(this.filtersData, {\r\n        pageIndex: 1, // 当前页码\r\n        pageSize: 10, // 每页数量\r\n        type: \"\", // 门店类型\r\n        storeName: \"\" // 门店名称\r\n      });\r\n    },\r\n    /**\r\n     * 点击页数\r\n     * @param { Number } pageIndex 当前页\r\n     */\r\n    handleCurrentChange(pageIndex) {\r\n      this.filtersData.pageIndex = pageIndex;\r\n      this.marketingMiddleground_discountList();\r\n    },\r\n    /**\r\n     *  选择每页多少条数\r\n     *  @param { Number } pageSize 每页条数\r\n     */\r\n    handleSizeChange(pageSize) {\r\n      this.filtersData.pageSize = pageSize;\r\n      this.marketingMiddleground_discountList();\r\n    }\r\n  },\r\n  components: {\r\n    codeSet,\r\n    treeDept,\r\n    PageTable\r\n  }\r\n};\r\n</script>\r\n<style  lang=\"less\" scoped>\r\nh4{\r\n  border-bottom: 1px solid #ccc;\r\n  height: 40px;\r\n}\r\n\r\n.table /deep/ .el-input__inner{\r\n  width: 150px;\r\n}\r\n.el-select{\r\n  display: block;\r\n}\r\n.previewVisible-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  .item {\r\n    width: 50%;\r\n    margin-right: 0;\r\n    text-align: right;\r\n  }\r\n}\r\n.blueness {\r\n  color: #1e90ff;\r\n}\r\nh5 {\r\n  color: #222;\r\n  margin-left: -15px;\r\n}\r\n.test {\r\n  color: #9d9d9d;\r\n}\r\n.box {\r\n  padding: 20px 50px 20px 50px;\r\n  margin: 8px 8px 20px 8px;\r\n  background: #fff;\r\n}\r\n  .el-input-short{\r\n    width: 300px;\r\n  }\r\n  .el-input-mini{\r\n    width: 90px;\r\n  }\r\n  .mlr10px{\r\n    margin: 0 10px;\r\n  }\r\n  .addRadder{\r\n    border-radius: 4px;\r\n    border: 1px solid #DCDFE6;\r\n    width: 400px;\r\n    padding: 15px;\r\n  }\r\n  .mb-10{\r\n    margin-bottom: 10px;\r\n  }\r\n  .mb-100{\r\n    margin-bottom: 100px;\r\n  }\r\n  .ml-10{\r\n    margin-left: 10px;\r\n  }\r\n  .mt-74{\r\n    margin-top: 74px;\r\n  }\r\n  .el-input-width155{\r\n    width:300px;\r\n  }\r\n  .el-input-width355{\r\n    width: 355px;\r\n  }\r\n  .el-input__inners{\r\n    width: 300px;\r\n  }\r\n  .el-dialog__wrapper /deep/ .el-dialog{\r\n    width: 80%;\r\n  }\r\n  .discountImg{\r\n    width: 40px;\r\n    height: 40px;\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/views/scb/price"}]}