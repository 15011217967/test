{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\components\\division.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\components\\division.vue","mtime":1576427226859},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\EDZ\\\\Desktop\\\\\\u7814\\u53D1\\u9879\\u76EE\\\\vue-project\\\\trunk\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: \"division\",\n  props: {\n    // 接收绑定参数\n    value: String,\n    label: '地址',\n    // 输入框宽度\n    widthClass: {\n      default: ''\n    },\n    // 输入框占位符\n    placeholder: {\n      type: String,\n      default: \"请选择\"\n    },\n    // 显示几级\n    level: {\n      type: Number,\n      default: 3\n    },\n    // 是否查询使用  如果查询使用  组件绑定的v-model值返回为code\n    isSearch: {\n      type: Boolean,\n      default: false\n    },\n    // 是否禁止修改\n    isDisabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  watch: {\n    value: function value(val) {\n      if (!val) {\n        // 如果是查询使用的话  会有重置\n        if (this.isSearch) {\n          this.init();\n        }\n\n        return;\n      } // 编辑\n\n\n      if (!this.isSearch) {\n        // 保存回显id\n        this.divisionId = val; // 获取数据\n\n        this.getAllDivision();\n      }\n    }\n  },\n  data: function data() {\n    return {\n      viewModel: {\n        province: '',\n        provinceCode: '',\n        provinceId: '',\n        municipality: '',\n        municipalityCode: '',\n        municipalityId: '',\n        area: '',\n        areaCode: '',\n        areaId: '',\n        divisionId: ''\n      },\n      proList: [],\n      muniList: [],\n      areaList: [],\n      // 通过divisionId回显的数据\n      divisionList: [],\n      // 所有的省市区下拉数据\n      divisionInfo: {},\n      // 选中的id\n      divisionId: ''\n    };\n  },\n  created: function created() {\n    this.divisionId = this.value;\n    this.getAllDivision();\n  },\n  methods: {\n    // 初始化选择\n    init: function init() {\n      this.viewModel = {\n        province: '',\n        provinceCode: '',\n        provinceId: '',\n        municipality: '',\n        municipalityCode: '',\n        municipalityId: '',\n        area: '',\n        areaCode: '',\n        areaId: '',\n        divisionId: ''\n      };\n      this.muniList = [];\n      this.areaList = [];\n    },\n    // 省的选择事件\n    provinceChangeEvent: function provinceChangeEvent(code) {\n      var pro = this.proList.find(function (t) {\n        return t.code == code;\n      });\n\n      if (pro) {\n        this.viewModel.province = pro.name;\n        this.viewModel.provinceCode = pro.code;\n        this.viewModel.provinceId = pro.id;\n        this.muniList = this.divisionInfo.municipalitys[code];\n        this.$emit('input', pro.code);\n      } else {\n        this.viewModel.province = '';\n        this.viewModel.provinceCode = '';\n        this.viewModel.provinceId = '';\n        this.muniList = [];\n        this.$emit('input', '');\n      }\n\n      this.viewModel.municipality = '';\n      this.viewModel.municipalityCode = '';\n      this.viewModel.municipalityId = '';\n      this.viewModel.area = '';\n      this.viewModel.areaCode = '';\n      this.viewModel.areaId = '';\n      this.areaList = [];\n      this.viewModel.divisionId = '';\n      this.$emit(\"set-division\", this.viewModel);\n    },\n    // 城市的选择事件\n    cityChangeEvent: function cityChangeEvent(code) {\n      var muti = this.muniList.find(function (t) {\n        return t.code == code;\n      });\n\n      if (muti) {\n        this.viewModel.municipality = muti.name;\n        this.viewModel.municipalityCode = muti.code;\n        this.viewModel.municipalityId = muti.id;\n        this.areaList = this.divisionInfo.areas[code];\n        this.$emit('input', muti.code);\n      } else {\n        if (this.viewModel.provinceId) {\n          this.$emit('input', this.viewModel.provinceCode);\n        }\n\n        this.viewModel.municipality = '';\n        this.viewModel.municipalityCode = '';\n        this.viewModel.municipalityId = '';\n        this.areaList = [];\n      }\n\n      this.viewModel.area = '';\n      this.viewModel.areaCode = '';\n      this.viewModel.areaId = '';\n      this.viewModel.divisionId = '';\n      this.$emit(\"set-division\", this.viewModel);\n    },\n    // 区的选择事件\n    areaChangeEvent: function areaChangeEvent(code) {\n      var area = this.areaList.find(function (t) {\n        return t.code == code;\n      });\n\n      if (area) {\n        this.viewModel.area = area.name;\n        this.viewModel.areaCode = area.code;\n        this.viewModel.areaId = area.id;\n        this.viewModel.divisionId = area.id;\n        this.$emit('input', area.code);\n      } else {\n        if (this.viewModel.municipalityId) {\n          this.$emit('input', this.viewModel.municipalityCode);\n        }\n\n        this.viewModel.area = '';\n        this.viewModel.areaCode = '';\n        this.viewModel.areaId = '';\n        this.viewModel.divisionId = '';\n      }\n\n      this.$emit(\"set-division\", this.viewModel);\n    },\n    // 获取所有的省市区回显组合及下拉数据\n    getAllDivision: function () {\n      var _getAllDivision = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var divisionInfo, municipalitys, areas;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(localStorage.getItem(\"division\") != null && localStorage.getItem(\"divisionInfo\") != null)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                this.divisionList = JSON.parse(localStorage.getItem(\"division\")); // 有id 视为编辑  获取回显数据\n\n                if (this.divisionId) {\n                  this.viewModel = this.divisionList.find(function (t) {\n                    return t.id == _this.divisionId;\n                  });\n                }\n\n                this.divisionInfo = JSON.parse(localStorage.getItem(\"divisionInfo\"));\n                this.proList = this.divisionInfo.provinces;\n                this.getEditList();\n                return _context.abrupt(\"return\");\n\n              case 7:\n                _context.next = 9;\n                return this.request(this.api.system.division_all, {}, true);\n\n              case 9:\n                this.divisionList = _context.sent;\n\n                // 有id 视为编辑  获取回显数据\n                if (this.divisionId) {\n                  this.viewModel = this.divisionList.find(function (t) {\n                    return t.id == _this.divisionId;\n                  });\n                } // 存储回显组合数据\n\n\n                localStorage.setItem(\"division\", JSON.stringify(this.divisionList)); // 获取省市区下拉数据\n\n                _context.next = 14;\n                return this.request(this.api.system.division_get_info, {}, true);\n\n              case 14:\n                divisionInfo = _context.sent;\n\n                // 初始化数据 转对象\n                // 市\n                if (divisionInfo && divisionInfo.municipalitys.length) {\n                  municipalitys = {};\n                  divisionInfo.municipalitys.forEach(function (item) {\n                    var key = Object.keys(item)[0];\n                    municipalitys[key] = item[key];\n                  });\n                  divisionInfo.municipalitys = municipalitys;\n                } else {\n                  divisionInfo.municipalitys = {};\n                } // 区\n\n\n                if (divisionInfo && divisionInfo.areas.length) {\n                  areas = {};\n                  divisionInfo.areas.forEach(function (item) {\n                    var key = Object.keys(item)[0];\n                    areas[key] = item[key];\n                  });\n                  divisionInfo.areas = areas;\n                } else {\n                  divisionInfo.areas = {};\n                }\n\n                this.divisionInfo = divisionInfo; // 获取省份数据\n\n                this.proList = this.divisionInfo.provinces; // 获取市  区数据\n\n                this.getEditList(); // 存储下拉数据\n\n                localStorage.setItem(\"divisionInfo\", JSON.stringify(this.divisionInfo));\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getAllDivision() {\n        return _getAllDivision.apply(this, arguments);\n      }\n\n      return getAllDivision;\n    }(),\n    // 获取市  区列表\n    getEditList: function getEditList() {\n      if (this.viewModel.provinceCode) {\n        this.muniList = this.divisionInfo.municipalitys[this.viewModel.provinceCode];\n      }\n\n      if (this.viewModel.municipalityCode) {\n        this.areaList = this.divisionInfo.areas[this.viewModel.municipalityCode];\n      }\n    }\n  }\n};",{"version":3,"sources":["division.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div class=\"cont-inline\">\r\n        <el-select :class=\"[widthClass]\" v-model=\"viewModel.provinceCode\" :disabled=\"isDisabled\" @change='provinceChangeEvent' clearable placeholder=\"省/直辖市\" v-if=\"level >= 1\">\r\n            <el-option v-for=\"(item,index) in proList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n        <el-select :class=\"[widthClass]\" v-model=\"viewModel.municipalityCode\" :disabled=\"isDisabled\" @change=\"cityChangeEvent\" clearable placeholder=\"市\" v-if=\"level >= 2\" style=\"margin:0 5px;\">\r\n            <el-option v-for=\"(item,index) in muniList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n        <el-select :class=\"[widthClass]\" v-model=\"viewModel.areaCode\" :disabled=\"isDisabled\" @change=\"areaChangeEvent\" clearable placeholder=\"区/县\" v-if=\"level >= 3\">\r\n            <el-option v-for=\"(item,index) in areaList\" :key=\"index\"\r\n                       :label=\"item.name\"\r\n                       :value=\"item.code\">\r\n            </el-option>\r\n        </el-select>\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        name: \"division\",\r\n        props: {\r\n            // 接收绑定参数\r\n            value: String,\r\n            label:'地址',\r\n            // 输入框宽度\r\n            widthClass: {\r\n                default: ''\r\n            },\r\n            // 输入框占位符\r\n            placeholder: {\r\n                type: String,\r\n                default: \"请选择\"\r\n            },\r\n            // 显示几级\r\n            level: {\r\n                type: Number,\r\n                default: 3\r\n            },\r\n            // 是否查询使用  如果查询使用  组件绑定的v-model值返回为code\r\n            isSearch: {\r\n                type: Boolean,\r\n                default: false\r\n            },\r\n            // 是否禁止修改\r\n            isDisabled: {\r\n                type: Boolean,\r\n                default: false\r\n            }\r\n        },\r\n        watch: {\r\n            value(val) {\r\n                if(!val){\r\n                    // 如果是查询使用的话  会有重置\r\n                    if(this.isSearch){\r\n                        this.init();\r\n                    }\r\n                    return;\r\n                }\r\n                // 编辑\r\n                if(!this.isSearch){\r\n                    // 保存回显id\r\n                    this.divisionId = val;\r\n                    // 获取数据\r\n                    this.getAllDivision();\r\n                }\r\n            },\r\n        },\r\n        data() {\r\n            return {\r\n                viewModel: {\r\n                    province: '',\r\n                    provinceCode: '',\r\n                    provinceId: '',\r\n                    municipality: '',\r\n                    municipalityCode: '',\r\n                    municipalityId: '',\r\n                    area: '',\r\n                    areaCode: '',\r\n                    areaId: '',\r\n                    divisionId: '',\r\n                },\r\n                proList: [],\r\n                muniList: [],\r\n                areaList: [],\r\n                // 通过divisionId回显的数据\r\n                divisionList: [],\r\n                // 所有的省市区下拉数据\r\n                divisionInfo: {},\r\n                // 选中的id\r\n                divisionId: ''\r\n            };\r\n        },\r\n        created() {\r\n            this.divisionId = this.value;\r\n            this.getAllDivision();\r\n        },\r\n        methods: {\r\n            // 初始化选择\r\n            init(){\r\n                this.viewModel = {\r\n                    province: '',\r\n                    provinceCode: '',\r\n                    provinceId: '',\r\n                    municipality: '',\r\n                    municipalityCode: '',\r\n                    municipalityId: '',\r\n                    area: '',\r\n                    areaCode: '',\r\n                    areaId: '',\r\n                    divisionId: '',\r\n                };\r\n                this.muniList = [];\r\n                this.areaList = [];\r\n            },\r\n            // 省的选择事件\r\n            provinceChangeEvent(code) {\r\n                let pro = this.proList.find(t => t.code == code);\r\n                if(pro){\r\n                    this.viewModel.province = pro.name;\r\n                    this.viewModel.provinceCode = pro.code;\r\n                    this.viewModel.provinceId = pro.id;\r\n                    this.muniList = this.divisionInfo.municipalitys[code];\r\n                    this.$emit('input', pro.code);\r\n                }else {\r\n                    this.viewModel.province = '';\r\n                    this.viewModel.provinceCode = '';\r\n                    this.viewModel.provinceId = '';\r\n                    this.muniList = [];\r\n                    this.$emit('input', '');\r\n                }\r\n                this.viewModel.municipality = '';\r\n                this.viewModel.municipalityCode = '';\r\n                this.viewModel.municipalityId = '';\r\n                this.viewModel.area = '';\r\n                this.viewModel.areaCode = '';\r\n                this.viewModel.areaId = '';\r\n                this.areaList = [];\r\n                this.viewModel.divisionId = '';\r\n                this.$emit(\"set-division\", this.viewModel);\r\n            },\r\n            // 城市的选择事件\r\n            cityChangeEvent(code) {\r\n                let muti = this.muniList.find(t => t.code == code);\r\n                if(muti){\r\n                    this.viewModel.municipality = muti.name;\r\n                    this.viewModel.municipalityCode = muti.code;\r\n                    this.viewModel.municipalityId = muti.id;\r\n                    this.areaList = this.divisionInfo.areas[code];\r\n                    this.$emit('input', muti.code);\r\n                }else {\r\n                    if(this.viewModel.provinceId){\r\n                        this.$emit('input', this.viewModel.provinceCode);\r\n                    }\r\n                    this.viewModel.municipality = '';\r\n                    this.viewModel.municipalityCode = '';\r\n                    this.viewModel.municipalityId = '';\r\n                    this.areaList = [];\r\n                }\r\n                this.viewModel.area = '';\r\n                this.viewModel.areaCode = '';\r\n                this.viewModel.areaId = '';\r\n                this.viewModel.divisionId = '';\r\n                this.$emit(\"set-division\", this.viewModel);\r\n            },\r\n            // 区的选择事件\r\n            areaChangeEvent(code) {\r\n                let area = this.areaList.find(t => t.code == code);\r\n                if(area){\r\n                    this.viewModel.area = area.name;\r\n                    this.viewModel.areaCode = area.code;\r\n                    this.viewModel.areaId = area.id;\r\n                    this.viewModel.divisionId = area.id;\r\n                    this.$emit('input', area.code);\r\n                }else {\r\n                    if(this.viewModel.municipalityId){\r\n                        this.$emit('input', this.viewModel.municipalityCode);\r\n                    }\r\n                    this.viewModel.area = '';\r\n                    this.viewModel.areaCode = '';\r\n                    this.viewModel.areaId = '';\r\n                    this.viewModel.divisionId = '';\r\n                }\r\n                this.$emit(\"set-division\", this.viewModel);\r\n            },\r\n            // 获取所有的省市区回显组合及下拉数据\r\n            async getAllDivision() {\r\n                if(localStorage.getItem(\"division\") != null && localStorage.getItem(\"divisionInfo\") != null) {\r\n                    this.divisionList = JSON.parse(localStorage.getItem(\"division\"));\r\n                    // 有id 视为编辑  获取回显数据\r\n                    if(this.divisionId){\r\n                        this.viewModel = this.divisionList.find(t => t.id == this.divisionId);\r\n                    }\r\n                    this.divisionInfo = JSON.parse(localStorage.getItem(\"divisionInfo\"));\r\n                    this.proList = this.divisionInfo.provinces;\r\n                    this.getEditList();\r\n                    return;\r\n                }\r\n                // 获取省市区回显组合\r\n                this.divisionList = await this.request(this.api.system.division_all, {}, true);\r\n                // 有id 视为编辑  获取回显数据\r\n                if(this.divisionId){\r\n                    this.viewModel = this.divisionList.find(t => t.id == this.divisionId);\r\n                }\r\n                // 存储回显组合数据\r\n                localStorage.setItem(\"division\", JSON.stringify(this.divisionList));\r\n                // 获取省市区下拉数据\r\n                let divisionInfo = await this.request(this.api.system.division_get_info, {}, true);\r\n                // 初始化数据 转对象\r\n                // 市\r\n                if(divisionInfo && divisionInfo.municipalitys.length){\r\n                    let municipalitys = {};\r\n                    divisionInfo.municipalitys.forEach(item => {\r\n                        let key = Object.keys(item)[0];\r\n                        municipalitys[key] = item[key];\r\n                    });\r\n                    divisionInfo.municipalitys = municipalitys;\r\n                }else{\r\n                    divisionInfo.municipalitys = {};\r\n                }\r\n                // 区\r\n                if(divisionInfo && divisionInfo.areas.length){\r\n                    let areas = {};\r\n                    divisionInfo.areas.forEach(item => {\r\n                        let key = Object.keys(item)[0];\r\n                        areas[key] = item[key];\r\n                    })\r\n                    divisionInfo.areas = areas;\r\n                }else {\r\n                    divisionInfo.areas = {};\r\n                }\r\n                this.divisionInfo = divisionInfo;\r\n                // 获取省份数据\r\n                this.proList = this.divisionInfo.provinces;\r\n                // 获取市  区数据\r\n                this.getEditList();\r\n                // 存储下拉数据\r\n                localStorage.setItem(\"divisionInfo\", JSON.stringify(this.divisionInfo));\r\n            },\r\n            // 获取市  区列表\r\n            getEditList(){\r\n                if(this.viewModel.provinceCode){\r\n                    this.muniList = this.divisionInfo.municipalitys[this.viewModel.provinceCode];\r\n                }\r\n                if(this.viewModel.municipalityCode){\r\n                    this.areaList = this.divisionInfo.areas[this.viewModel.municipalityCode];\r\n                }\r\n            }\r\n\r\n        }\r\n    };\r\n</script>\r\n<style scoped>\r\n.el-form-item__content{\r\n    width: 80%;\r\n}\r\n.el-select{\r\n    width: 25%;\r\n}\r\n.cont-inline{\r\n    display: inline;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components"}]}