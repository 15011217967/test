{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\workorder\\category\\workOrder_detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\workorder\\category\\workOrder_detail.vue","mtime":1574160264983},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import _objectSpread from \"C:\\\\Users\\\\EDZ\\\\Desktop\\\\\\u7814\\u53D1\\u9879\\u76EE\\\\vue-project\\\\trunk\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport { getToken } from \"@/utils/auth\";\nimport codeSet from \"@/components/codeSet\";\nimport treeDept from \"@/components/treeDept\";\nimport { filter } from \"minimatch\";\nimport { get } from \"http\";\nimport { mapGetters } from 'vuex';\nimport * as userTypes from \"@/types/userConfig\";\nvar token = getToken();\nexport default {\n  data: function data() {\n    return {\n      // 量体信息\n      getDataByReservationObj: {},\n      isCorrelationDataShow: false,\n      historyWorkOrderGetByNumObj: {},\n      workOrderLog_list: {},\n      tableItemGetListMapObj: {},\n      consumerCustomizedOrder_obj: {},\n      // 处理结果字段list\n      listByWorkOrderCode: [],\n      // 处理结果字段对应名称\n      tableData_backups: {},\n      // 一对多字段集合\n      subObj: {},\n      // 物流列表\n      express_list: [],\n      // 供应商编码\n      tableListData: [],\n      // 添加进程是否显示\n      isAddCourse: this.$route.query.isAddCourse,\n      isConsumer: false,\n      jobOrderStatus: {\n        \"0\": \"未处理\",\n        \"1\": \"处理中\",\n        \"2\": \"已处理\"\n      },\n      priority: {\n        \"01\": \"高\",\n        \"02\": \"中\",\n        \"03\": \"低\"\n      },\n      storageValArr: [],\n      formInline: {},\n      active: 1,\n      reverse: true\n    };\n  },\n  created: function created() {\n    this.getHistoryWorkOrderGetByNum(this.$route.query.number);\n    this.getWorkOrderLog_list(this.$route.query.number);\n    this.tableItemListByWorkOrderCode(this.$route.query.sourceChileType, this.$route.query.sourceId);\n  },\n  methods: {\n    consumerCustomizedOrder_get: function consumerCustomizedOrder_get(orderId) {\n      var _this = this;\n\n      this.request(this.api.order.consumerCustomizedOrder_get, {\n        // orderId: \"83e785b5-89fd-49eb-a6a5-5e3e76c9bf3f\"\n        orderId: orderId\n      }).then(function (res) {\n        res.consumerCustomizedGoodsVOList.forEach(function (item, index) {\n          item.isChecked = false;\n          item.craft = []; // 工艺\n\n          item.material = []; // 原料\n\n          item.productGoodsMaterials.forEach(function (items, indexs) {\n            if (items.type == 1) {\n              item.craft.push(items);\n            } else {\n              item.material.push(items);\n            }\n          });\n        });\n        _this.consumerCustomizedOrder_obj = res;\n      });\n    },\n\n    /**\n     * 获取量体信息\n     */\n    reservationOrderMeasurement_getDataByReservationOrderId: function reservationOrderMeasurement_getDataByReservationOrderId(reservationOrderId) {\n      var _this2 = this;\n\n      this.request(this.api.order.reservationOrderMeasurement_getDataByReservationOrderId, {\n        // reservationOrderId:\"5f174e93-10af-4578-917d-5bc854e85949\"\n        reservationOrderId: reservationOrderId\n      }).then(function (res) {\n        _this2.getDataByReservationObj = res;\n      });\n    },\n\n    /**\n     * 跳转工单详情\n     */\n    href: function href(routeName, param) {\n      this.$router.push({\n        path: '/' + routeName,\n        query: param\n      });\n    },\n\n    /**\n     * 根据源单获取所有子表数据项\n     */\n    tableItemListByWorkOrderCode: function tableItemListByWorkOrderCode(sourceChileType, sourceId) {\n      var that = this;\n      this.request(that.api.job_order.tableItemListByWorkOrderCode, {\n        code: sourceChileType,\n        sourceId: sourceId\n      }).then(function (res) {\n        that.listByWorkOrderCode = res; // 整理一对多字段集合\n\n        res.forEach(function (item, index) {\n          if (item.linkType == 2) {\n            item.sublist.forEach(function (items, indexs) {\n              if (!items.visible) return;\n              that.subObj[items.itemCode] = {\n                name: items.itemName,\n                isRead: items.isRead,\n                jdbcType: items.jdbcType,\n                visible: items.visible\n              };\n            });\n          }\n        });\n        console.log(that.subObj);\n      });\n    },\n\n    /**\n     * 获取工单池详情基本信息\n     */\n    getHistoryWorkOrderGetByNum: function getHistoryWorkOrderGetByNum(number) {\n      var _this3 = this;\n\n      var that = this;\n      this.request(that.api.job_order.getHistoryWorkOrderGetByNum, {\n        number: number\n      }).then(function (res) {\n        var createTime = new Date('2019-06-04T09:54:58.000+0000').getTime();\n\n        var _createTime = new Date().getTime();\n\n        console.log(createTime);\n        console.log(_this3.formatDuring(_createTime - createTime));\n        that.historyWorkOrderGetByNumObj = res;\n        that.active = res.jobOrderStatus + 1;\n        that.historyWorkOrderGetByNumObj._createTime = _this3.formatDuring(_createTime - createTime);\n\n        if (that.historyWorkOrderGetByNumObj.sourceChileType == 'measuringWorkOrder') {\n          _this3.reservationOrderMeasurement_getDataByReservationOrderId(_this3.$route.query.sourceId); // 获取量体信息\n\n        }\n\n        if (that.historyWorkOrderGetByNumObj.sourceChileType == 'consumerCustomizedOrder') {\n          _this3.consumerCustomizedOrder_get(_this3.$route.query.sourceId); // 获取定制信息\n\n        }\n      });\n    },\n\n    /**\n     *\n     */\n    formatDuring: function formatDuring(mss) {\n      var days = parseInt(mss / (1000 * 60 * 60 * 24));\n      var hours = parseInt(mss % (1000 * 60 * 60 * 24) / (1000 * 60 * 60));\n      var minutes = parseInt(mss % (1000 * 60 * 60) / (1000 * 60));\n      var seconds = mss % (1000 * 60) / 1000;\n      return \"\".concat(days, \"\\u5929\").concat(hours, \"\\u65F6\").concat(minutes, \"\\u5206\");\n    },\n\n    /**\n    * 提示\n    */\n    warn: function warn(message, type) {\n      this.$message({\n        message: message,\n        type: type || 'warning'\n      });\n    },\n\n    /**\n     * 获取工单跟进记录列表\n     */\n    getWorkOrderLog_list: function getWorkOrderLog_list(number) {\n      var that = this;\n      this.request(that.api.job_order.getWorkOrderLog_list, {\n        number: number\n      }).then(function (res) {\n        that.workOrderLog_list = res.data.reverse();\n      });\n    },\n\n    /**\n     * 添加一条跟进记录\n     */\n    addHistoryWorkOrderFollowUp: function addHistoryWorkOrderFollowUp() {\n      var _this4 = this;\n\n      var that = this;\n      console.log(this.historyWorkOrderGetByNumObj);\n      this.request(that.api.job_order.addHistoryWorkOrderFollowUp, Object.assign(this.historyWorkOrderGetByNumObj, {\n        updateName: this.userInfo.loginName\n      })).then(function (res) {\n        _this4.warn('添加成功！', 'success');\n\n        _this4.getWorkOrderLog_list(_this4.$route.query.number);\n      });\n    },\n    open: function open() {\n      var _this5 = this;\n\n      this.$prompt(\"添加一条跟进记录\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\"\n      }).then(function (_ref) {\n        var value = _ref.value;\n        if (!value) return;\n        _this5.historyWorkOrderGetByNumObj.remarks = value;\n\n        _this5.addHistoryWorkOrderFollowUp();\n      });\n    }\n  },\n  computed: _objectSpread({}, mapGetters({\n    userInfo: userTypes.GETTER_USERINFO\n  })),\n  components: {\n    codeSet: codeSet,\n    treeDept: treeDept\n  }\n};",{"version":3,"sources":["workOrder_detail.vue"],"names":[],"mappings":"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","sourcesContent":["<!-- 工单池 -->\r\n<template>\r\n  <div>\r\n    <div class=\"item-margin\">\r\n      <div class=\"item-form\">\r\n        <!-- 工单基本信息 -->\r\n        <div class=\"work-order-info\">\r\n          <span>\r\n            工单基本信息：\r\n            <el-button type=\"primary\" size=\"mini\" disabled>{{ jobOrderStatus[historyWorkOrderGetByNumObj.jobOrderStatus] }}</el-button>\r\n          </span>\r\n          <span>累计耗时：{{ historyWorkOrderGetByNumObj._createTime }}</span>\r\n        </div>\r\n        <ul class=\"info-list\">\r\n          <li>工单名称：{{ historyWorkOrderGetByNumObj.name }}</li>\r\n          <li>业务类型：{{ \"CEN012\"| codeToName(historyWorkOrderGetByNumObj.businessType) }}</li>\r\n          <li>服务类型：{{ \"CEN013\"| codeToName(historyWorkOrderGetByNumObj.serviceType) }}</li>\r\n          <li>优先级：{{ priority[historyWorkOrderGetByNumObj.priority] }}</li>\r\n          <li>创建时间：{{ historyWorkOrderGetByNumObj.createTime | timestampToTime  }}</li>\r\n          <li v-if=\"historyWorkOrderGetByNumObj.assignee\">接单人：{{ historyWorkOrderGetByNumObj.assignee }}</li>\r\n          <br/>\r\n        </ul>\r\n          <p class=\"correlationData-p\" v-if=\"historyWorkOrderGetByNumObj.sourceChileType == 'measuringWorkOrder'\">\r\n            关联数据：\r\n            <el-button size=\"small\" type=\"primary\" @click=\"isCorrelationDataShow = !isCorrelationDataShow\">\r\n              查看量体工单\r\n              <i class=\"el-icon-arrow-down el-icon--right\" :class=\"{'el-icon-arrow-up':false}\"></i>\r\n            </el-button>\r\n          </p>\r\n          <p class=\"correlationData-p\" v-if=\"historyWorkOrderGetByNumObj.sourceChileType == 'consumerCustomizedOrder'\">\r\n            关联订单：\r\n            <el-button size=\"small\" type=\"primary\" @click=\"isConsumer = !isConsumer\">\r\n              查看定制订单\r\n              <i class=\"el-icon-arrow-down el-icon--right\" :class=\"{'el-icon-arrow-up':false}\"></i>\r\n            </el-button>\r\n          </p>\r\n          <!-- 定制 -->\r\n          <!-- <section> -->\r\n          <section v-if=\"isConsumer\">\r\n            <ul  class=\"spu\">\r\n              <li>\r\n                <div class=\"spu-border\">\r\n                  <span>定制清单</span>\r\n                  <span>图片</span>\r\n                  <span>数量</span>\r\n                  <span>销售单价</span>\r\n                  <span>备注</span>\r\n                  <span>累计金额</span>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n            <ul class=\"spu\">\r\n              <!-- 一级spu -->\r\n              <li v-for=\"(item, index) in consumerCustomizedOrder_obj.consumerCustomizedGoodsVOList\" :key=\"index\">\r\n                <div>\r\n                  <!-- spu名称 -->\r\n                  <span class=\"text-left text-indent15\" @click=\"item.isChecked = !item.isChecked\">\r\n                    <i :class=\"['el-icon-arrow-down',{'el-icon-arrow-up':item.isChecked}]\"></i>&nbsp;{{ item.customizedProductName }}\r\n                  </span>\r\n                  <!-- spu图片 -->\r\n                  <span>\r\n                    <img :src=\"item.image\" alt>\r\n                  </span>\r\n                  <!-- 数量 -->\r\n                  <span>{{ item.quantity || '--' }}</span>\r\n                  <!-- 销售单价 -->\r\n                  <span>{{ item.price }}</span>\r\n                  <!-- 备注 -->\r\n                  <span>{{ item.remarks || '--' }}</span>\r\n                  <!-- 累计金额 -->\r\n                  <span>--</span>\r\n                </div>\r\n                <!-- 二级sku -->\r\n                <ul class=\"spu\" v-if=\"item.isChecked\">\r\n                  <li>\r\n                    <div>\r\n                      <span  class=\"text-left text-indent45\">原料</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                    </div>\r\n                    <!-- 三级原料 -->\r\n                    <ul class=\"spu\">\r\n                      <li  v-for=\"(items, indexs) in item.material\" :key=\"indexs\">\r\n                        <div>\r\n                          <span  class=\"text-left text-indent75\">{{ items.name }}</span>\r\n                          <span><img :src=\"items.image\" alt></span>\r\n                          <span>{{ items.quantity || '--' }}</span>\r\n                          <span>{{ items.unitPrice || '--' }}</span>\r\n                          <span>{{ items.remarks || '--' }}</span>\r\n                          <span>{{ items.usageAmount || '--' }}</span>\r\n                        </div>\r\n                      </li>\r\n                    </ul>\r\n                  </li>\r\n                  <li>\r\n                    <div>\r\n                      <span style=\"background:#fff;\" class=\"text-left text-indent45\">工艺 </span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                      <span>--</span>\r\n                    </div>\r\n                    <!-- 三级原料 -->\r\n                    <ul class=\"spu\">\r\n                      <li  v-for=\"(items, indexs) in item.craft\" :key=\"indexs\">\r\n                        <div>\r\n                          <span class=\"text-left text-indent75\">{{ items.name }}</span>\r\n                          <span><img :src=\"items.image\" alt></span>\r\n                          <span>{{ items.quantity || '--' }}</span>\r\n                          <span>{{ items.unitPrice || '--' }}</span>\r\n                          <span>{{ items.remarks || '--' }}</span>\r\n                          <span>{{ items.usageAmount || '--' }}</span>\r\n                        </div>\r\n                      </li>\r\n                    </ul>\r\n                  </li>\r\n                </ul>\r\n                <!-- 二级sku -->\r\n              </li>\r\n              <!-- 一级spu -->\r\n          </ul>\r\n          </section>\r\n        <!-- 定制 -->\r\n        <div class=\"correlationData mt-20\" v-if=\"isCorrelationDataShow\">\r\n          <section>\r\n            <h6 class=\"mt-10\">量体信息</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.measureData\" :key=\"item\">{{ item.name }}：{{ item.value }} CM</li>\r\n            </ul>\r\n          </section>\r\n          <section>\r\n            <h6 class=\"mt-10\">体型特征</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.bodyFeature\" :key=\"item\">{{ item.name }}：{{ item.value }}</li>\r\n            </ul>\r\n          </section>\r\n          <section>\r\n            <h6 class=\"mt-10\">体型实拍</h6>\r\n            <ul>\r\n              <li v-for=\"item in getDataByReservationObj.bodyPicture\" :key=\"item\">\r\n                <img :src=\"item.value\" alt=\"\">\r\n                <span>{{ item.name }}</span>\r\n              </li>\r\n            </ul>\r\n          </section>\r\n        </div>\r\n        <p class=\"correlationData-p\" v-if=\"isCorrelationDataShow\">\r\n        </p>\r\n        <div class=\"work-order-info mt-25\">\r\n          <span>工单处理结果：</span>\r\n        </div>\r\n        <el-form class=\"item-form\" size=\"small\" :inline=\"true\">\r\n          <template>\r\n            <div v-for=\"(item, index) in listByWorkOrderCode\" :key=\"index\">\r\n              <span class=\"s\">{{ item.tableCn }}</span>\r\n              <br/>\r\n              <!-- 一对一 -->\r\n              <section :class=\"['the-results',{'the-results-three-rows':historyWorkOrderGetByNumObj.layout == '01'}]\">\r\n                <span class=\"the-results-span\" v-if=\"item.linkType == 1\" v-for=\"(items, indexs) in item.sublist\" :key=\"indexs\">\r\n                  <!-- 时间字段 -->\r\n                  <template v-if=\"items.jdbcType == 'timestamp' || items.jdbcType == 'date'\">\r\n                    <el-form-item\r\n                      :label=\"items.itemName\">\r\n                      <el-date-picker style=\"width:190px;\" type=\"datetime\" value-format=\"yyyy-MM-dd HH:mm:ss\" disabled v-model=\"item.tableData[items.itemCode]\" placeholder=\"请选择\"></el-date-picker>\r\n                    </el-form-item>\r\n                  </template>\r\n                  <!-- 普通字段 -->\r\n                  <template v-else>\r\n                    <el-form-item\r\n                      v-if=\"items.visible\"\r\n                      :label=\"items.itemName\">\r\n                      <el-input style=\"width:190px;\" v-if=\"items.jdbcType != 'image'\" disabled v-model=\"item.tableData[items.itemCode]\" placeholder=\"--\"></el-input>\r\n                      <img v-else :src=\"item.tableData[items.itemCode]\" alt=\"\" class=\"jdbcType-image\">\r\n                    </el-form-item>\r\n                  </template>\r\n                </span>\r\n              </section>\r\n              <!-- 一对多 -->\r\n              <el-table\r\n                :data=\"item.tableDataList\"\r\n                v-if=\"item.linkType == 2\"\r\n                border\r\n                stripe\r\n                style=\"width:1500px;\"\r\n                empty-text=\"暂无数据\"\r\n                header-align=\"center\"\r\n                header-row-class-name=\"item-table-header\"\r\n                :highlight-current-row=\"true\" >\r\n                <el-table-column v-if=\"items.visible\" max-width=\"370\" :label=\"items.itemName\" :key=\"names\" v-for=\"(items, names) in item.sublist\">\r\n                  <template slot-scope=\"scope\">\r\n                    <!-- 时间字段 -->\r\n                    <template v-if=\"items.jdbcType == 'timestamp' || items.jdbcType == 'date'\">\r\n                      <el-date-picker type=\"datetime\"  disabled v-model=\"scope.row[items.itemCode]\" placeholder=\"开始日期\"></el-date-picker>\r\n                    </template>\r\n                    <!-- 图片 -->\r\n                    <template v-else-if=\"items.jdbcType == 'image'\">\r\n                      <!-- <el-date-picker type=\"datetime\"  :disabled=\"!items.isRead\" v-model=\"scope.row[names]\" placeholder=\"开始日期\"></el-date-picker> -->\r\n                      <img :src=\"scope.row[items.itemCode]\" alt=\"\" class=\"subImg\">\r\n                    </template>\r\n                    <!-- 普通字段 -->\r\n                    <template v-else>\r\n                      <el-input disabled v-model=\"scope.row[items.itemCode]\" placeholder=\"--\"></el-input>\r\n                    </template>\r\n                  </template>\r\n                </el-table-column>\r\n              </el-table>\r\n            </div>\r\n          </template>\r\n        </el-form>\r\n      </div>\r\n      <div class=\"item-margin\"></div>\r\n    </div>\r\n    <div class=\"item-margin\">\r\n      <div class=\"item-form\">\r\n        <el-steps :active=\"active\" finish-status=\"success\">\r\n          <el-step title=\"新工单\"></el-step>\r\n          <el-step title=\"处理中\"></el-step>\r\n          <el-step title=\"已处理\"></el-step>\r\n        </el-steps>\r\n        <!-- 工单跟进记录 -->\r\n        <div class=\"work-order-info mt-30\">\r\n          <span>工单跟进记录：</span>\r\n          <el-button size=\"small\" plain mini @click=\"open\" v-if=\"isAddCourse\">添加跟进记录</el-button>\r\n        </div>\r\n        <!-- 时间线 -->\r\n        <div class=\"block mt-30\">\r\n          <el-timeline>\r\n            <el-timeline-item\r\n            :hide-timestamp=\"true\"\r\n            v-for=\"(activity, index) in workOrderLog_list\"\r\n            :key=\"index\"\r\n            :icon=\"activity.icon\"\r\n            :type=\"activity.type\"\r\n            :color=\"activity.color\"\r\n            :size=\"activity.size\"\r\n            :timestamp=\"activity.updateTime\"\r\n            >{{ activity.updateTime || '--' | timestampToTime }}&nbsp;&nbsp;{{activity.log}}</el-timeline-item>\r\n          </el-timeline>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<!-- 工单池 -->\r\n<script>\r\n  import axios from \"axios\";\r\n  import { getToken } from \"@/utils/auth\";\r\n  import codeSet from \"@/components/codeSet\";\r\n  import treeDept from \"@/components/treeDept\";\r\n  import { filter } from \"minimatch\";\r\n  import { get } from \"http\";\r\n  import { mapGetters } from 'vuex';\r\n  import * as userTypes from \"@/types/userConfig\";\r\n  let token = getToken();\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        // 量体信息\r\n        getDataByReservationObj:{},\r\n        isCorrelationDataShow:false,\r\n        historyWorkOrderGetByNumObj:{},\r\n        workOrderLog_list:{},\r\n        tableItemGetListMapObj:{},\r\n        consumerCustomizedOrder_obj:{},\r\n        // 处理结果字段list\r\n        listByWorkOrderCode:[],\r\n        // 处理结果字段对应名称\r\n        tableData_backups:{},\r\n        // 一对多字段集合\r\n        subObj:{},\r\n        // 物流列表\r\n        express_list:[],\r\n        // 供应商编码\r\n        tableListData:[],\r\n        // 添加进程是否显示\r\n        isAddCourse:this.$route.query.isAddCourse,\r\n        isConsumer:false,\r\n        jobOrderStatus:{\r\n          \"0\":\"未处理\",\r\n          \"1\":\"处理中\",\r\n          \"2\":\"已处理\"\r\n        },\r\n        priority:{\r\n          \"01\":\"高\",\r\n          \"02\":\"中\",\r\n          \"03\":\"低\",\r\n        },\r\n        storageValArr: [],\r\n        formInline: {},\r\n        active: 1,\r\n        reverse: true\r\n      };\r\n    },\r\n    created() {\r\n      this.getHistoryWorkOrderGetByNum(this.$route.query.number);\r\n      this.getWorkOrderLog_list(this.$route.query.number);\r\n      this.tableItemListByWorkOrderCode(this.$route.query.sourceChileType,this.$route.query.sourceId);\r\n\r\n\r\n    },\r\n    methods: {\r\n      consumerCustomizedOrder_get(orderId) {\r\n        this.request(\r\n          this.api.order.consumerCustomizedOrder_get,\r\n          {\r\n            // orderId: \"83e785b5-89fd-49eb-a6a5-5e3e76c9bf3f\"\r\n            orderId\r\n          }\r\n        ).then(res => {\r\n          res.consumerCustomizedGoodsVOList.forEach((item, index) => {\r\n            item.isChecked = false;\r\n            item.craft = [];// 工艺\r\n            item.material = [];// 原料\r\n            item.productGoodsMaterials.forEach((items, indexs) => {\r\n              if(items.type == 1) {\r\n                item.craft.push(items);\r\n              }else{\r\n                item.material.push(items);\r\n              }\r\n            });\r\n          });\r\n          this.consumerCustomizedOrder_obj = res;\r\n        });\r\n      },\r\n      /**\r\n       * 获取量体信息\r\n       */\r\n      reservationOrderMeasurement_getDataByReservationOrderId(reservationOrderId) {\r\n        this.request(\r\n          this.api.order.reservationOrderMeasurement_getDataByReservationOrderId,\r\n          {\r\n            // reservationOrderId:\"5f174e93-10af-4578-917d-5bc854e85949\"\r\n            reservationOrderId\r\n          }\r\n        ).then(res => {\r\n          this.getDataByReservationObj = res;\r\n        });\r\n      },\r\n      /**\r\n       * 跳转工单详情\r\n       */\r\n      href(routeName, param) {\r\n         this.$router.push({\r\n            path: '/' + routeName,\r\n            query: param\r\n         })\r\n      },\r\n      /**\r\n       * 根据源单获取所有子表数据项\r\n       */\r\n      tableItemListByWorkOrderCode(sourceChileType, sourceId) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.tableItemListByWorkOrderCode,\r\n          {\r\n            code:sourceChileType,\r\n            sourceId\r\n          }\r\n        ).then(res => {\r\n          that.listByWorkOrderCode = res;\r\n          // 整理一对多字段集合\r\n          res.forEach((item, index) => {\r\n            if(item.linkType == 2) {\r\n              item.sublist.forEach((items, indexs) => {\r\n                if(!items.visible) return;\r\n                that.subObj[items.itemCode] = {\r\n                  name:items.itemName,\r\n                  isRead: items.isRead,\r\n                  jdbcType:items.jdbcType,\r\n                  visible:items.visible\r\n                  };\r\n              });\r\n            }\r\n          });\r\n          console.log(that.subObj)\r\n        });\r\n      },\r\n      /**\r\n       * 获取工单池详情基本信息\r\n       */\r\n      getHistoryWorkOrderGetByNum(number) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.getHistoryWorkOrderGetByNum,\r\n          {\r\n            number\r\n          }\r\n        ).then(res => {\r\n          const createTime = new Date('2019-06-04T09:54:58.000+0000').getTime();\r\n          const _createTime = new Date().getTime();\r\n          console.log(createTime)\r\n          console.log(this.formatDuring(_createTime-createTime))\r\n          that.historyWorkOrderGetByNumObj = res;\r\n          that.active = res.jobOrderStatus + 1;\r\n          that.historyWorkOrderGetByNumObj._createTime = this.formatDuring(_createTime-createTime);\r\n\r\n          if(that.historyWorkOrderGetByNumObj.sourceChileType == 'measuringWorkOrder') {\r\n            this.reservationOrderMeasurement_getDataByReservationOrderId(this.$route.query.sourceId);// 获取量体信息\r\n          }\r\n          if(that.historyWorkOrderGetByNumObj.sourceChileType == 'consumerCustomizedOrder'){\r\n            this.consumerCustomizedOrder_get(this.$route.query.sourceId);// 获取定制信息\r\n          }\r\n\r\n        });\r\n      },\r\n      /**\r\n       *\r\n       */\r\n      formatDuring(mss) {\r\n          var days = parseInt(mss / (1000 * 60 * 60 * 24));\r\n          var hours = parseInt((mss % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n          var minutes = parseInt((mss % (1000 * 60 * 60)) / (1000 * 60));\r\n          var seconds = (mss % (1000 * 60)) / 1000;\r\n          return `${days}天${hours}时${minutes}分`;\r\n      },\r\n      /**\r\n      * 提示\r\n      */\r\n      warn(message, type) {\r\n        this.$message({\r\n          message: message,\r\n          type: type || 'warning'\r\n        });\r\n      },\r\n      /**\r\n       * 获取工单跟进记录列表\r\n       */\r\n      getWorkOrderLog_list(number) {\r\n        const that = this;\r\n\r\n        this.request(\r\n          that.api.job_order.getWorkOrderLog_list,\r\n          {\r\n            number\r\n          }\r\n        ).then(res => {\r\n          that.workOrderLog_list = res.data.reverse();\r\n        });\r\n      },\r\n      /**\r\n       * 添加一条跟进记录\r\n       */\r\n      addHistoryWorkOrderFollowUp() {\r\n        const that = this;\r\n        console.log(this.historyWorkOrderGetByNumObj)\r\n        this.request(\r\n          that.api.job_order.addHistoryWorkOrderFollowUp,\r\n          Object.assign(this.historyWorkOrderGetByNumObj, {\r\n            updateName: this.userInfo.loginName\r\n          })\r\n        ).then(res => {\r\n          this.warn('添加成功！','success');\r\n          this.getWorkOrderLog_list(this.$route.query.number);\r\n        });\r\n      },\r\n      open() {\r\n        this.$prompt(\"添加一条跟进记录\", \"提示\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\"\r\n        }).then(({ value }) => {\r\n          if(!value) return;\r\n          this.historyWorkOrderGetByNumObj.remarks = value;\r\n          this.addHistoryWorkOrderFollowUp();\r\n        })\r\n      }\r\n\r\n    },\r\n    computed: {\r\n      ...mapGetters({\r\n        userInfo: userTypes.GETTER_USERINFO\r\n      })\r\n    },\r\n    components: {\r\n      codeSet,\r\n      treeDept\r\n    }\r\n  }\r\n</script>\r\n<style  lang=\"less\" scoped>\r\n  .jdbcType-image{\r\n    width: 35px;\r\n    height: 35px;\r\n  }\r\n  .the-results{\r\n    // width: 1500px;\r\n    display: flex;\r\n    text-align: right;\r\n    flex-wrap: wrap;\r\n    .the-results-span{\r\n      width: 370px;\r\n    }\r\n  }\r\n  .the-results-three-rows{\r\n    // width: 1150px;\r\n  }\r\n  .text-indent15{\r\n    text-indent: 15px;\r\n  }\r\n  .text-indent45{\r\n    text-indent: 45px;\r\n  }\r\n    .text-indent75{\r\n    text-indent: 75px;\r\n  }\r\n  .color243{\r\n    color:rgb(243, 131, 3);\r\n  }\r\n.spu {\r\n  li {\r\n    div{\r\n      display: flex;\r\n      border-bottom: 1px solid #f0f0f0;\r\n      span {\r\n        height: 50px;\r\n        flex: 1;\r\n        line-height: 50px;\r\n        position: relative;\r\n        text-align: center;\r\n      }\r\n      .text-left{\r\n        text-align: left;\r\n      }\r\n      img {\r\n        width: 40px;\r\n        height: 40px;\r\n      }\r\n    }\r\n    .spu-border {\r\n      border-bottom: 1px solid rgb(243, 131, 3);\r\n    }\r\n  }\r\n}\r\n  .display-flex{\r\n    display: flex;\r\n  }\r\n  .subImg{\r\n    width: 35px;\r\n    height: 35px;\r\n  }\r\n  .correlationData-p{\r\n    border-bottom: 1px solid #f0f0f0;\r\n    padding-bottom: 20px;\r\n    margin-bottom: 20px;\r\n  }\r\n  h5 {\r\n    color: #222;\r\n    margin-left: -30px;\r\n  }\r\n  .s{\r\n    margin-top:10px;\r\n    display:block;\r\n    font-size:15px;\r\n    color: #66b1ff;\r\n  }\r\n  .test {\r\n    color: #9d9d9d;\r\n  }\r\n  .work-order-info {\r\n    display: flex;\r\n    justify-content: space-between;\r\n  }\r\n  .info-list {\r\n    display: flex;\r\n    width: 80%;\r\n    flex-wrap: wrap;\r\n    padding: 15px 10px 0 10px;\r\n    li {\r\n      padding-bottom: 10px;\r\n      margin-right: 30px;\r\n    }\r\n  }\r\n  .correlationData{\r\n    height: 300px;\r\n    overflow-y:scroll;\r\n    padding:0 15px 15px 15px;\r\n      h3{\r\n        font-size: 16px;\r\n        padding: 15px 0;\r\n      }\r\n      ul{\r\n        display: flex;\r\n        flex-wrap:wrap;\r\n        li{\r\n          width: 20%;\r\n          text-indent: 20px;\r\n          padding: 5px 0;\r\n        }\r\n        img{\r\n          width: 120px;\r\n          height: 150px;\r\n        }\r\n        span{\r\n          display: block;\r\n          margin-top: 10px;\r\n        }\r\n      }\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/views/workorder/category"}]}