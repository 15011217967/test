{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\utils\\LodopFuncs.js","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\utils\\LodopFuncs.js","mtime":1587347931358},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.match\";\nimport { MessageBox } from 'element-ui';\nvar CreatedOKLodop7766 = null,\n    CLodopIsLocal; //====判断是否需要 Web打印服务CLodop:===\n//===(不支持插件的浏览器版本需要用它)===\n\nexport function needCLodop() {\n  try {\n    var ua = navigator.userAgent;\n    if (ua.match(/Windows\\sPhone/i)) return true;\n    if (ua.match(/iPhone|iPod|iPad/i)) return true;\n    if (ua.match(/Android/i)) return true;\n    if (ua.match(/Edge\\D?\\d+/i)) return true;\n    var verTrident = ua.match(/Trident\\D?\\d+/i);\n    var verIE = ua.match(/MSIE\\D?\\d+/i);\n    var verOPR = ua.match(/OPR\\D?\\d+/i);\n    var verFF = ua.match(/Firefox\\D?\\d+/i);\n    var x64 = ua.match(/x64/i);\n    if (!verTrident && !verIE && x64) return true;else if (verFF) {\n      verFF = verFF[0].match(/\\d+/);\n      if (verFF[0] >= 41 || x64) return true;\n    } else if (verOPR) {\n      verOPR = verOPR[0].match(/\\d+/);\n      if (verOPR[0] >= 32) return true;\n    } else if (!verTrident && !verIE) {\n      var verChrome = ua.match(/Chrome\\D?\\d+/i);\n\n      if (verChrome) {\n        verChrome = verChrome[0].match(/\\d+/);\n        if (verChrome[0] >= 41) return true;\n      }\n    }\n    return false;\n  } catch (err) {\n    return true;\n  }\n} //====页面引用CLodop云打印必须的JS文件,用双端口(8000和18000）避免其中某个被占用：====\n\nif (needCLodop()) {\n  var src1 = \"http://localhost:8000/CLodopfuncs.js?priority=1\";\n  var src2 = \"http://localhost:18000/CLodopfuncs.js?priority=0\";\n  var head = document.head || document.getElementsByTagName(\"head\")[0] || document.documentElement;\n  var oscript = document.createElement(\"script\");\n  oscript.src = src1;\n  head.insertBefore(oscript, head.firstChild);\n  oscript = document.createElement(\"script\");\n  oscript.src = src2;\n  head.insertBefore(oscript, head.firstChild);\n  CLodopIsLocal = !!(src1 + src2).match(/\\/\\/localho|\\/\\/127.0.0./i);\n} //====获取LODOP对象的主过程：====\n\n\nexport function getLodop(oOBJECT, oEMBED) {\n  var printDownUrl = \"\".concat(process.env.VUE_APP_API_ROOT, \"prints_down/LSS_Prints_Installer.zip\");\n  var strHtmInstall = \"<br><font color='#FF00FF'>\\u6253\\u5370\\u63A7\\u4EF6\\u672A\\u5B89\\u88C5!\\u70B9\\u51FB\\u8FD9\\u91CC<a href='\".concat(printDownUrl, \"' target='_self'>\\u6267\\u884C\\u5B89\\u88C5</a>,\\u5B89\\u88C5\\u540E\\u8BF7\\u5237\\u65B0\\u9875\\u9762\\u6216\\u91CD\\u65B0\\u8FDB\\u5165\\u3002</font>\");\n  var strHtmUpdate = \"<br><font color='#FF00FF'>\\u6253\\u5370\\u63A7\\u4EF6\\u9700\\u8981\\u5347\\u7EA7!\\u70B9\\u51FB\\u8FD9\\u91CC<a href='\".concat(printDownUrl, \"' target='_self'>\\u6267\\u884C\\u5347\\u7EA7</a>,\\u5347\\u7EA7\\u540E\\u8BF7\\u91CD\\u65B0\\u8FDB\\u5165\\u3002</font>\");\n  var strHtm64_Install = \"<br><font color='#FF00FF'>\\u6253\\u5370\\u63A7\\u4EF6\\u672A\\u5B89\\u88C5!\\u70B9\\u51FB\\u8FD9\\u91CC<a href='\".concat(printDownUrl, \"' target='_self'>\\u6267\\u884C\\u5B89\\u88C5</a>,\\u5B89\\u88C5\\u540E\\u8BF7\\u5237\\u65B0\\u9875\\u9762\\u6216\\u91CD\\u65B0\\u8FDB\\u5165\\u3002</font>\");\n  var strHtm64_Update = \"<br><font color='#FF00FF'>\\u6253\\u5370\\u63A7\\u4EF6\\u9700\\u8981\\u5347\\u7EA7!\\u70B9\\u51FB\\u8FD9\\u91CC<a href='\".concat(printDownUrl, \"' target='_self'>\\u6267\\u884C\\u5347\\u7EA7</a>,\\u5347\\u7EA7\\u540E\\u8BF7\\u91CD\\u65B0\\u8FDB\\u5165\\u3002</font>\");\n  var strHtmFireFox = \"<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>\";\n  var strHtmChrome = \"<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>\";\n  var strCLodopInstall_1 = \"<br><font color='#FF00FF'>Web\\u6253\\u5370\\u670D\\u52A1CLodop\\u672A\\u5B89\\u88C5\\u542F\\u52A8\\uFF0C\\u70B9\\u51FB\\u8FD9\\u91CC<a href='\".concat(printDownUrl, \"' target='_self'>\\u4E0B\\u8F7D\\u6267\\u884C\\u5B89\\u88C5</a>\");\n  var strCLodopInstall_2 = \"<br>（若此前已安装过，可<a href='CLodop.protocol:setup' target='_self'>点这里直接再次启动</a>）\";\n  var strCLodopInstall_3 = \"，成功后请刷新本页面。</font>\";\n  var strCLodopUpdate = \"<br><font color='#FF00FF'>Web\\u6253\\u5370\\u670D\\u52A1CLodop\\u9700\\u5347\\u7EA7!\\u70B9\\u51FB\\u8FD9\\u91CC<a href='\".concat(printDownUrl, \"' target='_self'>\\u6267\\u884C\\u5347\\u7EA7</a>,\\u5347\\u7EA7\\u540E\\u8BF7\\u5237\\u65B0\\u9875\\u9762\\u3002</font>\");\n  var LODOP;\n\n  try {\n    var ua = navigator.userAgent;\n    var isIE = !!ua.match(/MSIE/i) || !!ua.match(/Trident/i);\n\n    if (needCLodop()) {\n      try {\n        LODOP = getCLodop();\n      } catch (err) {}\n\n      if (!LODOP && document.readyState !== \"complete\") {\n        alert(\"网页还没下载完毕，请稍等一下再操作.\");\n        return;\n      }\n\n      if (!LODOP) {\n        //  document.body.innerHTML = strCLodopInstall_1 + (CLodopIsLocal ? strCLodopInstall_2 : \"\") + strCLodopInstall_3 + document.body.innerHTML;                \n        MessageBox.alert(strCLodopInstall_1 + (CLodopIsLocal ? strCLodopInstall_2 : \"\") + strCLodopInstall_3, '提示', {\n          dangerouslyUseHTMLString: true\n        });\n        return;\n      } else {\n        if (CLODOP.CVERSION < \"3.0.9.1\") {\n          // document.body.innerHTML = strCLodopUpdate + document.body.innerHTML;\n          MessageBox.alert(strCLodopUpdate, '提示', {\n            dangerouslyUseHTMLString: true\n          });\n        }\n\n        if (oEMBED && oEMBED.parentNode) oEMBED.parentNode.removeChild(oEMBED);\n        if (oOBJECT && oOBJECT.parentNode) oOBJECT.parentNode.removeChild(oOBJECT);\n      }\n    } else {\n      var is64IE = isIE && !!ua.match(/x64/i); //=====如果页面有Lodop就直接使用，没有则新建:==========\n\n      if (oOBJECT || oEMBED) {\n        if (isIE) LODOP = oOBJECT;else LODOP = oEMBED;\n      } else if (!CreatedOKLodop7766) {\n        LODOP = document.createElement(\"object\");\n        LODOP.setAttribute(\"width\", 0);\n        LODOP.setAttribute(\"height\", 0);\n        LODOP.setAttribute(\"style\", \"position:absolute;left:0px;top:-100px;width:0px;height:0px;\");\n        if (isIE) LODOP.setAttribute(\"classid\", \"clsid:2105C259-1E0C-4534-8141-A753534CB4CA\");else LODOP.setAttribute(\"type\", \"application/x-print-lodop\");\n        document.documentElement.appendChild(LODOP);\n        CreatedOKLodop7766 = LODOP;\n      } else LODOP = CreatedOKLodop7766; //=====Lodop插件未安装时提示下载地址:==========\n\n\n      if (!LODOP || !LODOP.VERSION) {\n        if (ua.indexOf('Chrome') >= 0) {\n          //document.body.innerHTML = strHtmChrome + document.body.innerHTML;\n          MessageBox.alert(strHtmChrome, '提示', {\n            dangerouslyUseHTMLString: true\n          });\n        }\n\n        if (ua.indexOf('Firefox') >= 0) {\n          //document.body.innerHTML = strHtmFireFox + document.body.innerHTML;\\\n          MessageBox.alert(strHtmFireFox, '提示', {\n            dangerouslyUseHTMLString: true\n          });\n        } // document.body.innerHTML = (is64IE ? strHtm64_Install : strHtmInstall) + document.body.innerHTML;\n\n\n        MessageBox.alert(is64IE ? strHtm64_Install : strHtmInstall, '提示', {\n          dangerouslyUseHTMLString: true\n        });\n        return LODOP;\n      }\n    }\n\n    if (LODOP.VERSION < \"6.2.2.6\") {\n      if (!needCLodop()) {\n        //document.body.innerHTML = (is64IE ? strHtm64_Update : strHtmUpdate) + document.body.innerHTML;\n        MessageBox.alert(is64IE ? strHtm64_Update : strHtmUpdate, '提示', {\n          dangerouslyUseHTMLString: true\n        });\n      }\n    } //===如下空白位置适合调用统一功能(如注册语句、语言选择等):==\n\n\n    LODOP.SET_LICENSES(\"北京新桥云英科技有限公司\", \"BC1F17938EE17DECE5ADD14CA683CA08\", \"\", \"\"); //=======================================================\n\n    return LODOP;\n  } catch (err) {\n    alert(\"getLodop出错:\" + err);\n  }\n}",{"version":3,"sources":["C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\utils\\LodopFuncs.js"],"names":["MessageBox","CreatedOKLodop7766","CLodopIsLocal","needCLodop","ua","navigator","userAgent","match","verTrident","verIE","verOPR","verFF","x64","verChrome","err","src1","src2","head","document","getElementsByTagName","documentElement","oscript","createElement","src","insertBefore","firstChild","getLodop","oOBJECT","oEMBED","printDownUrl","process","env","VUE_APP_API_ROOT","strHtmInstall","strHtmUpdate","strHtm64_Install","strHtm64_Update","strHtmFireFox","strHtmChrome","strCLodopInstall_1","strCLodopInstall_2","strCLodopInstall_3","strCLodopUpdate","LODOP","isIE","getCLodop","readyState","alert","dangerouslyUseHTMLString","CLODOP","CVERSION","parentNode","removeChild","is64IE","setAttribute","appendChild","VERSION","indexOf","SET_LICENSES"],"mappings":"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","sourcesContent":["import { MessageBox } from 'element-ui';\r\nvar CreatedOKLodop7766 = null, CLodopIsLocal;\r\n\r\n//====判断是否需要 Web打印服务CLodop:===\r\n//===(不支持插件的浏览器版本需要用它)===\r\nexport function needCLodop() {\r\n    try {\r\n        var ua = navigator.userAgent;\r\n        if (ua.match(/Windows\\sPhone/i))\r\n            return true;\r\n        if (ua.match(/iPhone|iPod|iPad/i))\r\n            return true;\r\n        if (ua.match(/Android/i))\r\n            return true;\r\n        if (ua.match(/Edge\\D?\\d+/i))\r\n            return true;\r\n\r\n        var verTrident = ua.match(/Trident\\D?\\d+/i);\r\n        var verIE = ua.match(/MSIE\\D?\\d+/i);\r\n        var verOPR = ua.match(/OPR\\D?\\d+/i);\r\n        var verFF = ua.match(/Firefox\\D?\\d+/i);\r\n        var x64 = ua.match(/x64/i);\r\n        if ((!verTrident) && (!verIE) && (x64))\r\n            return true;\r\n        else if (verFF) {\r\n            verFF = verFF[0].match(/\\d+/);\r\n            if ((verFF[0] >= 41) || (x64))\r\n                return true;\r\n        } else if (verOPR) {\r\n            verOPR = verOPR[0].match(/\\d+/);\r\n            if (verOPR[0] >= 32)\r\n                return true;\r\n        } else if ((!verTrident) && (!verIE)) {\r\n            var verChrome = ua.match(/Chrome\\D?\\d+/i);\r\n            if (verChrome) {\r\n                verChrome = verChrome[0].match(/\\d+/);\r\n                if (verChrome[0] >= 41)\r\n                    return true;\r\n            }\r\n        }\r\n        return false;\r\n    } catch (err) {\r\n        return true;\r\n    }\r\n}\r\n\r\n//====页面引用CLodop云打印必须的JS文件,用双端口(8000和18000）避免其中某个被占用：====\r\nif (needCLodop()) {\r\n    var src1 = \"http://localhost:8000/CLodopfuncs.js?priority=1\";\r\n    var src2 = \"http://localhost:18000/CLodopfuncs.js?priority=0\";\r\n\r\n    var head = document.head || document.getElementsByTagName(\"head\")[0] || document.documentElement;\r\n    var oscript = document.createElement(\"script\");\r\n    oscript.src = src1;\r\n    head.insertBefore(oscript, head.firstChild);\r\n    oscript = document.createElement(\"script\");\r\n    oscript.src = src2;\r\n    head.insertBefore(oscript, head.firstChild);\r\n    CLodopIsLocal = !!((src1 + src2).match(/\\/\\/localho|\\/\\/127.0.0./i));\r\n}\r\n\r\n//====获取LODOP对象的主过程：====\r\nexport function getLodop(oOBJECT, oEMBED) {\r\n    let printDownUrl= `${process.env.VUE_APP_API_ROOT}prints_down/LSS_Prints_Installer.zip`;\r\n    var strHtmInstall = `<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='${printDownUrl}' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>`;\r\n    var strHtmUpdate = `<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='${printDownUrl}' target='_self'>执行升级</a>,升级后请重新进入。</font>`;\r\n    var strHtm64_Install = `<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='${printDownUrl}' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>`;\r\n    var strHtm64_Update = `<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='${printDownUrl}' target='_self'>执行升级</a>,升级后请重新进入。</font>`;\r\n    var strHtmFireFox = \"<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>\";\r\n    var strHtmChrome = \"<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>\";\r\n    var strCLodopInstall_1 = `<br><font color='#FF00FF'>Web打印服务CLodop未安装启动，点击这里<a href='${printDownUrl}' target='_self'>下载执行安装</a>`;\r\n    var strCLodopInstall_2 = \"<br>（若此前已安装过，可<a href='CLodop.protocol:setup' target='_self'>点这里直接再次启动</a>）\";\r\n    var strCLodopInstall_3 = \"，成功后请刷新本页面。</font>\";\r\n    var strCLodopUpdate = `<br><font color='#FF00FF'>Web打印服务CLodop需升级!点击这里<a href='${printDownUrl}' target='_self'>执行升级</a>,升级后请刷新页面。</font>`;\r\n    var LODOP;\r\n    try {\r\n        var ua = navigator.userAgent;\r\n        var isIE = !!(ua.match(/MSIE/i)) || !!(ua.match(/Trident/i));\r\n        if (needCLodop()) {\r\n            try {\r\n                LODOP = getCLodop();\r\n            } catch (err) { }\r\n            if (!LODOP && document.readyState !== \"complete\") {\r\n                alert(\"网页还没下载完毕，请稍等一下再操作.\");\r\n                return;\r\n            }\r\n            if (!LODOP) {\r\n                //  document.body.innerHTML = strCLodopInstall_1 + (CLodopIsLocal ? strCLodopInstall_2 : \"\") + strCLodopInstall_3 + document.body.innerHTML;                \r\n                MessageBox.alert(strCLodopInstall_1 + (CLodopIsLocal ? strCLodopInstall_2 : \"\") + strCLodopInstall_3, '提示', {\r\n                    dangerouslyUseHTMLString: true\r\n                })\r\n                return;\r\n            } else {\r\n                if (CLODOP.CVERSION < \"3.0.9.1\") {\r\n                    // document.body.innerHTML = strCLodopUpdate + document.body.innerHTML;\r\n                    MessageBox.alert(strCLodopUpdate, '提示', {\r\n                        dangerouslyUseHTMLString: true\r\n                    });\r\n                }\r\n                if (oEMBED && oEMBED.parentNode)\r\n                    oEMBED.parentNode.removeChild(oEMBED);\r\n                if (oOBJECT && oOBJECT.parentNode)\r\n                    oOBJECT.parentNode.removeChild(oOBJECT);\r\n            }\r\n        } else {\r\n            var is64IE = isIE && !!(ua.match(/x64/i));\r\n            //=====如果页面有Lodop就直接使用，没有则新建:==========\r\n            if (oOBJECT || oEMBED) {\r\n                if (isIE)\r\n                    LODOP = oOBJECT;\r\n                else\r\n                    LODOP = oEMBED;\r\n            } else if (!CreatedOKLodop7766) {\r\n                LODOP = document.createElement(\"object\");\r\n                LODOP.setAttribute(\"width\", 0);\r\n                LODOP.setAttribute(\"height\", 0);\r\n                LODOP.setAttribute(\"style\", \"position:absolute;left:0px;top:-100px;width:0px;height:0px;\");\r\n                if (isIE)\r\n                    LODOP.setAttribute(\"classid\", \"clsid:2105C259-1E0C-4534-8141-A753534CB4CA\");\r\n                else\r\n                    LODOP.setAttribute(\"type\", \"application/x-print-lodop\");\r\n                document.documentElement.appendChild(LODOP);\r\n                CreatedOKLodop7766 = LODOP;\r\n            } else\r\n                LODOP = CreatedOKLodop7766;\r\n            //=====Lodop插件未安装时提示下载地址:==========\r\n            if ((!LODOP) || (!LODOP.VERSION)) {\r\n                if (ua.indexOf('Chrome') >= 0){\r\n                    //document.body.innerHTML = strHtmChrome + document.body.innerHTML;\r\n                    MessageBox.alert(strHtmChrome, '提示', {\r\n                        dangerouslyUseHTMLString: true\r\n                    });\r\n                }\r\n                if (ua.indexOf('Firefox') >= 0){\r\n                    //document.body.innerHTML = strHtmFireFox + document.body.innerHTML;\\\r\n                    MessageBox.alert(strHtmFireFox, '提示', {\r\n                        dangerouslyUseHTMLString: true\r\n                    });\r\n                }\r\n               // document.body.innerHTML = (is64IE ? strHtm64_Install : strHtmInstall) + document.body.innerHTML;\r\n                MessageBox.alert(is64IE ? strHtm64_Install : strHtmInstall, '提示', {\r\n                    dangerouslyUseHTMLString: true\r\n                });\r\n                return LODOP;\r\n            }\r\n        }\r\n        if (LODOP.VERSION < \"6.2.2.6\") {\r\n            if (!needCLodop()){\r\n                //document.body.innerHTML = (is64IE ? strHtm64_Update : strHtmUpdate) + document.body.innerHTML;\r\n                MessageBox.alert(is64IE ? strHtm64_Update : strHtmUpdate, '提示', {\r\n                    dangerouslyUseHTMLString: true\r\n                });\r\n            }\r\n        }\r\n        //===如下空白位置适合调用统一功能(如注册语句、语言选择等):==\r\n\r\n        LODOP.SET_LICENSES(\"北京新桥云英科技有限公司\",\"BC1F17938EE17DECE5ADD14CA683CA08\",\"\",\"\");\r\n\r\n        //=======================================================\r\n        return LODOP;\r\n    } catch (err) {\r\n        alert(\"getLodop出错:\" + err);\r\n    }\r\n}\r\n\r\n"]}]}