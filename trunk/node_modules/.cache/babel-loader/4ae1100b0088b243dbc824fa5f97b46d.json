{"remainingRequest":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\content\\operate\\mini_women.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\src\\views\\content\\operate\\mini_women.vue","mtime":1574160264905},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":1558492720858},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558492728398},{"path":"C:\\Users\\EDZ\\Desktop\\研发项目\\vue-project\\trunk\\node_modules\\vue-loader\\lib\\index.js","mtime":1558492728890}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Editor from '@/components/editor/Editor';\nimport UploadImg from '@/components/editor/UploadImg.vue';\nimport LinkDialog from '@/views/content/operate/components/LinkDialog.vue';\nimport Sortable from 'sortablejs';\nexport default {\n  name: 'mini_women',\n  // 数据\n  data: function data() {\n    return {\n      /**\n       * 左侧\n       */\n      // 左侧数据\n      sideData: [],\n      // 选中的行\n      checkSideRow: {},\n      // 左侧数据映射\n      sideDataProps: {\n        children: 'children',\n        label: 'name'\n      },\n\n      /**\n       * 首页\n       */\n      // 表格数据\n      tableData: [],\n      // 链接类型\n      linkType: {\n        1: '内容链接',\n        2: '商品链接',\n        3: '外部链接'\n      },\n      detailsType: {\n        1: '视频',\n        2: '小视频',\n        3: '图集',\n        4: '文章',\n        5: '定制单品',\n        6: '定制套装',\n        7: '标准商品'\n      },\n      // 新增和编辑\n      // 是否显示\n      dialogVisible: false,\n      // 编辑的行\n      checkTableRow: {},\n      // 编辑还是新增  新增 true  编辑false\n      addAndEditFlag: true,\n      // 首页banner\n      // 编辑新增提交的表单\n      addAndEditFormData: {\n        id: '',\n        coverUrl: '',\n        // 选中的链接\n        checkLinkList: []\n      },\n      // 验证\n      rules: {\n        coverUrl: [{\n          type: 'string',\n          required: true,\n          message: '请上传轮播图',\n          trigger: 'blur'\n        }],\n        checkLinkList: [{\n          type: 'array',\n          required: true,\n          message: '请选择关联',\n          trigger: 'change'\n        }]\n      },\n\n      /**\n       * 内购企业\n       */\n      enterpriseInfo: {\n        content: ''\n      },\n      enterpriseType: null\n    };\n  },\n  // 组件\n  components: {\n    UploadImg: UploadImg,\n    LinkDialog: LinkDialog,\n    Editor: Editor\n  },\n  // 初始化数据\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.$nextTick(function () {\n      // 获取左侧数据\n      _this2.getSideData();\n    });\n  },\n  // keepAlive 页面显示时\n  activated: function activated() {\n    this.getTableData();\n  },\n  // 方法\n  methods: {\n    // 获取左侧数据\n    getSideData: function getSideData() {\n      var _this3 = this;\n\n      this.sideData = [{\n        name: '女装小程序',\n        id: '3',\n        level: 1,\n        children: [{\n          name: '首页banner',\n          id: '1',\n          level: 2\n        }, {\n          name: '内购企业',\n          id: '2',\n          level: 2\n        }]\n      }]; // 获取默认选中的\n\n      this.$nextTick(function () {\n        var row = _this3.sideData[0].children[0];\n        _this3.checkSideRow = row;\n\n        _this3.$refs.sideTree.setCurrentKey(row.id);\n\n        _this3.getTableData(row);\n      });\n    },\n\n    /**\n     * 首页banner\n     */\n    // 获取表格数据\n    getTableData: function getTableData(row) {\n      var _this4 = this;\n\n      this.request(this.api.contentCore.womenOperationManage_listWeb, {\n        modelType: row.id,\n        orderBy: 'sort'\n      }).then(function (data) {\n        if (data.data && data.data.length) {\n          data.data.forEach(function (item) {\n            if (item.linkType == 1 && item.contentPasses && item.contentPasses.length > 0) {\n              item._linkInfo = _this4.detailsType[item.detailsType] + ' 》 ' + item.contentPasses[0].title;\n            } else if (item.productName && item.linkType == 2) {\n              item._linkInfo = _this4.detailsType[item.detailsType] + ' 》 ' + item.productName;\n            } else if (item.url && item.linkType == 3) {\n              item._linkInfo = item.url;\n            } else {\n              item._linkInfo = '关联的' + _this4.detailsType[item.detailsType] + '不存在或已下线';\n            }\n          });\n        }\n\n        _this4.tableData = data.data; // 初始行拖拽\n\n        _this4.rowDrop();\n      });\n    },\n    // 表格行删除\n    delTableItem: function delTableItem(id) {\n      var _this5 = this;\n\n      this.$confirm('确认删除吗？', '删除', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        showClose: false\n      }).then(function () {\n        _this5.request(_this5.api.contentCore.womenOperationManage_delete, {\n          id: id\n        }).then(function (data) {\n          _this5.$notify.success({\n            title: '成功',\n            message: '删除成功'\n          });\n\n          _this5.getTableData(_this5.checkSideRow);\n        });\n      }).catch(function () {});\n    },\n    // 左侧数据行点击\n    sideDataClick: function sideDataClick(row, node, tree) {\n      if (row.level > 1) {\n        this.checkSideRow = row;\n\n        if (row.id == 1) {\n          this.getTableData(row);\n        }\n\n        if (row.id == 2) {\n          this.getEnterpriseData(row);\n        }\n      }\n    },\n    // 表格行拖拽\n    rowDrop: function rowDrop() {\n      var tbody = this.$refs.dragTable.$el.querySelector('.el-table__body-wrapper > table > tbody');\n\n      var _this = this;\n\n      Sortable.create(tbody, {\n        onEnd: function onEnd(_ref) {\n          var newIndex = _ref.newIndex,\n              oldIndex = _ref.oldIndex;\n          if (newIndex === oldIndex) return;\n\n          var currRow = _this.tableData.splice(oldIndex, 1)[0];\n\n          _this.tableData.splice(newIndex, 0, currRow);\n\n          var listData = _this.tableData.map(function (item, index) {\n            return {\n              id: item.id,\n              sort: ++index\n            };\n          });\n\n          _this.request(_this.api.contentCore.womenOperationManage_move, listData).then(function (data) {\n            _this.$notify.success({\n              title: '成功',\n              message: '移动成功'\n            });\n          });\n        }\n      });\n    },\n    // 新增和编辑显示\n    addAndEdit: function addAndEdit(flag, row) {\n      if (flag) {\n        this.addAndEditFormData = {\n          coverUrl: '',\n          noContent: '',\n          checkLinkList: []\n        };\n      } else {\n        // 内容\n        if (row.linkType == 1 && row.contentPasses && row.contentPasses.length > 0) {\n          this.addAndEditFormData = {\n            checkLinkList: [{\n              title: row.contentPasses[0].title,\n              url: row.url,\n              linkType: row.linkType,\n              linkTypeName: this.linkType[row.linkType],\n              detailsType: row.detailsType,\n              detailsTypeName: this.detailsType[row.detailsType]\n            }],\n            coverUrl: row.coverUrl,\n            id: row.id // 商品\n\n          };\n        } else if (row.linkType == 2 && row.productName) {\n          this.addAndEditFormData = {\n            checkLinkList: [{\n              title: row.productName,\n              url: row.url,\n              linkType: row.linkType,\n              linkTypeName: this.linkType[row.linkType],\n              detailsType: row.detailsType,\n              detailsTypeName: this.detailsType[row.detailsType]\n            }],\n            coverUrl: row.coverUrl,\n            id: row.id // 则为链接\n\n          };\n        } else if (row.linkType == 1 && row.url) {} else {\n          this.addAndEditFormData = {\n            checkLinkList: [],\n            noContent: \"\\u5173\\u8054\\u7684\".concat(this.detailsType[row.detailsType], \"\\u4E0D\\u5B58\\u5728\\u6216\\u5DF2\\u4E0B\\u7EBF\"),\n            coverUrl: row.coverUrl\n          };\n        }\n      }\n\n      this.addAndEditFlag = flag;\n      this.dialogVisible = true;\n    },\n    // 获取链接关联\n    getLink: function getLink() {\n      this.$refs.LinkDialog.linkDialog = true;\n      this.$refs.LinkDialog.init();\n    },\n    // 新增编辑提交\n    addAndEditSub: function addAndEditSub() {\n      var _this6 = this;\n\n      // 新增url\n      var url = this.api.contentCore.womenOperationManage_save;\n\n      if (!this.addAndEditFlag) {\n        // 编辑url\n        url = this.api.contentCore.womenOperationManage_edit;\n      }\n\n      this.$refs.form.validate(function (valid) {\n        if (valid) {\n          var params = _this6.addAndEditFormData.checkLinkList[0];\n          params.coverUrl = _this6.addAndEditFormData.coverUrl;\n          params.id = _this6.addAndEditFormData.id;\n\n          _this6.addAndEditSubSend(url, params);\n        } else {\n          return false;\n        }\n      });\n    },\n    addAndEditSubSend: function addAndEditSubSend(url, formData) {\n      var _this7 = this;\n\n      // 左侧菜单id\n      formData.modelType = this.checkSideRow.id;\n      this.request(url, formData).then(function (data) {\n        var msg = _this7.addAndEditFlag ? '新增成功' : '编辑成功';\n\n        _this7.$notify.success({\n          title: '成功',\n          message: msg\n        }); // 删除完初始化表格数据\n\n\n        _this7.getTableData(_this7.checkSideRow);\n\n        _this7.dialogVisible = false;\n      });\n    },\n\n    /**\n     * 内购企业\n     */\n    // 获取数据\n    getEnterpriseData: function getEnterpriseData(row) {\n      var _this8 = this;\n\n      this.request(this.api.contentCore.womenOperationManage_listWeb, {\n        modelType: row.id,\n        orderBy: 'sort'\n      }).then(function (data) {\n        var contentInfo = data.data;\n\n        if (contentInfo && contentInfo.length === 0) {\n          _this8.enterpriseType = 1;\n        } else {\n          _this8.enterpriseInfo = contentInfo[0];\n\n          if (!_this8.enterpriseInfo.content) {\n            _this8.enterpriseType = 1;\n          } else {\n            _this8.enterpriseType = 3;\n          }\n        }\n      });\n    },\n    // 编辑\n    enterpriseEdit: function enterpriseEdit() {\n      if (this.enterpriseType === 1) {\n        this.$refs.editor.setEditorHtml('');\n      } else {\n        this.$refs.editor.setEditorHtml(this.enterpriseInfo.content);\n      }\n\n      this.enterpriseType = 2;\n    },\n    // 提交\n    enterpriseSave: function enterpriseSave(content) {\n      var _this9 = this;\n\n      var params = {\n        modelType: this.checkSideRow.id,\n        content: content\n      };\n\n      if (this.enterpriseInfo.id) {\n        params.id = this.enterpriseInfo.id;\n      }\n\n      this.request(this.api.contentCore.womenOperationManage_saveText, params).then(function (data) {\n        _this9.$notify.success({\n          title: '成功',\n          message: '操作成功'\n        });\n\n        _this9.getEnterpriseData(_this9.checkSideRow);\n      });\n    },\n    enterpriseSub: function enterpriseSub() {\n      var html = this.$refs.editor.getEditorHtml();\n\n      if (html == '<p><br></p>') {\n        this.$notify.error({\n          title: '错误',\n          message: '请输入数据'\n        });\n        return;\n      }\n\n      this.enterpriseSave(html);\n    },\n    // 清空\n    enterpriseClear: function enterpriseClear() {\n      var _this10 = this;\n\n      this.$confirm('确认清空数据吗？', '删除', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        showClose: false\n      }).then(function () {\n        _this10.enterpriseSave('');\n      }).catch(function () {});\n    },\n    // 取消\n    enterpriseClose: function enterpriseClose() {\n      this.getEnterpriseData(this.checkSideRow);\n    }\n  },\n  // 计算属性\n  computed: {},\n  // 监听数据变化\n  watch: {}\n};",{"version":3,"sources":["mini_women.vue"],"names":[],"mappings":"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","sourcesContent":["<style lang=\"less\" scoped>\r\n  @import \"../style/contentPublic.less\";\r\n  .mini-program{\r\n    .page-main{display:flex;\r\n      .side {width: 240px;padding: 20px;margin-right: 0;background: #fff;}\r\n      .list-table{flex:1;width: 100%;background: #fff;padding: 24px;\r\n        .table-img{height: 30px;max-width: 200px;}\r\n        .item-margin{ margin-top: 0; }\r\n      }\r\n      .check-link-list{\r\n        span{margin-left: 20px;}\r\n      }\r\n      .enterprise{background: #fff;flex:1;padding-bottom: 20px;\r\n        .item-cont{ padding-bottom: 0; }\r\n        .no-content{height: 60px;line-height: 60px;border-bottom: 1px solid #e6e6e6;border-top: 1px solid #e6e6e6;text-align: center;color: #909399;}\r\n        .editor{width: 600px;}\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n\r\n</style>\r\n<template>\r\n  <div class=\"mini-program page-public\">\r\n    <div class=\"page-main\">\r\n      <!--侧边-->\r\n      <div class=\"side item-margin\">\r\n        <h4>运营模块</h4>\r\n        <el-tree ref=\"sideTree\" :data=\"sideData\" :props=\"sideDataProps\" :default-expand-all=\"true\" :expand-on-click-node=\"false\" highlight-current node-key=\"id\" @node-click=\"sideDataClick\"></el-tree>\r\n      </div>\r\n      <!--表格-->\r\n      <div v-if=\"checkSideRow.id == 1\" class=\"list-table item-margin\">\r\n        <div class=\"page-main-btns\">\r\n          <el-button type=\"primary\" size=\"small\"  @click=\"addAndEdit(true)\">新增</el-button>\r\n        </div>\r\n        <el-table :data=\"tableData\" ref=\"dragTable\" style=\"width: 100%\"  row-key=\"id\">\r\n          <el-table-column type=\"index\" width=\"50\" label=\"序号\"></el-table-column>\r\n          <el-table-column label=\"图片\">\r\n            <template slot-scope=\"scope\">\r\n              <img :src=\"scope.row.coverUrl\" alt=\"\" class=\"table-img\" v-if=\"scope.row.coverUrl\">\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"跳转类型\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.linkType ? linkType[scope.row.linkType] : ''}}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column  prop=\"_linkInfo\" label=\"关联内容\"></el-table-column>\r\n          <el-table-column label=\"操作\" width=\"160\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"text\" size=\"small\" @click=\"addAndEdit(false, scope.row)\">编辑</el-button>\r\n              <el-button type=\"text\" size=\"small\"  @click=\"delTableItem(scope.row.id)\">删除</el-button>\r\n              <el-button type=\"text\" size=\"small\">移动</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <div v-if=\"checkSideRow.id == 2\" class=\"enterprise item-margin\">\r\n        <div class=\"item-cont\" v-if=\"enterpriseType === 1 || enterpriseType === 3\">\r\n          <el-button type=\"primary\" size=\"small\"  @click=\"enterpriseEdit\" >编辑</el-button>\r\n          <el-button  size=\"small\"  @click=\"enterpriseClear\">清除</el-button>\r\n        </div>\r\n        <div class=\"item-cont\" v-if=\"enterpriseType === 2\">\r\n          <el-button type=\"primary\" size=\"small\"  @click=\"enterpriseSub\">保存</el-button>\r\n          <el-button  size=\"small\"  @click=\"enterpriseClose\">取消</el-button>\r\n        </div>\r\n        <!--富文本-->\r\n        <div class=\"item-cont\">\r\n          <div class=\"no-content\" v-show=\"enterpriseType === 1\">暂无数据</div>\r\n          <editor ref=\"editor\" class=\"editor\"  v-show=\"enterpriseType === 2\"></editor>\r\n          <div class=\"content\" v-html=\"enterpriseInfo.content\"  v-show=\"enterpriseType === 3\"></div>\r\n        </div>\r\n      </div>\r\n      <!--新增和编辑-->\r\n      <el-dialog :title=\"addAndEditFlag ? '新增' : '编辑'\" :visible.sync=\"dialogVisible\" width=\"40%\">\r\n        <el-form ref=\"form\" :model=\"addAndEditFormData\" label-width=\"80px\" :rules=\"rules\">\r\n          <el-form-item label=\"轮播图\" prop=\"coverUrl\">\r\n            <upload-img v-model=\"addAndEditFormData.coverUrl\" :content-txt=\"'点击上传'\"></upload-img>\r\n          </el-form-item>\r\n          <el-form-item label=\"选择链接\" prop=\"checkLinkList\" class=\"small-input\">\r\n            <el-button type=\"primary\" size=\"small\" @click=\"getLink\" v-if=\"!addAndEditFormData.checkLinkList.length\">新增</el-button>\r\n            <div v-for=\"item in addAndEditFormData.checkLinkList\" class=\"check-link-list\">{{item.linkTypeName}} 》 {{ item.detailsTypeName }} 》 {{ item.title }} <span><el-button type=\"text\" size=\"small\" @click=\"getLink\">更换</el-button></span> </div>\r\n            <p v-show=\"!addAndEditFormData.checkLinkList.length\">{{ addAndEditFormData.noContent }}</p>\r\n          </el-form-item>\r\n        </el-form>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"dialogVisible = false\" size=\"small\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"addAndEditSub\" size=\"small\">确 定</el-button>\r\n        </span>\r\n      </el-dialog>\r\n      <link-dialog ref=\"LinkDialog\" :check-link-list=\"addAndEditFormData.checkLinkList\"></link-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n  import Editor from '@/components/editor/Editor'\r\n  import UploadImg from '@/components/editor/UploadImg.vue'\r\n  import LinkDialog from '@/views/content/operate/components/LinkDialog.vue'\r\n  import Sortable from 'sortablejs'\r\n  export default {\r\n    name: 'mini_women',\r\n    // 数据\r\n    data() {\r\n      return {\r\n        /**\r\n         * 左侧\r\n         */\r\n        // 左侧数据\r\n        sideData: [],\r\n        // 选中的行\r\n        checkSideRow: {},\r\n        // 左侧数据映射\r\n        sideDataProps: {\r\n          children: 'children',\r\n          label: 'name'\r\n        },\r\n        /**\r\n         * 首页\r\n         */\r\n        // 表格数据\r\n        tableData:[],\r\n        // 链接类型\r\n        linkType: {\r\n          1: '内容链接',\r\n          2: '商品链接',\r\n          3: '外部链接'\r\n        },\r\n        detailsType: {\r\n          1: '视频',\r\n          2: '小视频',\r\n          3: '图集',\r\n          4: '文章',\r\n          5: '定制单品',\r\n          6: '定制套装',\r\n          7: '标准商品'\r\n        },\r\n        // 新增和编辑\r\n        // 是否显示\r\n        dialogVisible: false,\r\n        // 编辑的行\r\n        checkTableRow: {},\r\n        // 编辑还是新增  新增 true  编辑false\r\n        addAndEditFlag: true,\r\n        // 首页banner\r\n        // 编辑新增提交的表单\r\n        addAndEditFormData: {\r\n          id: '',\r\n          coverUrl: '',\r\n          // 选中的链接\r\n          checkLinkList: [],\r\n        },\r\n        // 验证\r\n        rules: {\r\n          coverUrl: [\r\n            { type: 'string',required: true, message: '请上传轮播图', trigger: 'blur' }\r\n          ],\r\n          checkLinkList: [\r\n            { type: 'array',required: true, message: '请选择关联', trigger: 'change' }\r\n          ]\r\n        },\r\n        /**\r\n         * 内购企业\r\n         */\r\n        enterpriseInfo: {\r\n          content: ''\r\n        },\r\n        enterpriseType: null\r\n      }\r\n    },\r\n    // 组件\r\n    components: {\r\n      UploadImg,\r\n      LinkDialog,\r\n      Editor\r\n    },\r\n    // 初始化数据\r\n    mounted() {\r\n      this.$nextTick(() => {\r\n        // 获取左侧数据\r\n        this.getSideData();\r\n      })\r\n    },\r\n    // keepAlive 页面显示时\r\n    activated() {\r\n      this.getTableData();\r\n    },\r\n    // 方法\r\n    methods: {\r\n      // 获取左侧数据\r\n      getSideData() {\r\n        this.sideData =  [{\r\n          name: '女装小程序',\r\n          id: '3',\r\n          level: 1,\r\n          children: [\r\n            {name: '首页banner', id: '1', level: 2},\r\n            {name: '内购企业', id: '2', level: 2}\r\n          ]\r\n        }];\r\n        // 获取默认选中的\r\n        this.$nextTick(() => {\r\n          const row = this.sideData[0].children[0];\r\n          this.checkSideRow = row;\r\n          this.$refs.sideTree.setCurrentKey(row.id);\r\n          this.getTableData(row);\r\n        })\r\n      },\r\n      /**\r\n       * 首页banner\r\n       */\r\n      // 获取表格数据\r\n      getTableData(row) {\r\n        this.request(this.api.contentCore.womenOperationManage_listWeb, {modelType: row.id, orderBy: 'sort'}).then(data => {\r\n          if(data.data && data.data.length){\r\n            data.data.forEach(item => {\r\n              if(item.linkType == 1 && item.contentPasses && item.contentPasses.length > 0){\r\n                item._linkInfo = this.detailsType[item.detailsType] + ' 》 ' + item.contentPasses[0].title;\r\n              }else if(item.productName && item.linkType == 2 ){\r\n                item._linkInfo = this.detailsType[item.detailsType] + ' 》 ' + item.productName;\r\n              }else if(item.url && item.linkType == 3 ){\r\n                item._linkInfo = item.url;\r\n              }else {\r\n                item._linkInfo = '关联的'+ this.detailsType[item.detailsType] + '不存在或已下线';\r\n              }\r\n            })\r\n          }\r\n          this.tableData =  data.data;\r\n          // 初始行拖拽\r\n          this.rowDrop();\r\n        });\r\n      },\r\n      // 表格行删除\r\n      delTableItem(id){\r\n        this.$confirm('确认删除吗？', '删除', {\r\n          confirmButtonText: '确认',\r\n          cancelButtonText: '取消',\r\n          showClose:false\r\n        }).then(() => {\r\n          this.request(this.api.contentCore.womenOperationManage_delete, {id: id}).then(data => {\r\n            this.$notify.success({ title: '成功',message: '删除成功'});\r\n            this.getTableData(this.checkSideRow);\r\n          });\r\n        }).catch(() => {\r\n        });\r\n\r\n      },\r\n      // 左侧数据行点击\r\n      sideDataClick(row, node, tree){\r\n        if( row.level > 1){\r\n          this.checkSideRow = row;\r\n          if(row.id == 1){\r\n            this.getTableData(row);\r\n          }\r\n          if(row.id == 2){\r\n            this.getEnterpriseData(row);\r\n          }\r\n        }\r\n      },\r\n      // 表格行拖拽\r\n      rowDrop() {\r\n        const tbody = this.$refs.dragTable.$el.querySelector('.el-table__body-wrapper > table > tbody')\r\n        const _this = this\r\n        Sortable.create(tbody, {\r\n          onEnd({ newIndex, oldIndex }) {\r\n            if(newIndex === oldIndex) return;\r\n            const currRow = _this.tableData.splice(oldIndex, 1)[0]\r\n            _this.tableData.splice(newIndex, 0, currRow)\r\n            let listData = _this.tableData.map((item,index) => {\r\n              return {\r\n                id: item.id,\r\n                sort: ++index\r\n              }\r\n            })\r\n            _this.request(_this.api.contentCore.womenOperationManage_move, listData).then(data => {\r\n              _this.$notify.success({ title: '成功',message: '移动成功'});\r\n            });\r\n\r\n          }\r\n        })\r\n      },\r\n      // 新增和编辑显示\r\n      addAndEdit(flag,row){\r\n        if(flag){\r\n          this.addAndEditFormData = {\r\n            coverUrl: '',\r\n            noContent: '',\r\n            checkLinkList: []\r\n          }\r\n        }else {\r\n          // 内容\r\n          if(row.linkType == 1 && row.contentPasses && row.contentPasses.length > 0){\r\n            this.addAndEditFormData = {\r\n              checkLinkList: [{\r\n                title: row.contentPasses[0].title,\r\n                url: row.url,\r\n                linkType: row.linkType,\r\n                linkTypeName: this.linkType[row.linkType],\r\n                detailsType: row.detailsType,\r\n                detailsTypeName: this.detailsType[row.detailsType]\r\n              }],\r\n              coverUrl: row.coverUrl,\r\n              id: row.id\r\n            }\r\n            // 商品\r\n          }else if(row.linkType == 2 && row.productName){\r\n            this.addAndEditFormData = {\r\n              checkLinkList: [{\r\n                title: row.productName,\r\n                url: row.url,\r\n                linkType: row.linkType,\r\n                linkTypeName: this.linkType[row.linkType],\r\n                detailsType: row.detailsType,\r\n                detailsTypeName: this.detailsType[row.detailsType]\r\n              }],\r\n              coverUrl: row.coverUrl,\r\n              id: row.id\r\n            }\r\n\r\n            // 则为链接\r\n          }else if(row.linkType == 1 && row.url){\r\n\r\n          }else{\r\n            this.addAndEditFormData = {\r\n              checkLinkList: [],\r\n              noContent: `关联的${this.detailsType[row.detailsType]}不存在或已下线`,\r\n              coverUrl: row.coverUrl\r\n            }\r\n          }\r\n        }\r\n        this.addAndEditFlag = flag;\r\n        this.dialogVisible = true;\r\n      },\r\n      // 获取链接关联\r\n      getLink(){\r\n        this.$refs.LinkDialog.linkDialog = true;\r\n        this.$refs.LinkDialog.init();\r\n      },\r\n      // 新增编辑提交\r\n      addAndEditSub(){\r\n        // 新增url\r\n        let url = this.api.contentCore.womenOperationManage_save;\r\n        if(!this.addAndEditFlag){\r\n          // 编辑url\r\n          url = this.api.contentCore.womenOperationManage_edit;\r\n        }\r\n        this.$refs.form.validate((valid) => {\r\n          if (valid) {\r\n            let params = this.addAndEditFormData.checkLinkList[0];\r\n            params.coverUrl = this.addAndEditFormData.coverUrl;\r\n            params.id = this.addAndEditFormData.id;\r\n            this.addAndEditSubSend(url, params)\r\n          } else {\r\n            return false;\r\n          }\r\n        });\r\n      },\r\n      addAndEditSubSend(url, formData){\r\n        // 左侧菜单id\r\n        formData.modelType = this.checkSideRow.id;\r\n        this.request(url, formData).then(data => {\r\n          let msg = this.addAndEditFlag ? '新增成功' : '编辑成功';\r\n          this.$notify.success({ title: '成功',message: msg});\r\n          // 删除完初始化表格数据\r\n          this.getTableData(this.checkSideRow);\r\n          this.dialogVisible = false;\r\n        })\r\n      },\r\n      /**\r\n       * 内购企业\r\n       */\r\n      // 获取数据\r\n      getEnterpriseData(row){\r\n        this.request(this.api.contentCore.womenOperationManage_listWeb, {modelType: row.id, orderBy: 'sort'}).then(data => {\r\n          let contentInfo = data.data;\r\n          if(contentInfo && contentInfo.length === 0){\r\n            this.enterpriseType = 1;\r\n          }else {\r\n            this.enterpriseInfo = contentInfo[0];\r\n            if(!this.enterpriseInfo.content){\r\n              this.enterpriseType = 1;\r\n            }else{\r\n              this.enterpriseType = 3;\r\n            }\r\n          }\r\n        });\r\n      },\r\n      // 编辑\r\n      enterpriseEdit(){\r\n        if(this.enterpriseType === 1){\r\n          this.$refs.editor.setEditorHtml('');\r\n        }else {\r\n          this.$refs.editor.setEditorHtml(this.enterpriseInfo.content);\r\n        }\r\n        this.enterpriseType = 2;\r\n      },\r\n      // 提交\r\n      enterpriseSave(content){\r\n        let params = {modelType: this.checkSideRow.id, content: content};\r\n        if(this.enterpriseInfo.id){\r\n          params.id = this.enterpriseInfo.id\r\n        }\r\n        this.request(this.api.contentCore.womenOperationManage_saveText, params ).then(data => {\r\n          this.$notify.success({ title: '成功', message: '操作成功'});\r\n          this.getEnterpriseData(this.checkSideRow);\r\n        });\r\n      },\r\n      enterpriseSub(){\r\n        let html = this.$refs.editor.getEditorHtml();\r\n        if(html == '<p><br></p>'){\r\n          this.$notify.error({ title: '错误',message: '请输入数据'});\r\n          return\r\n        }\r\n        this.enterpriseSave(html)\r\n      },\r\n      // 清空\r\n      enterpriseClear(){\r\n        this.$confirm('确认清空数据吗？', '删除', {\r\n          confirmButtonText: '确认',\r\n          cancelButtonText: '取消',\r\n          showClose:false\r\n        }).then(() => {\r\n          this.enterpriseSave('')\r\n        }).catch(() => {\r\n        });\r\n      },\r\n      // 取消\r\n      enterpriseClose(){\r\n        this.getEnterpriseData(this.checkSideRow);\r\n      }\r\n    },\r\n    // 计算属性\r\n    computed: {},\r\n    // 监听数据变化\r\n    watch: {\r\n    }\r\n  }\r\n</script>\r\n"],"sourceRoot":"src/views/content/operate"}]}